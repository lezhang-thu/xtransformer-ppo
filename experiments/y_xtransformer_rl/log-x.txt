[INFO: 2020-09-06 23:36:54,924] Training with config:
[INFO: 2020-09-06 23:36:54,926] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-06 23:38:10,787] test_current @iteration 0: 1.307807880786779, test_best: 1.307807880786779
[INFO: 2020-09-06 23:43:33,963] test_current @iteration 100: 1.3069088142528418, test_best: 1.307807880786779
[INFO: 2020-09-06 23:43:33,963] mv_approxkl: 0.10180458179202946
[INFO: 2020-09-06 23:43:33,963] beta: 100
[INFO: 2020-09-06 23:44:43,645] x: 1.6390005764911455, y: 1.6386051565289028 @iteration 100
[INFO: 2020-09-06 23:44:43,709] reload model @iteration 100
[INFO: 2020-09-06 23:50:05,515] test_current @iteration 200: 1.3060398076593227, test_best: 1.307807880786779
[INFO: 2020-09-06 23:50:05,515] mv_approxkl: 0.15203676217706596
[INFO: 2020-09-06 23:50:05,515] beta: 100
[INFO: 2020-09-06 23:51:14,845] x: 1.6537804742027173, y: 1.6387699871652037 @iteration 200
[INFO: 2020-09-06 23:51:14,845] update predictor @iteration 200
[INFO: 2020-09-06 23:56:35,670] test_current @iteration 300: 1.3071384296612556, test_best: 1.307807880786779
[INFO: 2020-09-06 23:56:35,670] mv_approxkl: 0.05517102764163443
[INFO: 2020-09-06 23:56:35,670] beta: 4.0
[INFO: 2020-09-06 23:57:45,084] x: 1.6444635567793275, y: 1.629893192137405 @iteration 300
[INFO: 2020-09-06 23:57:45,084] update predictor @iteration 300
[INFO: 2020-09-07 00:03:08,630] test_current @iteration 400: 1.3070580854322777, test_best: 1.307807880786779
[INFO: 2020-09-07 00:03:08,631] mv_approxkl: 1.4654196722275698e-06
[INFO: 2020-09-07 00:03:08,631] beta: 0.5
[INFO: 2020-09-07 00:04:19,874] x: 1.6625132113309844, y: 1.6543652873365295 @iteration 400
[INFO: 2020-09-07 00:04:19,874] update predictor @iteration 400
[INFO: 2020-09-07 00:09:46,344] test_current @iteration 500: 1.30687560484454, test_best: 1.307807880786779
[INFO: 2020-09-07 00:09:46,344] mv_approxkl: 3.892359645175427e-11
[INFO: 2020-09-07 00:09:46,344] beta: 0.5
[INFO: 2020-09-07 00:10:58,096] x: 1.60868637375816, y: 1.6133320521394083 @iteration 500
[INFO: 2020-09-07 00:10:58,160] reload model @iteration 500
[INFO: 2020-09-07 00:16:23,727] test_current @iteration 600: 1.306791969194431, test_best: 1.307807880786779
[INFO: 2020-09-07 00:16:23,728] mv_approxkl: 0.0002612850367657005
[INFO: 2020-09-07 00:16:23,728] beta: 0.5
[INFO: 2020-09-07 00:17:35,032] x: 1.6537734393987693, y: 1.657194130781277 @iteration 600
[INFO: 2020-09-07 00:17:35,095] reload model @iteration 600
[INFO: 2020-09-07 00:23:01,208] test_current @iteration 700: 1.3069841084497935, test_best: 1.307807880786779
[INFO: 2020-09-07 00:23:01,208] mv_approxkl: 0.005875824253886407
[INFO: 2020-09-07 00:23:01,208] beta: 1.0
[INFO: 2020-09-07 00:24:15,163] x: 1.6509393346195866, y: 1.6335429597701425 @iteration 700
[INFO: 2020-09-07 00:24:15,164] update predictor @iteration 700
[INFO: 2020-09-07 00:29:42,495] test_current @iteration 800: 1.3072883488810558, test_best: 1.307807880786779
[INFO: 2020-09-07 00:29:42,495] mv_approxkl: 1.5607011180083826e-07
[INFO: 2020-09-07 00:29:42,495] beta: 0.5
[INFO: 2020-09-07 00:30:55,670] x: 1.6250211133566337, y: 1.627860480495603 @iteration 800
[INFO: 2020-09-07 00:30:55,732] reload model @iteration 800
[INFO: 2020-09-07 00:36:21,903] test_current @iteration 900: 1.3074570195945925, test_best: 1.307807880786779
[INFO: 2020-09-07 00:36:21,903] mv_approxkl: 4.145440493972449e-12
[INFO: 2020-09-07 00:36:21,903] beta: 0.5
[INFO: 2020-09-07 00:37:34,232] x: 1.6357103439100422, y: 1.6287700541393497 @iteration 900
[INFO: 2020-09-07 00:37:34,232] update predictor @iteration 900
[INFO: 2020-09-07 00:42:59,504] test_current @iteration 1000: 1.307381116804057, test_best: 1.307807880786779
[INFO: 2020-09-07 00:42:59,504] mv_approxkl: 1.1010869852516025e-16
[INFO: 2020-09-07 00:42:59,504] beta: 0.5
[INFO: 2020-09-07 00:44:10,515] x: 1.691223277619431, y: 1.6776852187808569 @iteration 1000
[INFO: 2020-09-07 00:44:10,516] update predictor @iteration 1000
[INFO: 2020-09-07 00:49:37,551] test_current @iteration 1100: 1.3071300156444725, test_best: 1.307807880786779
[INFO: 2020-09-07 00:49:37,552] mv_approxkl: 2.9246410625199026e-21
[INFO: 2020-09-07 00:49:37,552] beta: 0.5
[INFO: 2020-09-07 00:50:49,180] x: 1.6230300584440374, y: 1.6290357642400994 @iteration 1100
[INFO: 2020-09-07 00:50:49,243] reload model @iteration 1100
[INFO: 2020-09-07 00:56:15,514] test_current @iteration 1200: 1.3077304288826814, test_best: 1.307807880786779
[INFO: 2020-09-07 00:56:15,514] mv_approxkl: 1.1239840209360012e-05
[INFO: 2020-09-07 00:56:15,514] beta: 0.5
[INFO: 2020-09-07 00:57:25,651] x: 1.6227553854600945, y: 1.6286356044941954 @iteration 1200
[INFO: 2020-09-07 00:57:25,714] reload model @iteration 1200
[INFO: 2020-09-07 01:02:48,486] test_current @iteration 1300: 1.3075223472351758, test_best: 1.307807880786779
[INFO: 2020-09-07 01:02:48,486] mv_approxkl: 2.9854587923355695e-10
[INFO: 2020-09-07 01:02:48,486] beta: 0.5
[INFO: 2020-09-07 01:03:58,900] x: 1.6324615626416443, y: 1.6293665517230653 @iteration 1300
[INFO: 2020-09-07 01:03:58,900] update predictor @iteration 1300
[INFO: 2020-09-07 01:09:24,433] test_current @iteration 1400: 1.3071472000358582, test_best: 1.307807880786779
[INFO: 2020-09-07 01:09:24,434] mv_approxkl: 7.929796184568039e-15
[INFO: 2020-09-07 01:09:24,434] beta: 0.5
[INFO: 2020-09-07 01:10:36,264] x: 1.655986214434567, y: 1.647228316562257 @iteration 1400
[INFO: 2020-09-07 01:10:36,265] update predictor @iteration 1400
[INFO: 2020-09-07 01:16:02,341] test_current @iteration 1500: 1.3070589494926994, test_best: 1.307807880786779
[INFO: 2020-09-07 01:16:02,341] mv_approxkl: 2.1062647955558135e-19
[INFO: 2020-09-07 01:16:02,341] beta: 0.5
[INFO: 2020-09-07 01:17:15,617] x: 1.6158050772492494, y: 1.6081436437202143 @iteration 1500
[INFO: 2020-09-07 01:17:15,618] update predictor @iteration 1500
[INFO: 2020-09-07 01:22:44,030] test_current @iteration 1600: 1.306782807279561, test_best: 1.307807880786779
[INFO: 2020-09-07 01:22:44,031] mv_approxkl: 5.594533939764099e-24
[INFO: 2020-09-07 01:22:44,031] beta: 0.5
[INFO: 2020-09-07 01:23:55,583] x: 1.6537815054578489, y: 1.6582146640901203 @iteration 1600
[INFO: 2020-09-07 01:23:55,647] reload model @iteration 1600
[INFO: 2020-09-07 01:29:22,635] test_current @iteration 1700: 1.3067838424112652, test_best: 1.307807880786779
[INFO: 2020-09-07 01:29:22,635] mv_approxkl: 1.4859864756422085e-28
[INFO: 2020-09-07 01:29:22,635] beta: 0.5
[INFO: 2020-09-07 01:30:34,732] x: 1.6270809946917322, y: 1.6407566731777932 @iteration 1700
[INFO: 2020-09-07 01:30:34,796] reload model @iteration 1700
[INFO: 2020-09-07 01:36:02,494] test_current @iteration 1800: 1.3067049903454944, test_best: 1.307807880786779
[INFO: 2020-09-07 01:36:02,494] mv_approxkl: 3.946987952109308e-33
[INFO: 2020-09-07 01:36:02,495] beta: 0.5
[INFO: 2020-09-07 01:37:14,381] x: 1.6592658122244466, y: 1.6516491723807594 @iteration 1800
[INFO: 2020-09-07 01:37:14,381] update predictor @iteration 1800
[INFO: 2020-09-07 01:42:41,353] test_current @iteration 1900: 1.306459305152652, test_best: 1.307807880786779
[INFO: 2020-09-07 01:42:41,353] mv_approxkl: 0.005044366389513015
[INFO: 2020-09-07 01:42:41,353] beta: 0.5
[INFO: 2020-09-07 01:43:52,530] x: 1.650697460376565, y: 1.6534401554801477 @iteration 1900
[INFO: 2020-09-07 01:43:52,595] reload model @iteration 1900
[INFO: 2020-09-07 01:49:18,956] test_current @iteration 2000: 1.306466505120078, test_best: 1.307807880786779
[INFO: 2020-09-07 01:49:18,957] mv_approxkl: 1.3398542780699492e-07
[INFO: 2020-09-07 01:49:18,957] beta: 0.5
[INFO: 2020-09-07 01:50:29,191] x: 1.6510825119555073, y: 1.6513279956390514 @iteration 2000
[INFO: 2020-09-07 01:50:29,255] reload model @iteration 2000
[INFO: 2020-09-07 01:55:54,202] test_current @iteration 2100: 1.3061513450195288, test_best: 1.307807880786779
[INFO: 2020-09-07 01:55:54,202] mv_approxkl: 0.0004985772247829723
[INFO: 2020-09-07 01:55:54,202] beta: 0.5
[INFO: 2020-09-07 01:57:06,005] x: 1.6548561724741229, y: 1.6440384806705624 @iteration 2100
[INFO: 2020-09-07 01:57:06,005] update predictor @iteration 2100
[INFO: 2020-09-07 02:02:32,397] test_current @iteration 2200: 1.306253227036418, test_best: 1.307807880786779
[INFO: 2020-09-07 02:02:32,397] mv_approxkl: 1.324290854372693e-08
[INFO: 2020-09-07 02:02:32,397] beta: 0.5
[INFO: 2020-09-07 02:03:44,712] x: 1.6564484530552426, y: 1.65437476096079 @iteration 2200
[INFO: 2020-09-07 02:03:44,712] update predictor @iteration 2200
[INFO: 2020-09-07 02:09:13,319] test_current @iteration 2300: 1.3064161881665757, test_best: 1.307807880786779
[INFO: 2020-09-07 02:09:13,320] mv_approxkl: 3.517501762617721e-13
[INFO: 2020-09-07 02:09:13,320] beta: 0.5
[INFO: 2020-09-07 02:10:24,757] x: 1.6687921512941823, y: 1.6699605163481777 @iteration 2300
[INFO: 2020-09-07 02:10:24,820] reload model @iteration 2300
[INFO: 2020-09-07 02:15:50,853] test_current @iteration 2400: 1.3064769678831876, test_best: 1.307807880786779
[INFO: 2020-09-07 02:15:50,853] mv_approxkl: 9.342976740468154e-18
[INFO: 2020-09-07 02:15:50,853] beta: 0.5
[INFO: 2020-09-07 02:17:02,308] x: 1.6650400534577379, y: 1.6595953519873123 @iteration 2400
[INFO: 2020-09-07 02:17:02,309] update predictor @iteration 2400
[INFO: 2020-09-07 02:22:28,566] test_current @iteration 2500: 1.3066017218661672, test_best: 1.307807880786779
[INFO: 2020-09-07 02:22:28,566] mv_approxkl: 2.48162532001027e-22
[INFO: 2020-09-07 02:22:28,566] beta: 0.5
[INFO: 2020-09-07 02:23:39,157] x: 1.6506269687195079, y: 1.6414663422615796 @iteration 2500
[INFO: 2020-09-07 02:23:39,157] update predictor @iteration 2500
[INFO: 2020-09-07 02:29:05,799] test_current @iteration 2600: 1.3067591637708331, test_best: 1.307807880786779
[INFO: 2020-09-07 02:29:05,799] mv_approxkl: 6.591544001432988e-27
[INFO: 2020-09-07 02:29:05,800] beta: 0.5
[INFO: 2020-09-07 02:30:16,488] x: 1.6526084811562654, y: 1.6664952858680258 @iteration 2600
[INFO: 2020-09-07 02:30:16,554] reload model @iteration 2600
[INFO: 2020-09-07 02:35:42,495] test_current @iteration 2700: 1.3068247366423424, test_best: 1.307807880786779
[INFO: 2020-09-07 02:35:42,495] mv_approxkl: 1.750806295071464e-31
[INFO: 2020-09-07 02:35:42,495] beta: 0.5
[INFO: 2020-09-07 02:36:53,302] x: 1.6264969682402437, y: 1.6287401380922188 @iteration 2700
[INFO: 2020-09-07 02:36:53,365] reload model @iteration 2700
[INFO: 2020-09-07 02:42:18,925] test_current @iteration 2800: 1.3061578038924446, test_best: 1.307807880786779
[INFO: 2020-09-07 02:42:18,926] mv_approxkl: 4.650386437829246e-36
[INFO: 2020-09-07 02:42:18,926] beta: 0.5
[INFO: 2020-09-07 02:43:29,604] x: 1.63711005089514, y: 1.6476356501762073 @iteration 2800
[INFO: 2020-09-07 02:43:29,668] reload model @iteration 2800
[INFO: 2020-09-07 02:48:55,361] test_current @iteration 2900: 1.3063152981079198, test_best: 1.307807880786779
[INFO: 2020-09-07 02:48:55,362] mv_approxkl: 1.235207691566099e-40
[INFO: 2020-09-07 02:48:55,362] beta: 0.5
[INFO: 2020-09-07 02:50:06,850] x: 1.6325838006006002, y: 1.6377535329859245 @iteration 2900
[INFO: 2020-09-07 02:50:06,914] reload model @iteration 2900
[INFO: 2020-09-07 02:55:33,989] test_current @iteration 3000: 1.3069976533041328, test_best: 1.307807880786779
[INFO: 2020-09-07 02:55:33,989] mv_approxkl: 3.280884420470337e-45
[INFO: 2020-09-07 02:55:33,989] beta: 0.5
[INFO: 2020-09-07 02:56:44,470] x: 1.641990656404169, y: 1.6388450221231494 @iteration 3000
[INFO: 2020-09-07 02:56:44,471] update predictor @iteration 3000
[INFO: 2020-09-07 03:02:11,017] test_current @iteration 3100: 1.3069925324886187, test_best: 1.307807880786779
[INFO: 2020-09-07 03:02:11,017] mv_approxkl: 8.714487979618412e-50
[INFO: 2020-09-07 03:02:11,017] beta: 0.5
[INFO: 2020-09-07 03:03:21,281] x: 1.6584279131760433, y: 1.660509897073976 @iteration 3100
[INFO: 2020-09-07 03:03:21,345] reload model @iteration 3100
[INFO: 2020-09-07 03:08:46,118] test_current @iteration 3200: 1.3059217758422546, test_best: 1.307807880786779
[INFO: 2020-09-07 03:08:46,118] mv_approxkl: 2.314689913277314e-54
[INFO: 2020-09-07 03:08:46,118] beta: 0.5
[INFO: 2020-09-07 03:09:56,354] x: 1.6901939778390433, y: 1.6769450176161314 @iteration 3200
[INFO: 2020-09-07 03:09:56,354] update predictor @iteration 3200
[INFO: 2020-09-07 03:15:21,696] test_current @iteration 3300: 1.3055413824305009, test_best: 1.307807880786779
[INFO: 2020-09-07 03:15:21,696] mv_approxkl: 6.148140208763416e-59
[INFO: 2020-09-07 03:15:21,696] beta: 0.5
[INFO: 2020-09-07 03:16:32,968] x: 1.6291221537629037, y: 1.6311046009004009 @iteration 3300
[INFO: 2020-09-07 03:16:33,034] reload model @iteration 3300
[INFO: 2020-09-07 03:21:58,208] test_current @iteration 3400: 1.306639049405008, test_best: 1.307807880786779
[INFO: 2020-09-07 03:21:58,208] mv_approxkl: 1.6330320450178087e-63
[INFO: 2020-09-07 03:21:58,208] beta: 0.5
[INFO: 2020-09-07 03:23:08,592] x: 1.6324708071439853, y: 1.6342208390712079 @iteration 3400
[INFO: 2020-09-07 03:23:08,656] reload model @iteration 3400
[INFO: 2020-09-07 03:28:33,728] test_current @iteration 3500: 1.306387140666874, test_best: 1.307807880786779
[INFO: 2020-09-07 03:28:33,728] mv_approxkl: 4.3375615543930844e-68
[INFO: 2020-09-07 03:28:33,729] beta: 0.5
[INFO: 2020-09-07 03:29:45,634] x: 1.671822776718033, y: 1.66648068818216 @iteration 3500
[INFO: 2020-09-07 03:29:45,634] update predictor @iteration 3500
[INFO: 2020-09-07 03:35:18,859] test_current @iteration 3600: 1.3063053670603062, test_best: 1.307807880786779
[INFO: 2020-09-07 03:35:18,859] mv_approxkl: 1.2483746716118001e-05
[INFO: 2020-09-07 03:35:18,859] beta: 0.5
[INFO: 2020-09-07 03:36:31,420] x: 1.6493237542779766, y: 1.6443676050249292 @iteration 3600
[INFO: 2020-09-07 03:36:31,421] update predictor @iteration 3600
[INFO: 2020-09-07 03:41:57,951] test_current @iteration 3700: 1.306199757159146, test_best: 1.307807880786779
[INFO: 2020-09-07 03:41:57,951] mv_approxkl: 1.2746811146901381e-05
[INFO: 2020-09-07 03:41:57,951] beta: 0.5
[INFO: 2020-09-07 03:43:08,551] x: 1.6596721421839231, y: 1.6628071078916213 @iteration 3700
[INFO: 2020-09-07 03:43:08,616] reload model @iteration 3700
[INFO: 2020-09-07 03:48:32,770] test_current @iteration 3800: 1.306278886221899, test_best: 1.307807880786779
[INFO: 2020-09-07 03:48:32,770] mv_approxkl: 3.3857313541759433e-10
[INFO: 2020-09-07 03:48:32,770] beta: 0.5
[INFO: 2020-09-07 03:49:44,719] x: 1.6436710403846275, y: 1.6674380313353938 @iteration 3800
[INFO: 2020-09-07 03:49:44,782] reload model @iteration 3800
[INFO: 2020-09-07 03:55:09,375] test_current @iteration 3900: 1.306860852201367, test_best: 1.307807880786779
[INFO: 2020-09-07 03:55:09,375] mv_approxkl: 0.0018265251562089254
[INFO: 2020-09-07 03:55:09,375] beta: 0.5
[INFO: 2020-09-07 03:56:19,487] x: 1.6243034172142403, y: 1.622776219549867 @iteration 3900
[INFO: 2020-09-07 03:56:19,488] update predictor @iteration 3900
[INFO: 2020-09-07 04:01:45,089] test_current @iteration 4000: 1.30659403369943, test_best: 1.307807880786779
[INFO: 2020-09-07 04:01:45,089] mv_approxkl: 4.851506325227841e-08
[INFO: 2020-09-07 04:01:45,089] beta: 0.5
[INFO: 2020-09-07 04:02:55,733] x: 1.6652327392989996, y: 1.6590315324506246 @iteration 4000
[INFO: 2020-09-07 04:02:55,733] update predictor @iteration 4000
[INFO: 2020-09-07 04:08:22,160] test_current @iteration 4100: 1.3065487470080097, test_best: 1.307807880786779
[INFO: 2020-09-07 04:08:22,160] mv_approxkl: 0.000625872197015524
[INFO: 2020-09-07 04:08:22,160] beta: 0.5
[INFO: 2020-09-07 04:09:31,821] x: 1.6583926847976278, y: 1.658534526174344 @iteration 4100
[INFO: 2020-09-07 04:09:31,885] reload model @iteration 4100
[INFO: 2020-09-07 04:14:57,647] test_current @iteration 4200: 1.3070588349003267, test_best: 1.307807880786779
[INFO: 2020-09-07 04:14:57,648] mv_approxkl: 1.6624041077580122e-08
[INFO: 2020-09-07 04:14:57,648] beta: 0.5
[INFO: 2020-09-07 04:16:08,298] x: 1.6532440129533423, y: 1.647368383247977 @iteration 4200
[INFO: 2020-09-07 04:16:08,298] update predictor @iteration 4200
[INFO: 2020-09-07 04:21:32,347] test_current @iteration 4300: 1.3069215259928018, test_best: 1.307807880786779
[INFO: 2020-09-07 04:21:32,347] mv_approxkl: 4.4155778618524627e-13
[INFO: 2020-09-07 04:21:32,348] beta: 0.5
[INFO: 2020-09-07 04:22:42,885] x: 1.6623738161743962, y: 1.6555912436204603 @iteration 4300
[INFO: 2020-09-07 04:22:42,885] update predictor @iteration 4300
[INFO: 2020-09-07 04:28:07,523] test_current @iteration 4400: 1.306167199797856, test_best: 1.307807880786779
[INFO: 2020-09-07 04:28:07,523] mv_approxkl: 1.1728392490786417e-17
[INFO: 2020-09-07 04:28:07,523] beta: 0.5
[INFO: 2020-09-07 04:29:17,991] x: 1.6512951835830418, y: 1.653301422276931 @iteration 4400
[INFO: 2020-09-07 04:29:18,053] reload model @iteration 4400
[INFO: 2020-09-07 04:34:43,530] test_current @iteration 4500: 1.3068462607431137, test_best: 1.307807880786779
[INFO: 2020-09-07 04:34:43,530] mv_approxkl: 0.00045015624588067965
[INFO: 2020-09-07 04:34:43,530] beta: 0.5
[INFO: 2020-09-07 04:35:51,401] x: 1.6698982991464117, y: 1.6712986418358695 @iteration 4500
[INFO: 2020-09-07 04:35:51,462] reload model @iteration 4500
[INFO: 2020-09-07 04:41:10,445] test_current @iteration 4600: 1.306722040792211, test_best: 1.307807880786779
[INFO: 2020-09-07 04:41:10,445] mv_approxkl: 1.1956779608575661e-08
[INFO: 2020-09-07 04:41:10,445] beta: 0.5
[INFO: 2020-09-07 04:42:19,355] x: 1.6486838368461127, y: 1.6504125528551519 @iteration 4600
[INFO: 2020-09-07 04:42:19,417] reload model @iteration 4600
[INFO: 2020-09-07 04:47:39,161] test_current @iteration 4700: 1.3074919467805495, test_best: 1.307807880786779
[INFO: 2020-09-07 04:47:39,162] mv_approxkl: 3.1758879259435126e-13
[INFO: 2020-09-07 04:47:39,162] beta: 0.5
[INFO: 2020-09-07 04:48:46,928] x: 1.6605712840938207, y: 1.6743396777343604 @iteration 4700
[INFO: 2020-09-07 04:48:46,991] reload model @iteration 4700
[INFO: 2020-09-07 04:54:08,506] test_current @iteration 4800: 1.3061568353376332, test_best: 1.307807880786779
[INFO: 2020-09-07 04:54:08,506] mv_approxkl: 8.435602602325872e-18
[INFO: 2020-09-07 04:54:08,506] beta: 0.5
[INFO: 2020-09-07 04:55:16,153] x: 1.6128989010914745, y: 1.6168482109755735 @iteration 4800
[INFO: 2020-09-07 04:55:16,215] reload model @iteration 4800
[INFO: 2020-09-07 05:00:37,612] test_current @iteration 4900: 1.3065566673226985, test_best: 1.307807880786779
[INFO: 2020-09-07 05:00:37,612] mv_approxkl: 0.0003768168888544039
[INFO: 2020-09-07 05:00:37,612] beta: 0.5
[INFO: 2020-09-07 05:01:45,593] x: 1.62597324337646, y: 1.63094637136518 @iteration 4900
[INFO: 2020-09-07 05:01:45,655] reload model @iteration 4900
[INFO: 2020-09-07 05:07:07,263] test_current @iteration 5000: 1.306191997340052, test_best: 1.307807880786779
[INFO: 2020-09-07 05:07:07,264] mv_approxkl: 1.0008783692441564e-08
[INFO: 2020-09-07 05:07:07,264] beta: 0.5
[INFO: 2020-09-07 05:08:16,085] x: 1.6305464269468877, y: 1.6279578943616868 @iteration 5000
[INFO: 2020-09-07 05:08:16,086] update predictor @iteration 5000
[INFO: 2020-09-07 05:13:35,398] test_current @iteration 5100: 1.3074653069236621, test_best: 1.307807880786779
[INFO: 2020-09-07 05:13:35,398] mv_approxkl: 2.6584729603452177e-13
[INFO: 2020-09-07 05:13:35,398] beta: 0.5
[INFO: 2020-09-07 05:14:43,793] x: 1.6718926133288259, y: 1.6614131246509527 @iteration 5100
[INFO: 2020-09-07 05:14:43,793] update predictor @iteration 5100
[INFO: 2020-09-07 05:20:02,193] test_current @iteration 5200: 1.3071871207234351, test_best: 1.307807880786779
[INFO: 2020-09-07 05:20:02,193] mv_approxkl: 7.061276073159502e-18
[INFO: 2020-09-07 05:20:02,193] beta: 0.5
[INFO: 2020-09-07 05:21:10,508] x: 1.6606537247331699, y: 1.6439882680972595 @iteration 5200
[INFO: 2020-09-07 05:21:10,509] update predictor @iteration 5200
[INFO: 2020-09-07 05:26:30,879] test_current @iteration 5300: 1.3069631900869205, test_best: 1.307807880786779
[INFO: 2020-09-07 05:26:30,879] mv_approxkl: 1.8755737043456738e-22
[INFO: 2020-09-07 05:26:30,879] beta: 0.5
[INFO: 2020-09-07 05:27:38,583] x: 1.6722008701933582, y: 1.6698139393049423 @iteration 5300
[INFO: 2020-09-07 05:27:38,583] update predictor @iteration 5300
[INFO: 2020-09-07 05:32:57,785] test_current @iteration 5400: 1.3062899739823315, test_best: 1.307807880786779
[INFO: 2020-09-07 05:32:57,785] mv_approxkl: 4.981786130419562e-27
[INFO: 2020-09-07 05:32:57,785] beta: 0.5
[INFO: 2020-09-07 05:34:06,610] x: 1.639407090644259, y: 1.6442914118359409 @iteration 5400
[INFO: 2020-09-07 05:34:06,691] reload model @iteration 5400
[INFO: 2020-09-07 05:39:26,184] test_current @iteration 5500: 1.3069904589961499, test_best: 1.307807880786779
[INFO: 2020-09-07 05:39:26,184] mv_approxkl: 1.3232320858272515e-31
[INFO: 2020-09-07 05:39:26,184] beta: 0.5
[INFO: 2020-09-07 05:40:34,195] x: 1.6931775999904273, y: 1.6819820799663403 @iteration 5500
[INFO: 2020-09-07 05:40:34,196] update predictor @iteration 5500
[INFO: 2020-09-07 05:45:52,911] test_current @iteration 5600: 1.3072009622184098, test_best: 1.307807880786779
[INFO: 2020-09-07 05:45:52,912] mv_approxkl: 3.5146895252512125e-36
[INFO: 2020-09-07 05:45:52,912] beta: 0.5
[INFO: 2020-09-07 05:47:00,241] x: 1.6302348681241297, y: 1.6381739446842822 @iteration 5600
[INFO: 2020-09-07 05:47:00,303] reload model @iteration 5600
[INFO: 2020-09-07 05:52:19,042] test_current @iteration 5700: 1.3070024629974777, test_best: 1.307807880786779
[INFO: 2020-09-07 05:52:19,042] mv_approxkl: 9.335507044622313e-41
[INFO: 2020-09-07 05:52:19,043] beta: 0.5
[INFO: 2020-09-07 05:53:25,951] x: 1.6527800840060167, y: 1.6603384992443027 @iteration 5700
[INFO: 2020-09-07 05:53:26,012] reload model @iteration 5700
[INFO: 2020-09-07 05:58:44,385] test_current @iteration 5800: 1.3069518269342026, test_best: 1.307807880786779
[INFO: 2020-09-07 05:58:44,386] mv_approxkl: 2.479641264300968e-45
[INFO: 2020-09-07 05:58:44,386] beta: 0.5
[INFO: 2020-09-07 05:59:51,341] x: 1.6545412076423474, y: 1.6540159981544291 @iteration 5800
[INFO: 2020-09-07 05:59:51,402] reload model @iteration 5800
[INFO: 2020-09-07 06:05:09,678] test_current @iteration 5900: 1.3062732366125995, test_best: 1.307807880786779
[INFO: 2020-09-07 06:05:09,678] mv_approxkl: 6.586274071921992e-50
[INFO: 2020-09-07 06:05:09,678] beta: 0.5
[INFO: 2020-09-07 06:06:17,019] x: 1.6622963576267298, y: 1.6459664092195145 @iteration 5900
[INFO: 2020-09-07 06:06:17,020] update predictor @iteration 5900
[INFO: 2020-09-07 06:11:34,440] test_current @iteration 6000: 1.3066832252138192, test_best: 1.307807880786779
[INFO: 2020-09-07 06:11:34,440] mv_approxkl: 0.002196626921621338
[INFO: 2020-09-07 06:11:34,440] beta: 0.5
[INFO: 2020-09-07 06:12:41,764] x: 1.6426997638318293, y: 1.6384294691360146 @iteration 6000
[INFO: 2020-09-07 06:12:41,765] update predictor @iteration 6000
[INFO: 2020-09-07 06:17:59,783] test_current @iteration 6100: 1.3069379113159798, test_best: 1.307807880786779
[INFO: 2020-09-07 06:17:59,784] mv_approxkl: 0.0012555726126183154
[INFO: 2020-09-07 06:17:59,784] beta: 0.5
[INFO: 2020-09-07 06:19:06,534] x: 1.656278203609958, y: 1.657873492576151 @iteration 6100
[INFO: 2020-09-07 06:19:06,596] reload model @iteration 6100
[INFO: 2020-09-07 06:24:23,441] test_current @iteration 6200: 1.3073946372528422, test_best: 1.307807880786779
[INFO: 2020-09-07 06:24:23,441] mv_approxkl: 0.010634433466358182
[INFO: 2020-09-07 06:24:23,441] beta: 0.5
[INFO: 2020-09-07 06:25:30,745] x: 1.6710343270324615, y: 1.672012390654281 @iteration 6200
[INFO: 2020-09-07 06:25:30,806] reload model @iteration 6200
[INFO: 2020-09-07 06:30:49,458] test_current @iteration 6300: 1.3065778561115053, test_best: 1.307807880786779
[INFO: 2020-09-07 06:30:49,459] mv_approxkl: 2.824654292434499e-07
[INFO: 2020-09-07 06:30:49,459] beta: 0.5
[INFO: 2020-09-07 06:31:56,165] x: 1.678539396602991, y: 1.6674353229568113 @iteration 6300
[INFO: 2020-09-07 06:31:56,165] update predictor @iteration 6300
[INFO: 2020-09-07 06:37:12,139] test_current @iteration 6400: 1.306210441003236, test_best: 1.307807880786779
[INFO: 2020-09-07 06:37:12,140] mv_approxkl: 7.502676938088905e-12
[INFO: 2020-09-07 06:37:12,140] beta: 0.5
[INFO: 2020-09-07 06:38:20,121] x: 1.6586212030012288, y: 1.6651759883384336 @iteration 6400
[INFO: 2020-09-07 06:38:20,183] reload model @iteration 6400
[INFO: 2020-09-07 06:43:37,268] test_current @iteration 6500: 1.306234835499226, test_best: 1.307807880786779
[INFO: 2020-09-07 06:43:37,269] mv_approxkl: 1.9928159487728333e-16
[INFO: 2020-09-07 06:43:37,269] beta: 0.5
[INFO: 2020-09-07 06:44:44,344] x: 1.640981400189957, y: 1.6325247212607403 @iteration 6500
[INFO: 2020-09-07 06:44:44,345] update predictor @iteration 6500
[INFO: 2020-09-07 06:50:02,134] test_current @iteration 6600: 1.3066348418226243, test_best: 1.307807880786779
[INFO: 2020-09-07 06:50:02,134] mv_approxkl: 5.293197932490142e-21
[INFO: 2020-09-07 06:50:02,134] beta: 0.5
[INFO: 2020-09-07 06:51:08,714] x: 1.6451436660286043, y: 1.6438442934368436 @iteration 6600
[INFO: 2020-09-07 06:51:08,714] update predictor @iteration 6600
[INFO: 2020-09-07 06:56:25,760] test_current @iteration 6700: 1.3068964495790079, test_best: 1.307807880786779
[INFO: 2020-09-07 06:56:25,761] mv_approxkl: 0.0002585116606803081
[INFO: 2020-09-07 06:56:25,761] beta: 0.5
[INFO: 2020-09-07 06:57:32,350] x: 1.6777155501742214, y: 1.6764891915039744 @iteration 6700
[INFO: 2020-09-07 06:57:32,350] update predictor @iteration 6700
[INFO: 2020-09-07 07:02:49,356] test_current @iteration 6800: 1.306675190209508, test_best: 1.307807880786779
[INFO: 2020-09-07 07:02:49,356] mv_approxkl: 6.866431336422346e-09
[INFO: 2020-09-07 07:02:49,356] beta: 0.5
[INFO: 2020-09-07 07:03:56,849] x: 1.6783391905000329, y: 1.665920133999159 @iteration 6800
[INFO: 2020-09-07 07:03:56,850] update predictor @iteration 6800
[INFO: 2020-09-07 07:09:12,705] test_current @iteration 6900: 1.3073272553205202, test_best: 1.307807880786779
[INFO: 2020-09-07 07:09:12,705] mv_approxkl: 1.8238202166094463e-13
[INFO: 2020-09-07 07:09:12,706] beta: 0.5
[INFO: 2020-09-07 07:10:18,199] x: 1.6434442902355146, y: 1.644828727847277 @iteration 6900
[INFO: 2020-09-07 07:10:18,260] reload model @iteration 6900
[INFO: 2020-09-07 07:15:37,077] test_current @iteration 7000: 1.3066659895363133, test_best: 1.307807880786779
[INFO: 2020-09-07 07:15:37,077] mv_approxkl: 4.844321627260982e-18
[INFO: 2020-09-07 07:15:37,077] beta: 0.5
[INFO: 2020-09-07 07:16:43,772] x: 1.6668672511162512, y: 1.6670659588386814 @iteration 7000
[INFO: 2020-09-07 07:16:43,833] reload model @iteration 7000
[INFO: 2020-09-07 07:22:06,251] test_current @iteration 7100: 1.3069166189649382, test_best: 1.307807880786779
[INFO: 2020-09-07 07:22:06,252] mv_approxkl: 0.012504485690265854
[INFO: 2020-09-07 07:22:06,252] beta: 0.5
[INFO: 2020-09-07 07:23:14,600] x: 1.6799616723511768, y: 1.676844360384881 @iteration 7100
[INFO: 2020-09-07 07:23:14,601] update predictor @iteration 7100
[INFO: 2020-09-07 07:28:31,372] test_current @iteration 7200: 1.3068038094932413, test_best: 1.307807880786779
[INFO: 2020-09-07 07:28:31,372] mv_approxkl: 0.09098238243249143
[INFO: 2020-09-07 07:28:31,373] beta: 100
[INFO: 2020-09-07 07:29:39,423] x: 1.641349762042584, y: 1.6538626856946723 @iteration 7200
[INFO: 2020-09-07 07:29:39,485] reload model @iteration 7200
[INFO: 2020-09-07 07:34:50,352] Training with config:
[INFO: 2020-09-07 07:34:50,354] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 07:36:05,716] test_current @iteration 0: 1.307807880786779, test_best: 1.307807880786779
[INFO: 2020-09-07 07:41:26,131] test_current @iteration 100: 1.306311043454594, test_best: 1.307807880786779
[INFO: 2020-09-07 07:41:26,131] mv_approxkl: 0.0973327155278659
[INFO: 2020-09-07 07:41:26,132] beta: 100
[INFO: 2020-09-07 07:42:35,747] u: 810, v: 827 @iteration 100
[INFO: 2020-09-07 07:47:54,332] test_current @iteration 200: 1.306071414384682, test_best: 1.307807880786779
[INFO: 2020-09-07 07:47:54,332] mv_approxkl: 0.13737133573285498
[INFO: 2020-09-07 07:47:54,332] beta: 100
[INFO: 2020-09-07 07:49:04,844] u: 813, v: 849 @iteration 200
[INFO: 2020-09-07 07:49:04,905] reload model @iteration 200
[INFO: 2020-09-07 07:54:22,751] test_current @iteration 300: 1.3065581893051066, test_best: 1.307807880786779
[INFO: 2020-09-07 07:54:22,751] mv_approxkl: 1.3911821190925768
[INFO: 2020-09-07 07:54:22,751] beta: 100
[INFO: 2020-09-07 07:55:31,632] u: 770, v: 794 @iteration 300
[INFO: 2020-09-07 08:00:48,360] test_current @iteration 400: 1.3045296694347543, test_best: 1.307807880786779
[INFO: 2020-09-07 08:00:48,360] mv_approxkl: 0.9060652384418122
[INFO: 2020-09-07 08:00:48,360] beta: 100
[INFO: 2020-09-07 08:01:57,757] u: 829, v: 799 @iteration 400
[INFO: 2020-09-07 08:01:57,819] reload model @iteration 400
[INFO: 2020-09-07 08:07:16,277] test_current @iteration 500: 1.306949069590272, test_best: 1.307807880786779
[INFO: 2020-09-07 08:07:16,277] mv_approxkl: 0.34125076557726686
[INFO: 2020-09-07 08:07:16,277] beta: 8.0
[INFO: 2020-09-07 08:08:26,831] u: 801, v: 810 @iteration 500
[INFO: 2020-09-07 08:13:46,001] test_current @iteration 600: 1.3072503992515332, test_best: 1.307807880786779
[INFO: 2020-09-07 08:13:46,002] mv_approxkl: 0.015716819763994836
[INFO: 2020-09-07 08:13:46,002] beta: 0.5
[INFO: 2020-09-07 08:14:55,458] u: 755, v: 846 @iteration 600
[INFO: 2020-09-07 08:14:55,519] reload model @iteration 600
[INFO: 2020-09-07 08:20:13,122] test_current @iteration 700: 1.3079741751949712, test_best: 1.307807880786779
[INFO: 2020-09-07 08:20:13,122] mv_approxkl: 4.1746071899578643e-07
[INFO: 2020-09-07 08:20:13,122] beta: 0.5
[INFO: 2020-09-07 08:21:22,736] u: 825, v: 867 @iteration 700
[INFO: 2020-09-07 08:26:41,112] test_current @iteration 800: 1.3080686331302214, test_best: 1.3079741751949712
[INFO: 2020-09-07 08:26:41,112] mv_approxkl: 0.0002835464731135299
[INFO: 2020-09-07 08:26:41,112] beta: 0.5
[INFO: 2020-09-07 08:27:49,398] u: 801, v: 821 @iteration 800
[INFO: 2020-09-07 08:27:49,459] reload model @iteration 800
[INFO: 2020-09-07 08:33:08,731] test_current @iteration 900: 1.3078077868575817, test_best: 1.3080686331302214
[INFO: 2020-09-07 08:33:08,731] mv_approxkl: 7.531390975537088e-09
[INFO: 2020-09-07 08:33:08,731] beta: 0.5
[INFO: 2020-09-07 08:34:18,459] u: 832, v: 814 @iteration 900
[INFO: 2020-09-07 08:39:37,024] test_current @iteration 1000: 1.3078556188618804, test_best: 1.3080686331302214
[INFO: 2020-09-07 08:39:37,024] mv_approxkl: 6.270637804641259e-06
[INFO: 2020-09-07 08:39:37,024] beta: 0.5
[INFO: 2020-09-07 08:40:47,124] u: 789, v: 806 @iteration 1000
[INFO: 2020-09-07 08:40:47,185] reload model @iteration 1000
[INFO: 2020-09-07 08:46:06,248] test_current @iteration 1100: 1.307742762811373, test_best: 1.3080686331302214
[INFO: 2020-09-07 08:46:06,248] mv_approxkl: 1.6655691200866272e-10
[INFO: 2020-09-07 08:46:06,248] beta: 0.5
[INFO: 2020-09-07 08:47:15,699] u: 812, v: 788 @iteration 1100
[INFO: 2020-09-07 08:52:34,851] test_current @iteration 1200: 1.3079112214670432, test_best: 1.3080686331302214
[INFO: 2020-09-07 08:52:34,852] mv_approxkl: 4.42398457734691e-15
[INFO: 2020-09-07 08:52:34,852] beta: 0.5
[INFO: 2020-09-07 08:53:42,954] u: 822, v: 750 @iteration 1200
[INFO: 2020-09-07 08:53:42,954] update predictor @iteration 1200
[INFO: 2020-09-07 08:59:00,152] test_current @iteration 1300: 1.308002545109643, test_best: 1.3080686331302214
[INFO: 2020-09-07 08:59:00,153] mv_approxkl: 1.175072190314467e-19
[INFO: 2020-09-07 08:59:00,153] beta: 0.5
[INFO: 2020-09-07 09:00:09,099] u: 818, v: 820 @iteration 1300
[INFO: 2020-09-07 09:05:26,500] test_current @iteration 1400: 1.3076721502738016, test_best: 1.3080686331302214
[INFO: 2020-09-07 09:05:26,501] mv_approxkl: 2.0057400069746586e-05
[INFO: 2020-09-07 09:05:26,501] beta: 0.5
[INFO: 2020-09-07 09:06:36,377] u: 833, v: 817 @iteration 1400
[INFO: 2020-09-07 09:06:36,437] reload model @iteration 1400
[INFO: 2020-09-07 09:11:55,190] test_current @iteration 1500: 1.3077434118090474, test_best: 1.3080686331302214
[INFO: 2020-09-07 09:11:55,190] mv_approxkl: 5.327526039004654e-10
[INFO: 2020-09-07 09:11:55,190] beta: 0.5
[INFO: 2020-09-07 09:13:04,829] u: 799, v: 828 @iteration 1500
[INFO: 2020-09-07 10:28:21,448] Training with config:
[INFO: 2020-09-07 10:28:21,450] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 10:35:39,959] iteration 100
[INFO: 2020-09-07 10:36:40,410] ######## Iteration (TEST) 100 ########
[INFO: 2020-09-07 10:36:40,410] {'CIDEr': 1.3254639571910627}
[INFO: 2020-09-07 10:43:40,877] iteration 200
[INFO: 2020-09-07 10:44:41,609] ######## Iteration (TEST) 200 ########
[INFO: 2020-09-07 10:44:41,609] {'CIDEr': 1.3273897390495244}
[INFO: 2020-09-07 10:51:42,358] iteration 300
[INFO: 2020-09-07 10:52:42,954] ######## Iteration (TEST) 300 ########
[INFO: 2020-09-07 10:52:42,954] {'CIDEr': 1.3297404778721102}
[INFO: 2020-09-07 10:59:42,717] iteration 400
[INFO: 2020-09-07 11:00:43,060] ######## Iteration (TEST) 400 ########
[INFO: 2020-09-07 11:00:43,060] {'CIDEr': 1.3294831270367151}
[INFO: 2020-09-07 11:07:42,344] iteration 500
[INFO: 2020-09-07 11:08:43,402] ######## Iteration (TEST) 500 ########
[INFO: 2020-09-07 11:08:43,403] {'CIDEr': 1.3257082783984955}
[INFO: 2020-09-07 11:15:42,866] iteration 600
[INFO: 2020-09-07 11:16:44,048] ######## Iteration (TEST) 600 ########
[INFO: 2020-09-07 11:16:44,048] {'CIDEr': 1.3197969467551436}
[INFO: 2020-09-07 11:23:42,774] iteration 700
[INFO: 2020-09-07 11:24:44,076] ######## Iteration (TEST) 700 ########
[INFO: 2020-09-07 11:24:44,076] {'CIDEr': 1.3251748949319613}
[INFO: 2020-09-07 11:31:45,862] iteration 800
[INFO: 2020-09-07 11:32:47,459] ######## Iteration (TEST) 800 ########
[INFO: 2020-09-07 11:32:47,459] {'CIDEr': 1.3280726534798286}
[INFO: 2020-09-07 11:39:50,090] iteration 900
[INFO: 2020-09-07 11:40:50,846] ######## Iteration (TEST) 900 ########
[INFO: 2020-09-07 11:40:50,847] {'CIDEr': 1.3276063850510993}
[INFO: 2020-09-07 11:47:54,259] iteration 1000
[INFO: 2020-09-07 11:48:54,291] ######## Iteration (TEST) 1000 ########
[INFO: 2020-09-07 11:48:54,292] {'CIDEr': 1.3273596844926863}
[INFO: 2020-09-07 11:55:57,606] iteration 1100
[INFO: 2020-09-07 11:56:57,791] ######## Iteration (TEST) 1100 ########
[INFO: 2020-09-07 11:56:57,791] {'CIDEr': 1.323818157506719}
[INFO: 2020-09-07 12:02:41,681] Training with config:
[INFO: 2020-09-07 12:02:41,683] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 12:03:58,633] test_current @iteration 0: 1.3279842681794274, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:05:40,743] test_current @iteration 16: 1.3266930432411466, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:05:40,743] mv_approxkl: 0.000319379716875183
[INFO: 2020-09-07 12:05:40,743] beta: 1.0
[INFO: 2020-09-07 12:06:46,473] u: 628, v: 651 @iteration 16
[INFO: 2020-09-07 12:08:26,334] test_current @iteration 32: 1.3248520083750681, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:08:26,334] mv_approxkl: 0.0007907135601756387
[INFO: 2020-09-07 12:08:26,334] beta: 1.0
[INFO: 2020-09-07 12:09:31,114] u: 640, v: 637 @iteration 32
[INFO: 2020-09-07 12:09:31,178] reload model @iteration 32
[INFO: 2020-09-07 12:11:12,512] test_current @iteration 48: 1.326433833552298, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:11:12,513] mv_approxkl: 0.00021215290643595685
[INFO: 2020-09-07 12:11:12,513] beta: 1.0
[INFO: 2020-09-07 12:12:16,296] u: 620, v: 624 @iteration 48
[INFO: 2020-09-07 12:13:55,960] test_current @iteration 64: 1.326627196638637, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:13:55,960] mv_approxkl: 0.0005180604394942602
[INFO: 2020-09-07 12:13:55,961] beta: 1.0
[INFO: 2020-09-07 12:15:00,569] u: 570, v: 622 @iteration 64
[INFO: 2020-09-07 12:15:00,631] reload model @iteration 64
[INFO: 2020-09-07 12:16:41,260] test_current @iteration 80: 1.325769377121185, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:16:41,260] mv_approxkl: 0.0001671102431338525
[INFO: 2020-09-07 12:16:41,260] beta: 1.0
[INFO: 2020-09-07 12:17:46,733] u: 617, v: 604 @iteration 80
[INFO: 2020-09-07 12:19:27,737] test_current @iteration 96: 1.3262626837099425, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:19:27,737] mv_approxkl: 0.00030406818862120747
[INFO: 2020-09-07 12:19:27,737] beta: 1.0
[INFO: 2020-09-07 12:20:32,366] u: 633, v: 630 @iteration 96
[INFO: 2020-09-07 12:20:32,427] reload model @iteration 96
[INFO: 2020-09-07 12:22:11,994] test_current @iteration 112: 1.3268964231125195, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:22:11,995] mv_approxkl: 0.0001273968842768871
[INFO: 2020-09-07 12:22:11,995] beta: 1.0
[INFO: 2020-09-07 12:23:16,349] u: 614, v: 648 @iteration 112
[INFO: 2020-09-07 12:24:55,447] test_current @iteration 128: 1.3265977688976915, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:24:55,448] mv_approxkl: 0.00024612721064485503
[INFO: 2020-09-07 12:24:55,448] beta: 1.0
[INFO: 2020-09-07 12:25:59,038] u: 630, v: 651 @iteration 128
[INFO: 2020-09-07 12:25:59,100] reload model @iteration 128
[INFO: 2020-09-07 12:27:38,953] test_current @iteration 144: 1.3256371108322702, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:27:38,953] mv_approxkl: 0.00012802946249881254
[INFO: 2020-09-07 12:27:38,953] beta: 1.0
[INFO: 2020-09-07 12:28:43,130] u: 674, v: 614 @iteration 144
[INFO: 2020-09-07 12:28:43,131] update predictor @iteration 144
[INFO: 2020-09-07 12:30:22,266] test_current @iteration 160: 1.3250727390368726, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:30:22,266] mv_approxkl: 7.323286809332129e-05
[INFO: 2020-09-07 12:30:22,266] beta: 1.0
[INFO: 2020-09-07 12:31:26,376] u: 593, v: 623 @iteration 160
[INFO: 2020-09-07 12:33:07,049] test_current @iteration 176: 1.3252040424699771, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:33:07,049] mv_approxkl: 0.0003134119580837564
[INFO: 2020-09-07 12:33:07,049] beta: 1.0
[INFO: 2020-09-07 12:34:10,794] u: 622, v: 644 @iteration 176
[INFO: 2020-09-07 12:34:10,855] reload model @iteration 176
[INFO: 2020-09-07 12:35:49,939] test_current @iteration 192: 1.323999100768443, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:35:49,939] mv_approxkl: 0.00014693175367740723
[INFO: 2020-09-07 12:35:49,939] beta: 1.0
[INFO: 2020-09-07 12:36:53,794] u: 621, v: 636 @iteration 192
[INFO: 2020-09-07 12:38:32,889] test_current @iteration 208: 1.323797067424497, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:38:32,890] mv_approxkl: 0.0006675106726061197
[INFO: 2020-09-07 12:38:32,890] beta: 1.0
[INFO: 2020-09-07 12:39:36,780] u: 635, v: 633 @iteration 208
[INFO: 2020-09-07 12:39:36,843] reload model @iteration 208
[INFO: 2020-09-07 12:41:16,859] test_current @iteration 224: 1.3267070387463853, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:41:16,859] mv_approxkl: 0.00030345414603210875
[INFO: 2020-09-07 12:41:16,859] beta: 1.0
[INFO: 2020-09-07 12:42:21,103] u: 619, v: 572 @iteration 224
[INFO: 2020-09-07 12:42:21,104] update predictor @iteration 224
[INFO: 2020-09-07 12:43:07,787] Training with config:
[INFO: 2020-09-07 12:43:07,789] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 12:44:24,173] test_current @iteration 0: 1.3279842681794274, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:46:06,159] test_current @iteration 16: 1.3275973511933958, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:46:06,159] mv_approxkl: 0.0003364421304517105
[INFO: 2020-09-07 12:46:06,159] beta: 1.0
[INFO: 2020-09-07 12:47:11,515] u: 623, v: 654 @iteration 16
[INFO: 2020-09-07 12:48:51,249] test_current @iteration 32: 1.327315659062237, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:48:51,250] mv_approxkl: 0.0007085713504991776
[INFO: 2020-09-07 12:48:51,250] beta: 1.0
[INFO: 2020-09-07 12:49:54,870] u: 637, v: 631 @iteration 32
[INFO: 2020-09-07 12:51:36,510] test_current @iteration 48: 1.3270765665312516, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:51:36,510] mv_approxkl: 0.001065239046802932
[INFO: 2020-09-07 12:51:36,510] beta: 1.0
[INFO: 2020-09-07 12:52:40,462] u: 607, v: 618 @iteration 48
[INFO: 2020-09-07 12:54:20,526] test_current @iteration 64: 1.325313266809474, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:54:20,526] mv_approxkl: 0.0016207606673596644
[INFO: 2020-09-07 12:54:20,526] beta: 1.0
[INFO: 2020-09-07 12:55:24,020] u: 653, v: 602 @iteration 64
[INFO: 2020-09-07 12:55:24,021] update predictor @iteration 64
[INFO: 2020-09-07 12:57:04,539] test_current @iteration 80: 1.3258395349424907, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:57:04,539] mv_approxkl: 0.00037561340267174806
[INFO: 2020-09-07 12:57:04,539] beta: 1.0
[INFO: 2020-09-07 12:58:09,633] u: 640, v: 625 @iteration 80
[INFO: 2020-09-07 12:59:50,181] test_current @iteration 96: 1.3264993444815227, test_best: 1.3279842681794274
[INFO: 2020-09-07 12:59:50,181] mv_approxkl: 0.0008634974654998241
[INFO: 2020-09-07 12:59:50,181] beta: 1.0
[INFO: 2020-09-07 13:00:54,855] u: 599, v: 610 @iteration 96
[INFO: 2020-09-07 13:02:34,468] test_current @iteration 112: 1.326454791158813, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:02:34,468] mv_approxkl: 0.000559547804043451
[INFO: 2020-09-07 13:02:34,468] beta: 1.0
[INFO: 2020-09-07 13:03:39,044] u: 672, v: 578 @iteration 112
[INFO: 2020-09-07 13:03:39,044] update predictor @iteration 112
[INFO: 2020-09-07 13:05:18,577] test_current @iteration 128: 1.3270899083747956, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:05:18,577] mv_approxkl: 0.00011799390590385781
[INFO: 2020-09-07 13:05:18,578] beta: 1.0
[INFO: 2020-09-07 13:06:22,194] u: 604, v: 657 @iteration 128
[INFO: 2020-09-07 13:08:03,234] test_current @iteration 144: 1.3262429939777822, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:08:03,235] mv_approxkl: 0.00019171890431993852
[INFO: 2020-09-07 13:08:03,235] beta: 1.0
[INFO: 2020-09-07 13:09:08,649] u: 661, v: 594 @iteration 144
[INFO: 2020-09-07 13:09:08,649] update predictor @iteration 144
[INFO: 2020-09-07 13:10:47,108] test_current @iteration 160: 1.3249728582629325, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:10:47,109] mv_approxkl: 8.912918405866816e-05
[INFO: 2020-09-07 13:10:47,109] beta: 1.0
[INFO: 2020-09-07 13:11:51,055] u: 596, v: 614 @iteration 160
[INFO: 2020-09-07 13:13:31,848] test_current @iteration 176: 1.3254651813973148, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:13:31,848] mv_approxkl: 0.00024263121991581227
[INFO: 2020-09-07 13:13:31,849] beta: 1.0
[INFO: 2020-09-07 13:14:35,348] u: 647, v: 629 @iteration 176
[INFO: 2020-09-07 13:16:13,909] test_current @iteration 192: 1.3271186012244571, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:16:13,909] mv_approxkl: 0.0003826956107960713
[INFO: 2020-09-07 13:16:13,909] beta: 1.0
[INFO: 2020-09-07 13:17:17,601] u: 603, v: 659 @iteration 192
[INFO: 2020-09-07 13:18:56,686] test_current @iteration 208: 1.32425585385359, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:18:56,686] mv_approxkl: 0.0009352181246153816
[INFO: 2020-09-07 13:18:56,686] beta: 1.0
[INFO: 2020-09-07 13:20:01,454] u: 612, v: 648 @iteration 208
[INFO: 2020-09-07 13:21:41,463] test_current @iteration 224: 1.3266548086098562, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:21:41,464] mv_approxkl: 0.0008489165669371033
[INFO: 2020-09-07 13:21:41,464] beta: 1.0
[INFO: 2020-09-07 13:22:45,138] u: 602, v: 644 @iteration 224
[INFO: 2020-09-07 13:22:45,199] reload model @iteration 224
[INFO: 2020-09-07 13:24:24,685] test_current @iteration 240: 1.32702146237348, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:24:24,685] mv_approxkl: 0.00022208387029551464
[INFO: 2020-09-07 13:24:24,685] beta: 1.0
[INFO: 2020-09-07 13:25:28,988] u: 622, v: 623 @iteration 240
[INFO: 2020-09-07 13:27:09,140] test_current @iteration 256: 1.327276286158412, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:27:09,140] mv_approxkl: 0.0003919924863471005
[INFO: 2020-09-07 13:27:09,140] beta: 1.0
[INFO: 2020-09-07 13:28:14,764] u: 616, v: 625 @iteration 256
[INFO: 2020-09-07 13:29:54,308] test_current @iteration 272: 1.3265911668862176, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:29:54,309] mv_approxkl: 0.0006679145010163405
[INFO: 2020-09-07 13:29:54,309] beta: 1.0
[INFO: 2020-09-07 13:30:58,832] u: 607, v: 670 @iteration 272
[INFO: 2020-09-07 13:32:38,620] test_current @iteration 288: 1.3277317913562863, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:32:38,620] mv_approxkl: 0.0014711288728246944
[INFO: 2020-09-07 13:32:38,620] beta: 1.0
[INFO: 2020-09-07 13:33:42,198] u: 614, v: 601 @iteration 288
[INFO: 2020-09-07 13:35:22,145] test_current @iteration 304: 1.326845471604572, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:35:22,145] mv_approxkl: 0.0010836517648507191
[INFO: 2020-09-07 13:35:22,145] beta: 1.0
[INFO: 2020-09-07 13:36:25,921] u: 634, v: 603 @iteration 304
[INFO: 2020-09-07 13:36:25,922] update predictor @iteration 304
[INFO: 2020-09-07 13:38:05,161] test_current @iteration 320: 1.3280078025275894, test_best: 1.3279842681794274
[INFO: 2020-09-07 13:38:05,161] mv_approxkl: 0.00024353483421635965
[INFO: 2020-09-07 13:38:05,161] beta: 1.0
[INFO: 2020-09-07 13:39:08,812] u: 588, v: 603 @iteration 320
[INFO: 2020-09-07 13:40:48,217] test_current @iteration 336: 1.3269464542066847, test_best: 1.3280078025275894
[INFO: 2020-09-07 13:40:48,217] mv_approxkl: 0.0010193857002957828
[INFO: 2020-09-07 13:40:48,217] beta: 1.0
[INFO: 2020-09-07 13:41:52,123] u: 622, v: 630 @iteration 336
[INFO: 2020-09-07 13:43:31,578] test_current @iteration 352: 1.3261214779364425, test_best: 1.3280078025275894
[INFO: 2020-09-07 13:43:31,578] mv_approxkl: 0.0005191917938230711
[INFO: 2020-09-07 13:43:31,578] beta: 1.0
[INFO: 2020-09-07 13:44:36,072] u: 617, v: 622 @iteration 352
[INFO: 2020-09-07 13:46:15,756] test_current @iteration 368: 1.3276226992422981, test_best: 1.3280078025275894
[INFO: 2020-09-07 13:46:15,756] mv_approxkl: 0.0006040342410951122
[INFO: 2020-09-07 13:46:15,756] beta: 1.0
[INFO: 2020-09-07 13:47:20,563] u: 568, v: 596 @iteration 368
[INFO: 2020-09-07 13:49:00,713] test_current @iteration 384: 1.3259458262028492, test_best: 1.3280078025275894
[INFO: 2020-09-07 13:49:00,713] mv_approxkl: 0.0011475767473519427
[INFO: 2020-09-07 13:49:00,713] beta: 1.0
[INFO: 2020-09-07 13:50:04,605] u: 619, v: 653 @iteration 384
[INFO: 2020-09-07 13:50:04,667] reload model @iteration 384
[INFO: 2020-09-07 13:51:45,041] test_current @iteration 400: 1.3258636686206702, test_best: 1.3280078025275894
[INFO: 2020-09-07 13:51:45,042] mv_approxkl: 0.000516081715142913
[INFO: 2020-09-07 13:51:45,042] beta: 1.0
[INFO: 2020-09-07 13:52:50,464] u: 630, v: 594 @iteration 400
[INFO: 2020-09-07 13:52:50,464] update predictor @iteration 400
[INFO: 2020-09-07 13:54:29,861] test_current @iteration 416: 1.3272615351959898, test_best: 1.3280078025275894
[INFO: 2020-09-07 13:54:29,861] mv_approxkl: 0.00016113677672311295
[INFO: 2020-09-07 13:54:29,861] beta: 1.0
[INFO: 2020-09-07 13:55:33,320] u: 641, v: 652 @iteration 416
[INFO: 2020-09-07 13:57:13,446] test_current @iteration 432: 1.3283202180566016, test_best: 1.3280078025275894
[INFO: 2020-09-07 13:57:13,446] mv_approxkl: 0.0002737306695564489
[INFO: 2020-09-07 13:57:13,446] beta: 1.0
[INFO: 2020-09-07 13:58:18,243] u: 644, v: 640 @iteration 432
[INFO: 2020-09-07 13:59:58,427] test_current @iteration 448: 1.3266856702823644, test_best: 1.3283202180566016
[INFO: 2020-09-07 13:59:58,427] mv_approxkl: 0.000939741082653424
[INFO: 2020-09-07 13:59:58,427] beta: 1.0
[INFO: 2020-09-07 14:01:02,661] u: 627, v: 648 @iteration 448
[INFO: 2020-09-07 14:02:42,117] test_current @iteration 464: 1.328812802387672, test_best: 1.3283202180566016
[INFO: 2020-09-07 14:02:42,117] mv_approxkl: 0.0008083180734812515
[INFO: 2020-09-07 14:02:42,117] beta: 1.0
[INFO: 2020-09-07 14:03:46,845] u: 627, v: 625 @iteration 464
[INFO: 2020-09-07 14:05:27,427] test_current @iteration 480: 1.3266429179000911, test_best: 1.328812802387672
[INFO: 2020-09-07 14:05:27,428] mv_approxkl: 0.0007507999532529109
[INFO: 2020-09-07 14:05:27,428] beta: 1.0
[INFO: 2020-09-07 14:06:32,369] u: 659, v: 605 @iteration 480
[INFO: 2020-09-07 14:06:32,370] update predictor @iteration 480
[INFO: 2020-09-07 14:08:11,888] test_current @iteration 496: 1.327187756692068, test_best: 1.328812802387672
[INFO: 2020-09-07 14:08:11,888] mv_approxkl: 0.00019071983818403897
[INFO: 2020-09-07 14:08:11,888] beta: 1.0
[INFO: 2020-09-07 14:09:15,536] u: 641, v: 608 @iteration 496
[INFO: 2020-09-07 14:09:15,537] update predictor @iteration 496
[INFO: 2020-09-07 14:10:55,145] test_current @iteration 512: 1.3245803288142095, test_best: 1.328812802387672
[INFO: 2020-09-07 14:10:55,146] mv_approxkl: 0.00012688196215078433
[INFO: 2020-09-07 14:10:55,146] beta: 1.0
[INFO: 2020-09-07 14:11:58,916] u: 622, v: 625 @iteration 512
[INFO: 2020-09-07 14:13:39,025] test_current @iteration 528: 1.3252325669657545, test_best: 1.328812802387672
[INFO: 2020-09-07 14:13:39,025] mv_approxkl: 0.0004608818586825808
[INFO: 2020-09-07 14:13:39,025] beta: 1.0
[INFO: 2020-09-07 14:14:05,416] Training with config:
[INFO: 2020-09-07 14:14:05,418] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 14:15:22,158] test_current @iteration 0: 1.3279842681794274, test_best: 1.3279842681794274
[INFO: 2020-09-07 14:17:03,881] test_current @iteration 16: 1.3282268859258912, test_best: 1.3279842681794274
[INFO: 2020-09-07 14:17:03,881] mv_approxkl: 0.00022961211450191129
[INFO: 2020-09-07 14:17:03,881] beta: 1.0
[INFO: 2020-09-07 14:18:08,829] x: 1.725383279433026, y: 1.7189262168044097 @iteration 16
[INFO: 2020-09-07 14:18:08,829] update predictor @iteration 16
[INFO: 2020-09-07 14:19:48,885] test_current @iteration 32: 1.326098754943687, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:19:48,886] mv_approxkl: 0.0002112863250980312
[INFO: 2020-09-07 14:19:48,886] beta: 1.0
[INFO: 2020-09-07 14:20:53,322] x: 1.7437271279718272, y: 1.7446006015917763 @iteration 32
[INFO: 2020-09-07 14:22:33,889] test_current @iteration 48: 1.3272513101615653, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:22:33,890] mv_approxkl: 0.00026597773252738676
[INFO: 2020-09-07 14:22:33,890] beta: 1.0
[INFO: 2020-09-07 14:23:37,523] x: 1.7291315028190368, y: 1.7259886126367041 @iteration 48
[INFO: 2020-09-07 14:23:37,523] update predictor @iteration 48
[INFO: 2020-09-07 14:25:17,338] test_current @iteration 64: 1.3261286987596508, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:25:17,338] mv_approxkl: 0.0012845677980324894
[INFO: 2020-09-07 14:25:17,338] beta: 1.0
[INFO: 2020-09-07 14:26:22,021] x: 1.741802112703391, y: 1.7366444665469232 @iteration 64
[INFO: 2020-09-07 14:26:22,022] update predictor @iteration 64
[INFO: 2020-09-07 14:28:02,192] test_current @iteration 80: 1.324379893492543, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:28:02,193] mv_approxkl: 0.000321298276264508
[INFO: 2020-09-07 14:28:02,193] beta: 1.0
[INFO: 2020-09-07 14:29:06,495] x: 1.7102012698540898, y: 1.70228035681733 @iteration 80
[INFO: 2020-09-07 14:29:06,496] update predictor @iteration 80
[INFO: 2020-09-07 14:30:47,082] test_current @iteration 96: 1.3246325527890008, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:30:47,083] mv_approxkl: 0.00010624141269178428
[INFO: 2020-09-07 14:30:47,083] beta: 1.0
[INFO: 2020-09-07 14:31:51,770] x: 1.7443641001100076, y: 1.7475235757412508 @iteration 96
[INFO: 2020-09-07 14:33:30,909] test_current @iteration 112: 1.3257493211386924, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:33:30,909] mv_approxkl: 0.0002226403804120357
[INFO: 2020-09-07 14:33:30,909] beta: 1.0
[INFO: 2020-09-07 14:34:34,703] x: 1.728672733944517, y: 1.7354014902175303 @iteration 112
[INFO: 2020-09-07 14:36:14,009] test_current @iteration 128: 1.3243553040467086, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:36:14,009] mv_approxkl: 0.0005149756795429871
[INFO: 2020-09-07 14:36:14,010] beta: 1.0
[INFO: 2020-09-07 14:37:18,294] x: 1.738749542234317, y: 1.7271436523314907 @iteration 128
[INFO: 2020-09-07 14:37:18,294] update predictor @iteration 128
[INFO: 2020-09-07 14:38:58,209] test_current @iteration 144: 1.3252318359526587, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:38:58,209] mv_approxkl: 0.00017533941591093503
[INFO: 2020-09-07 14:38:58,209] beta: 1.0
[INFO: 2020-09-07 14:40:02,448] x: 1.720518194410774, y: 1.71948014559424 @iteration 144
[INFO: 2020-09-07 14:40:02,448] update predictor @iteration 144
[INFO: 2020-09-07 14:41:41,798] test_current @iteration 160: 1.3257830338745222, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:41:41,798] mv_approxkl: 0.00013974775396472942
[INFO: 2020-09-07 14:41:41,798] beta: 1.0
[INFO: 2020-09-07 14:42:45,817] x: 1.7699850804493271, y: 1.7605380764781169 @iteration 160
[INFO: 2020-09-07 14:42:45,818] update predictor @iteration 160
[INFO: 2020-09-07 14:44:25,711] test_current @iteration 176: 1.3266939344672894, test_best: 1.3282268859258912
[INFO: 2020-09-07 14:44:25,711] mv_approxkl: 6.226492419793758e-05
[INFO: 2020-09-07 14:44:25,711] beta: 1.0
[INFO: 2020-09-07 14:45:08,284] Training with config:
[INFO: 2020-09-07 14:45:08,286] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 14:46:25,175] ######## Epoch (VAL)0 ########
[INFO: 2020-09-07 14:46:25,175] {'CIDEr': 1.3134830622722575}
[INFO: 2020-09-07 14:47:25,339] test_current @iteration 0: 1.3279842681794274, test_best: 1.3279842681794274
[INFO: 2020-09-07 14:49:05,523] ######## Epoch (VAL)16 ########
[INFO: 2020-09-07 14:49:05,523] {'CIDEr': 1.313595584623335}
[INFO: 2020-09-07 14:50:07,227] test_current @iteration 16: 1.3250632988924045, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 14:50:07,227] mv_approxkl: 0.00032849044281894787
[INFO: 2020-09-07 14:50:07,227] beta: 1.0
[INFO: 2020-09-07 14:51:12,847] x: 1.7379497634522525, y: 1.7465203874036348 @iteration 16
[INFO: 2020-09-07 14:52:53,180] ######## Epoch (VAL)32 ########
[INFO: 2020-09-07 14:52:53,181] {'CIDEr': 1.3117048520354306}
[INFO: 2020-09-07 14:53:54,606] test_current @iteration 32: 1.3269592668174561, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 14:53:54,606] mv_approxkl: 0.0003617980212083007
[INFO: 2020-09-07 14:53:54,606] beta: 1.0
[INFO: 2020-09-07 14:54:58,633] x: 1.7441341265243506, y: 1.744395165288778 @iteration 32
[INFO: 2020-09-07 14:56:38,329] ######## Epoch (VAL)48 ########
[INFO: 2020-09-07 14:56:38,329] {'CIDEr': 1.3117450085267781}
[INFO: 2020-09-07 14:57:40,583] test_current @iteration 48: 1.3276205631503697, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 14:57:40,584] mv_approxkl: 0.000796673870150565
[INFO: 2020-09-07 14:57:40,584] beta: 1.0
[INFO: 2020-09-07 14:58:44,752] x: 1.720163549728689, y: 1.7295138532842702 @iteration 48
[INFO: 2020-09-07 15:00:24,114] ######## Epoch (VAL)64 ########
[INFO: 2020-09-07 15:00:24,114] {'CIDEr': 1.312270684721045}
[INFO: 2020-09-07 15:01:25,140] test_current @iteration 64: 1.3266991252340417, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 15:01:25,140] mv_approxkl: 0.0011095060102488986
[INFO: 2020-09-07 15:01:25,140] beta: 1.0
[INFO: 2020-09-07 15:02:31,320] x: 1.7175921804079821, y: 1.709283138360273 @iteration 64
[INFO: 2020-09-07 15:02:31,320] update predictor @iteration 64
[INFO: 2020-09-07 15:04:12,047] ######## Epoch (VAL)80 ########
[INFO: 2020-09-07 15:04:12,047] {'CIDEr': 1.3120927676339709}
[INFO: 2020-09-07 15:05:13,515] test_current @iteration 80: 1.3248209044223211, test_predictor: 1.3266991252340417
[INFO: 2020-09-07 15:05:13,515] mv_approxkl: 0.00025477842595805143
[INFO: 2020-09-07 15:05:13,515] beta: 1.0
[INFO: 2020-09-07 15:23:52,015] Training with config:
[INFO: 2020-09-07 15:23:52,017] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 36,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:28:08,131] Training with config:
[INFO: 2020-09-07 15:28:08,133] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:29:23,719] Training with config:
[INFO: 2020-09-07 15:29:23,721] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:31:52,461] Training with config:
[INFO: 2020-09-07 15:31:52,463] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:34:09,142] Training with config:
[INFO: 2020-09-07 15:34:09,143] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:34:19,468] Training with config:
[INFO: 2020-09-07 15:34:19,470] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:35:10,387] Training with config:
[INFO: 2020-09-07 15:35:10,389] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:36:56,123] Training with config:
[INFO: 2020-09-07 15:36:56,125] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:40:56,222] Training with config:
[INFO: 2020-09-07 15:40:56,224] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 4,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:42:36,975] Training with config:
[INFO: 2020-09-07 15:42:36,977] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 4,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 15:45:46,809] iteration 32
[INFO: 2020-09-07 15:46:47,014] ######## Iteration (TEST) 32 ########
[INFO: 2020-09-07 15:46:47,014] {'CIDEr': 1.3264484775959955}
[INFO: 2020-09-07 15:49:44,023] iteration 64
[INFO: 2020-09-07 15:50:43,081] ######## Iteration (TEST) 64 ########
[INFO: 2020-09-07 15:50:43,081] {'CIDEr': 1.3261327416603443}
[INFO: 2020-09-07 15:53:42,022] iteration 96
[INFO: 2020-09-07 15:54:42,524] ######## Iteration (TEST) 96 ########
[INFO: 2020-09-07 15:54:42,524] {'CIDEr': 1.3243618026209882}
[INFO: 2020-09-07 15:57:45,029] iteration 128
[INFO: 2020-09-07 15:58:46,852] ######## Iteration (TEST) 128 ########
[INFO: 2020-09-07 15:58:46,852] {'CIDEr': 1.3280009616301027}
[INFO: 2020-09-07 16:01:48,755] iteration 160
[INFO: 2020-09-07 16:02:49,470] ######## Iteration (TEST) 160 ########
[INFO: 2020-09-07 16:02:49,471] {'CIDEr': 1.3272329307127992}
[INFO: 2020-09-07 16:05:54,031] iteration 192
[INFO: 2020-09-07 16:06:54,745] ######## Iteration (TEST) 192 ########
[INFO: 2020-09-07 16:06:54,745] {'CIDEr': 1.3273841363557117}
[INFO: 2020-09-07 16:09:54,483] iteration 224
[INFO: 2020-09-07 16:10:54,498] ######## Iteration (TEST) 224 ########
[INFO: 2020-09-07 16:10:54,498] {'CIDEr': 1.3260592925123582}
[INFO: 2020-09-07 16:13:56,414] iteration 256
[INFO: 2020-09-07 16:14:58,193] ######## Iteration (TEST) 256 ########
[INFO: 2020-09-07 16:14:58,193] {'CIDEr': 1.3246432355832574}
[INFO: 2020-09-07 16:18:00,140] iteration 288
[INFO: 2020-09-07 16:19:01,902] ######## Iteration (TEST) 288 ########
[INFO: 2020-09-07 16:19:01,902] {'CIDEr': 1.3243412065129692}
[INFO: 2020-09-07 16:22:04,503] iteration 320
[INFO: 2020-09-07 16:23:05,074] ######## Iteration (TEST) 320 ########
[INFO: 2020-09-07 16:23:05,074] {'CIDEr': 1.3230777020471824}
[INFO: 2020-09-07 16:26:07,381] iteration 352
[INFO: 2020-09-07 16:27:09,255] ######## Iteration (TEST) 352 ########
[INFO: 2020-09-07 16:27:09,256] {'CIDEr': 1.324642614200772}
[INFO: 2020-09-07 16:30:13,084] iteration 384
[INFO: 2020-09-07 16:31:14,769] ######## Iteration (TEST) 384 ########
[INFO: 2020-09-07 16:31:14,769] {'CIDEr': 1.3265528801901838}
[INFO: 2020-09-07 16:34:14,136] iteration 416
[INFO: 2020-09-07 16:35:14,288] ######## Iteration (TEST) 416 ########
[INFO: 2020-09-07 16:35:14,289] {'CIDEr': 1.3255288602617539}
[INFO: 2020-09-07 16:38:11,870] iteration 448
[INFO: 2020-09-07 16:39:12,977] ######## Iteration (TEST) 448 ########
[INFO: 2020-09-07 16:39:12,977] {'CIDEr': 1.327492348019167}
[INFO: 2020-09-07 16:42:17,090] iteration 480
[INFO: 2020-09-07 16:43:18,108] ######## Iteration (TEST) 480 ########
[INFO: 2020-09-07 16:43:18,109] {'CIDEr': 1.32501856688034}
[INFO: 2020-09-07 16:46:19,101] iteration 512
[INFO: 2020-09-07 16:47:20,843] ######## Iteration (TEST) 512 ########
[INFO: 2020-09-07 16:47:20,843] {'CIDEr': 1.3258178668650555}
[INFO: 2020-09-07 16:50:24,362] iteration 544
[INFO: 2020-09-07 16:51:25,867] ######## Iteration (TEST) 544 ########
[INFO: 2020-09-07 16:51:25,867] {'CIDEr': 1.3265145282536044}
[INFO: 2020-09-07 16:54:29,688] iteration 576
[INFO: 2020-09-07 16:55:30,110] ######## Iteration (TEST) 576 ########
[INFO: 2020-09-07 16:55:30,110] {'CIDEr': 1.325294085516368}
[INFO: 2020-09-07 16:58:28,257] iteration 608
[INFO: 2020-09-07 16:59:28,944] ######## Iteration (TEST) 608 ########
[INFO: 2020-09-07 16:59:28,944] {'CIDEr': 1.3258769438287121}
[INFO: 2020-09-07 20:16:04,880] Training with config:
[INFO: 2020-09-07 20:16:04,882] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 20:17:21,733] val_current @iteration 0: 1.3279842681794274, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:22:26,076] val_current @iteration 100: 1.3251925934736264, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:27:26,118] val_current @iteration 200: 1.3250039131125184, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:32:28,015] val_current @iteration 300: 1.3286029800815606, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:37:30,017] val_current @iteration 400: 1.3287128129637962, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:42:32,713] val_current @iteration 500: 1.3275783723381869, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:47:35,479] val_current @iteration 600: 1.3229569134670442, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:52:38,900] val_current @iteration 700: 1.3255716019705497, val_best: 1.3279842681794274
[INFO: 2020-09-07 20:57:40,813] val_current @iteration 800: 1.326310283079173, val_best: 1.3279842681794274
[INFO: 2020-09-07 21:02:42,599] val_current @iteration 900: 1.3263101948118026, val_best: 1.3279842681794274
[INFO: 2020-09-07 21:03:14,093] Training with config:
[INFO: 2020-09-07 21:03:14,095] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 21:04:34,841] Training with config:
[INFO: 2020-09-07 21:04:34,843] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 21:05:51,526] ######## Epoch (VAL) 0 ########
[INFO: 2020-09-07 21:05:51,527] {'CIDEr': 1.3134830622722575}
[INFO: 2020-09-07 21:06:52,626] test_current @iteration 0: 1.3279842681794274, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 21:08:42,292] Training with config:
[INFO: 2020-09-07 21:08:42,294] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 21:09:59,707] ######## Epoch (VAL) 0 ########
[INFO: 2020-09-07 21:09:59,708] {'CIDEr': 1.3134830622722575}
[INFO: 2020-09-07 21:11:00,287] test_current @iteration 0: 1.3279842681794274, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 21:13:08,527] Training with config:
[INFO: 2020-09-07 21:13:08,529] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 21:14:25,465] ######## Epoch (VAL) 0 ########
[INFO: 2020-09-07 21:14:25,465] {'CIDEr': 1.3134830622722575}
[INFO: 2020-09-07 21:15:25,936] test_current @iteration 0: 1.3279842681794274, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 21:16:21,493] Training with config:
[INFO: 2020-09-07 21:16:21,495] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 21:17:38,214] ######## Epoch (VAL) 0 ########
[INFO: 2020-09-07 21:17:38,214] {'CIDEr': 1.3134830622722575}
[INFO: 2020-09-07 21:18:38,635] test_current @iteration 0: 1.3279842681794274, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 21:20:25,641] Training with config:
[INFO: 2020-09-07 21:20:25,643] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 21:21:42,654] ######## Epoch (VAL) 0 ########
[INFO: 2020-09-07 21:21:42,655] {'CIDEr': 1.3134830622722575}
[INFO: 2020-09-07 21:22:44,526] test_current @iteration 0: 1.3279842681794274, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 21:23:08,953] Training with config:
[INFO: 2020-09-07 21:23:08,955] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 21:24:25,507] ######## Epoch (VAL) 0 ########
[INFO: 2020-09-07 21:24:25,507] {'CIDEr': 1.3134830622722575}
[INFO: 2020-09-07 21:25:25,659] test_current @iteration 0: 1.3279842681794274, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 21:27:10,259] ######## Epoch (VAL) 16 ########
[INFO: 2020-09-07 21:27:10,259] {'CIDEr': 1.314271186047396}
[INFO: 2020-09-07 21:28:11,671] test_current @iteration 16: 1.3264320428500633, test_predictor: 1.3279842681794274
[INFO: 2020-09-07 21:28:11,672] mv_approxkl: 0.062374112749829666
[INFO: 2020-09-07 21:28:11,672] beta: 32.0
[INFO: 2020-09-07 21:28:11,672] mv_viloate: 3.4122198862380007
[INFO: 2020-09-07 21:29:18,049] x: 1.7467221736423568, y: 1.7457205426978575 @iteration 16
[INFO: 2020-09-07 21:29:18,049] update predictor @iteration 16
[INFO: 2020-09-07 21:31:03,315] ######## Epoch (VAL) 32 ########
[INFO: 2020-09-07 21:31:03,315] {'CIDEr': 1.3144597078074307}
[INFO: 2020-09-07 21:32:04,921] test_current @iteration 32: 1.3258657551170376, test_predictor: 1.3264320428500633
[INFO: 2020-09-07 21:32:04,921] mv_approxkl: 0.07530855880585546
[INFO: 2020-09-07 21:32:04,921] beta: 4.0
[INFO: 2020-09-07 21:32:04,921] mv_viloate: 3.1218366322090754
[INFO: 2020-09-07 21:33:08,806] x: 1.751768392712143, y: 1.733820244311807 @iteration 32
[INFO: 2020-09-07 21:33:08,807] update predictor @iteration 32
[INFO: 2020-09-07 21:34:52,864] ######## Epoch (VAL) 48 ########
[INFO: 2020-09-07 21:34:52,864] {'CIDEr': 1.3143227189985927}
[INFO: 2020-09-07 21:35:55,034] test_current @iteration 48: 1.325426675020907, test_predictor: 1.3258657551170376
[INFO: 2020-09-07 21:35:55,035] mv_approxkl: 0.0147618783798939
[INFO: 2020-09-07 21:35:55,035] beta: 0.5
[INFO: 2020-09-07 21:35:55,035] mv_viloate: 1
[INFO: 2020-09-07 21:36:59,933] x: 1.7299113953084662, y: 1.7301129821247003 @iteration 48
[INFO: 2020-09-07 21:38:43,951] ######## Epoch (VAL) 64 ########
[INFO: 2020-09-07 21:38:43,952] {'CIDEr': 1.3138383734229464}
[INFO: 2020-09-07 21:39:45,730] test_current @iteration 64: 1.3258303167648813, test_predictor: 1.3258657551170376
[INFO: 2020-09-07 21:39:45,730] mv_approxkl: 0.009859232702127923
[INFO: 2020-09-07 21:39:45,730] beta: 0.5
[INFO: 2020-09-07 21:39:45,730] mv_viloate: 1
[INFO: 2020-09-07 21:40:50,566] x: 1.7152625841416544, y: 1.7185278172181222 @iteration 64
[INFO: 2020-09-07 21:42:34,784] ######## Epoch (VAL) 80 ########
[INFO: 2020-09-07 21:42:34,784] {'CIDEr': 1.3142778355470215}
[INFO: 2020-09-07 21:43:36,175] test_current @iteration 80: 1.3251140052218155, test_predictor: 1.3258657551170376
[INFO: 2020-09-07 21:43:36,175] mv_approxkl: 0.004552160618943071
[INFO: 2020-09-07 21:43:36,175] beta: 0.5
[INFO: 2020-09-07 21:43:36,175] mv_viloate: 1.1
[INFO: 2020-09-07 21:44:39,564] x: 1.747054197653269, y: 1.7477553711113865 @iteration 80
[INFO: 2020-09-07 21:46:23,048] ######## Epoch (VAL) 96 ########
[INFO: 2020-09-07 21:46:23,048] {'CIDEr': 1.3141070551305192}
[INFO: 2020-09-07 21:47:24,968] test_current @iteration 96: 1.3251691647033792, test_predictor: 1.3258657551170376
[INFO: 2020-09-07 21:47:24,969] mv_approxkl: 0.004071030374055442
[INFO: 2020-09-07 21:47:24,969] beta: 0.5
[INFO: 2020-09-07 21:47:24,969] mv_viloate: 1
[INFO: 2020-09-07 21:48:30,329] x: 1.734486733194089, y: 1.7296880352526398 @iteration 96
[INFO: 2020-09-07 21:48:30,330] update predictor @iteration 96
[INFO: 2020-09-07 21:50:14,838] ######## Epoch (VAL) 112 ########
[INFO: 2020-09-07 21:50:14,838] {'CIDEr': 1.3138042626617723}
[INFO: 2020-09-07 21:51:16,545] test_current @iteration 112: 1.324921461126273, test_predictor: 1.3251691647033792
[INFO: 2020-09-07 21:51:16,545] mv_approxkl: 0.0007543701472553798
[INFO: 2020-09-07 21:51:16,545] beta: 0.5
[INFO: 2020-09-07 21:51:16,545] mv_viloate: 1
[INFO: 2020-09-07 21:52:21,128] x: 1.7347753284820602, y: 1.7350711465792272 @iteration 112
[INFO: 2020-09-07 21:54:05,533] ######## Epoch (VAL) 128 ########
[INFO: 2020-09-07 21:54:05,533] {'CIDEr': 1.3139875450720344}
[INFO: 2020-09-07 21:55:07,509] test_current @iteration 128: 1.3248492595903034, test_predictor: 1.3251691647033792
[INFO: 2020-09-07 21:55:07,509] mv_approxkl: 0.0001397863112731356
[INFO: 2020-09-07 21:55:07,509] beta: 0.5
[INFO: 2020-09-07 21:55:07,509] mv_viloate: 1
[INFO: 2020-09-07 21:56:13,519] x: 1.7414116713563477, y: 1.7402528190072006 @iteration 128
[INFO: 2020-09-07 21:56:13,520] update predictor @iteration 128
[INFO: 2020-09-07 21:57:56,508] ######## Epoch (VAL) 144 ########
[INFO: 2020-09-07 21:57:56,508] {'CIDEr': 1.3133899081328189}
[INFO: 2020-09-07 21:58:56,483] test_current @iteration 144: 1.3259909846520521, test_predictor: 1.3248492595903034
[INFO: 2020-09-07 21:58:56,483] mv_approxkl: 2.5902685691424807e-05
[INFO: 2020-09-07 21:58:56,483] beta: 0.5
[INFO: 2020-09-07 21:58:56,483] mv_viloate: 1
[INFO: 2020-09-07 22:00:00,254] x: 1.7248190887105954, y: 1.7239359629950253 @iteration 144
[INFO: 2020-09-07 22:01:43,804] ######## Epoch (VAL) 160 ########
[INFO: 2020-09-07 22:01:43,805] {'CIDEr': 1.3133414530622343}
[INFO: 2020-09-07 22:02:44,110] test_current @iteration 160: 1.3272117798699077, test_predictor: 1.3248492595903034
[INFO: 2020-09-07 22:02:44,110] mv_approxkl: 4.7998199531693905e-06
[INFO: 2020-09-07 22:02:44,110] beta: 0.5
[INFO: 2020-09-07 22:02:44,110] mv_viloate: 1
[INFO: 2020-09-07 22:03:46,504] x: 1.7297711230073407, y: 1.7356529643860688 @iteration 160
[INFO: 2020-09-07 22:05:28,156] ######## Epoch (VAL) 176 ########
[INFO: 2020-09-07 22:05:28,156] {'CIDEr': 1.3144902843244337}
[INFO: 2020-09-07 22:06:29,503] test_current @iteration 176: 1.3267413131701742, test_predictor: 1.3248492595903034
[INFO: 2020-09-07 22:06:29,503] mv_approxkl: 0.00022173137945541075
[INFO: 2020-09-07 22:06:29,503] beta: 0.5
[INFO: 2020-09-07 22:06:29,503] mv_viloate: 1
[INFO: 2020-09-07 22:07:32,617] x: 1.753740285120334, y: 1.7521451619348012 @iteration 176
[INFO: 2020-09-07 22:07:32,617] update predictor @iteration 176
[INFO: 2020-09-07 22:09:15,190] ######## Epoch (VAL) 192 ########
[INFO: 2020-09-07 22:09:15,190] {'CIDEr': 1.3126048759332973}
[INFO: 2020-09-07 22:10:14,921] test_current @iteration 192: 1.327893691269621, test_predictor: 1.3267413131701742
[INFO: 2020-09-07 22:10:14,921] mv_approxkl: 4.108727226328447e-05
[INFO: 2020-09-07 22:10:14,922] beta: 0.5
[INFO: 2020-09-07 22:10:14,922] mv_viloate: 1
[INFO: 2020-09-07 22:11:17,880] x: 1.728389942206167, y: 1.7271523299923688 @iteration 192
[INFO: 2020-09-07 22:11:17,880] update predictor @iteration 192
[INFO: 2020-09-07 22:13:01,244] ######## Epoch (VAL) 208 ########
[INFO: 2020-09-07 22:13:01,244] {'CIDEr': 1.3125118119670733}
[INFO: 2020-09-07 22:14:01,084] test_current @iteration 208: 1.3276006617750495, test_predictor: 1.327893691269621
[INFO: 2020-09-07 22:14:01,084] mv_approxkl: 7.613554500871841e-06
[INFO: 2020-09-07 22:14:01,084] beta: 0.5
[INFO: 2020-09-07 22:14:01,084] mv_viloate: 1
[INFO: 2020-09-07 22:15:03,802] x: 1.7398049589154732, y: 1.734407680693374 @iteration 208
[INFO: 2020-09-07 22:15:03,802] update predictor @iteration 208
[INFO: 2020-09-07 22:16:45,683] ######## Epoch (VAL) 224 ########
[INFO: 2020-09-07 22:16:45,683] {'CIDEr': 1.3131855356156783}
[INFO: 2020-09-07 22:17:46,005] test_current @iteration 224: 1.3272552844264358, test_predictor: 1.3276006617750495
[INFO: 2020-09-07 22:17:46,005] mv_approxkl: 1.4108070199039329e-06
[INFO: 2020-09-07 22:17:46,005] beta: 0.5
[INFO: 2020-09-07 22:17:46,006] mv_viloate: 1
[INFO: 2020-09-07 22:18:48,913] x: 1.759446207113403, y: 1.7672800871521321 @iteration 224
[INFO: 2020-09-07 22:20:32,240] ######## Epoch (VAL) 240 ########
[INFO: 2020-09-07 22:20:32,240] {'CIDEr': 1.3138733867484609}
[INFO: 2020-09-07 22:21:32,087] test_current @iteration 240: 1.3268122110815175, test_predictor: 1.3276006617750495
[INFO: 2020-09-07 22:21:32,087] mv_approxkl: 2.6142538904558894e-07
[INFO: 2020-09-07 22:21:32,087] beta: 0.5
[INFO: 2020-09-07 22:21:32,087] mv_viloate: 1
[INFO: 2020-09-07 22:22:34,962] x: 1.7172637394388761, y: 1.7132321025106476 @iteration 240
[INFO: 2020-09-07 22:22:34,962] update predictor @iteration 240
[INFO: 2020-09-07 22:24:16,888] ######## Epoch (VAL) 256 ########
[INFO: 2020-09-07 22:24:16,888] {'CIDEr': 1.313835777301569}
[INFO: 2020-09-07 22:25:17,957] test_current @iteration 256: 1.3261636832801527, test_predictor: 1.3268122110815175
[INFO: 2020-09-07 22:25:17,957] mv_approxkl: 4.8442652377992344e-08
[INFO: 2020-09-07 22:25:17,957] beta: 0.5
[INFO: 2020-09-07 22:25:17,957] mv_viloate: 1
[INFO: 2020-09-07 22:26:20,709] x: 1.7193700118864377, y: 1.7169859849087237 @iteration 256
[INFO: 2020-09-07 22:26:20,710] update predictor @iteration 256
[INFO: 2020-09-07 22:28:02,906] ######## Epoch (VAL) 272 ########
[INFO: 2020-09-07 22:28:02,906] {'CIDEr': 1.314708918119985}
[INFO: 2020-09-07 22:29:03,220] test_current @iteration 272: 1.3263011179003013, test_predictor: 1.3261636832801527
[INFO: 2020-09-07 22:29:03,220] mv_approxkl: 8.976521285795148e-09
[INFO: 2020-09-07 22:29:03,220] beta: 0.5
[INFO: 2020-09-07 22:29:03,220] mv_viloate: 1
[INFO: 2020-09-07 22:30:06,286] x: 1.7323825952214849, y: 1.7226041808092543 @iteration 272
[INFO: 2020-09-07 22:30:06,287] update predictor @iteration 272
[INFO: 2020-09-07 22:31:49,814] ######## Epoch (VAL) 288 ########
[INFO: 2020-09-07 22:31:49,814] {'CIDEr': 1.3146843491830136}
[INFO: 2020-09-07 22:32:49,758] test_current @iteration 288: 1.326397924836702, test_predictor: 1.3263011179003013
[INFO: 2020-09-07 22:32:49,758] mv_approxkl: 1.66336751682367e-09
[INFO: 2020-09-07 22:32:49,758] beta: 0.5
[INFO: 2020-09-07 22:32:49,758] mv_viloate: 1
[INFO: 2020-09-07 22:33:23,788] Training with config:
[INFO: 2020-09-07 22:33:23,790] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-07 22:34:39,984] ######## Epoch (VAL) 0 ########
[INFO: 2020-09-07 22:34:39,985] {'CIDEr': 1.178461593282439}
[INFO: 2020-09-07 22:35:40,017] test_current @iteration 0: 1.1996348289986822, test_predictor: 1.1996348289986822
[INFO: 2020-09-07 22:37:27,607] ######## Epoch (VAL) 16 ########
[INFO: 2020-09-07 22:37:27,607] {'CIDEr': 1.177851811813739}
[INFO: 2020-09-07 22:38:28,784] test_current @iteration 16: 1.1953808839224145, test_predictor: 1.1996348289986822
[INFO: 2020-09-07 22:38:28,784] mv_approxkl: 0.0011364049278199673
[INFO: 2020-09-07 22:38:28,784] beta: 0.5
[INFO: 2020-09-07 22:38:28,784] mv_viloate: 1.1
[INFO: 2020-09-07 22:39:42,624] x: 0.6753768296651708, y: 0.6408726436783537 @iteration 16
[INFO: 2020-09-07 22:39:42,625] update predictor @iteration 16
[INFO: 2020-09-07 22:41:30,505] ######## Epoch (VAL) 32 ########
[INFO: 2020-09-07 22:41:30,505] {'CIDEr': 1.1795267455402993}
[INFO: 2020-09-07 22:42:30,673] test_current @iteration 32: 1.1984655130712472, test_predictor: 1.1953808839224145
[INFO: 2020-09-07 22:42:30,673] mv_approxkl: 0.0007733004040386582
[INFO: 2020-09-07 22:42:30,673] beta: 0.5
[INFO: 2020-09-07 22:42:30,673] mv_viloate: 1
[INFO: 2020-09-07 22:43:42,890] x: 0.6721616205636315, y: 0.6565194130191512 @iteration 32
[INFO: 2020-09-07 22:43:42,890] update predictor @iteration 32
[INFO: 2020-09-07 22:45:28,276] ######## Epoch (VAL) 48 ########
[INFO: 2020-09-07 22:45:28,277] {'CIDEr': 1.181305404051079}
[INFO: 2020-09-07 22:46:29,683] test_current @iteration 48: 1.202353724283089, test_predictor: 1.1984655130712472
[INFO: 2020-09-07 22:46:29,683] mv_approxkl: 0.0003873397298012002
[INFO: 2020-09-07 22:46:29,683] beta: 0.5
[INFO: 2020-09-07 22:46:29,683] mv_viloate: 1
[INFO: 2020-09-07 22:47:42,353] x: 0.6900183079323772, y: 0.6779023713725055 @iteration 48
[INFO: 2020-09-07 22:47:42,354] update predictor @iteration 48
[INFO: 2020-09-07 22:49:28,193] ######## Epoch (VAL) 64 ########
[INFO: 2020-09-07 22:49:28,194] {'CIDEr': 1.1837682423170188}
[INFO: 2020-09-07 22:50:28,927] test_current @iteration 64: 1.2003691556907088, test_predictor: 1.202353724283089
[INFO: 2020-09-07 22:50:28,927] mv_approxkl: 7.177483392660413e-05
[INFO: 2020-09-07 22:50:28,927] beta: 0.5
[INFO: 2020-09-07 22:50:28,927] mv_viloate: 1
[INFO: 2020-09-07 22:51:41,436] x: 0.697596316853305, y: 0.6877231417136707 @iteration 64
[INFO: 2020-09-07 22:51:41,436] update predictor @iteration 64
[INFO: 2020-09-07 22:53:28,404] ######## Epoch (VAL) 80 ########
[INFO: 2020-09-07 22:53:28,404] {'CIDEr': 1.184119567098734}
[INFO: 2020-09-07 22:54:28,754] test_current @iteration 80: 1.199950721623989, test_predictor: 1.2003691556907088
[INFO: 2020-09-07 22:54:28,754] mv_approxkl: 1.3300021631748553e-05
[INFO: 2020-09-07 22:54:28,754] beta: 0.5
[INFO: 2020-09-07 22:54:28,754] mv_viloate: 1
[INFO: 2020-09-07 22:55:41,909] x: 0.724653378299343, y: 0.6938098832961523 @iteration 80
[INFO: 2020-09-07 22:55:41,909] update predictor @iteration 80
[INFO: 2020-09-07 22:57:28,108] ######## Epoch (VAL) 96 ########
[INFO: 2020-09-07 22:57:28,108] {'CIDEr': 1.1857641785711581}
[INFO: 2020-09-07 22:58:30,128] test_current @iteration 96: 1.201451730801646, test_predictor: 1.199950721623989
[INFO: 2020-09-07 22:58:30,128] mv_approxkl: 2.4645208595796283e-06
[INFO: 2020-09-07 22:58:30,128] beta: 0.5
[INFO: 2020-09-07 22:58:30,128] mv_viloate: 1
[INFO: 2020-09-07 22:59:41,584] x: 0.7316183893335553, y: 0.7295793916453881 @iteration 96
[INFO: 2020-09-07 22:59:41,585] update predictor @iteration 96
[INFO: 2020-09-07 23:01:27,223] ######## Epoch (VAL) 112 ########
[INFO: 2020-09-07 23:01:27,223] {'CIDEr': 1.1863205930918586}
[INFO: 2020-09-07 23:02:27,183] test_current @iteration 112: 1.2037126090242705, test_predictor: 1.201451730801646
[INFO: 2020-09-07 23:02:27,183] mv_approxkl: 4.566806908647549e-07
[INFO: 2020-09-07 23:02:27,183] beta: 0.5
[INFO: 2020-09-07 23:02:27,184] mv_viloate: 1
[INFO: 2020-09-07 23:03:38,453] x: 0.7619610108466381, y: 0.7619762490201585 @iteration 112
[INFO: 2020-09-07 23:05:25,386] ######## Epoch (VAL) 128 ########
[INFO: 2020-09-07 23:05:25,386] {'CIDEr': 1.1846292253898174}
[INFO: 2020-09-07 23:06:25,621] test_current @iteration 128: 1.2016458022678103, test_predictor: 1.201451730801646
[INFO: 2020-09-07 23:06:25,621] mv_approxkl: 0.0009516574375504211
[INFO: 2020-09-07 23:06:25,621] beta: 0.5
[INFO: 2020-09-07 23:06:25,621] mv_viloate: 1
[INFO: 2020-09-07 23:07:37,769] x: 0.7836132068406323, y: 0.7399302286952192 @iteration 128
[INFO: 2020-09-07 23:07:37,769] update predictor @iteration 128
[INFO: 2020-09-07 23:09:24,067] ######## Epoch (VAL) 144 ########
[INFO: 2020-09-07 23:09:24,067] {'CIDEr': 1.1837768292145971}
[INFO: 2020-09-07 23:10:24,073] test_current @iteration 144: 1.2024836840650326, test_predictor: 1.2016458022678103
[INFO: 2020-09-07 23:10:24,074] mv_approxkl: 0.0001763440444651941
[INFO: 2020-09-07 23:10:24,074] beta: 0.5
[INFO: 2020-09-07 23:10:24,074] mv_viloate: 1
[INFO: 2020-09-07 23:11:37,124] x: 0.7701533084882886, y: 0.779818293087969 @iteration 144
[INFO: 2020-09-07 23:13:23,136] ######## Epoch (VAL) 160 ########
[INFO: 2020-09-07 23:13:23,137] {'CIDEr': 1.1873683883537383}
[INFO: 2020-09-07 23:14:23,296] test_current @iteration 160: 1.2041788962991515, test_predictor: 1.2016458022678103
[INFO: 2020-09-07 23:14:23,297] mv_approxkl: 0.0008077564850695386
[INFO: 2020-09-07 23:14:23,297] beta: 0.5
[INFO: 2020-09-07 23:14:23,297] mv_viloate: 1
[INFO: 2020-09-07 23:15:34,368] x: 0.790314101224026, y: 0.7621975779232286 @iteration 160
[INFO: 2020-09-07 23:15:34,368] update predictor @iteration 160
[INFO: 2020-09-07 23:17:21,172] ######## Epoch (VAL) 176 ########
[INFO: 2020-09-07 23:17:21,173] {'CIDEr': 1.1867271513296518}
[INFO: 2020-09-07 23:18:21,206] test_current @iteration 176: 1.2042157531721138, test_predictor: 1.2041788962991515
[INFO: 2020-09-07 23:18:21,206] mv_approxkl: 0.00014967890745098562
[INFO: 2020-09-07 23:18:21,206] beta: 0.5
[INFO: 2020-09-07 23:18:21,206] mv_viloate: 1
[INFO: 2020-09-07 23:19:32,722] x: 0.8075106418193261, y: 0.802705763621916 @iteration 176
[INFO: 2020-09-07 23:19:32,722] update predictor @iteration 176
[INFO: 2020-09-07 23:21:18,792] ######## Epoch (VAL) 192 ########
[INFO: 2020-09-07 23:21:18,793] {'CIDEr': 1.190721297210607}
[INFO: 2020-09-07 23:22:19,036] test_current @iteration 192: 1.207114795667297, test_predictor: 1.2042157531721138
[INFO: 2020-09-07 23:22:19,036] mv_approxkl: 2.7735803735196268e-05
[INFO: 2020-09-07 23:22:19,036] beta: 0.5
[INFO: 2020-09-07 23:22:19,036] mv_viloate: 1
[INFO: 2020-09-07 23:23:30,203] x: 0.8084136730015727, y: 0.7938640066014616 @iteration 192
[INFO: 2020-09-07 23:23:30,203] update predictor @iteration 192
[INFO: 2020-09-07 23:25:16,783] ######## Epoch (VAL) 208 ########
[INFO: 2020-09-07 23:25:16,783] {'CIDEr': 1.1908851726582326}
[INFO: 2020-09-07 23:26:17,106] test_current @iteration 208: 1.209229269768763, test_predictor: 1.207114795667297
[INFO: 2020-09-07 23:26:17,106] mv_approxkl: 5.139500427535101e-06
[INFO: 2020-09-07 23:26:17,106] beta: 0.5
[INFO: 2020-09-07 23:26:17,106] mv_viloate: 1
[INFO: 2020-09-07 23:27:28,014] x: 0.8379233216061802, y: 0.8105040880009474 @iteration 208
[INFO: 2020-09-07 23:27:28,014] update predictor @iteration 208
[INFO: 2020-09-07 23:29:14,163] ######## Epoch (VAL) 224 ########
[INFO: 2020-09-07 23:29:14,163] {'CIDEr': 1.1914518084954553}
[INFO: 2020-09-07 23:30:15,952] test_current @iteration 224: 1.2089621702377895, test_predictor: 1.209229269768763
[INFO: 2020-09-07 23:30:15,952] mv_approxkl: 9.523598052835213e-07
[INFO: 2020-09-07 23:30:15,952] beta: 0.5
[INFO: 2020-09-07 23:30:15,952] mv_viloate: 1
[INFO: 2020-09-07 23:31:27,331] x: 0.8425756066306178, y: 0.8354202233258553 @iteration 224
[INFO: 2020-09-07 23:31:27,331] update predictor @iteration 224
[INFO: 2020-09-07 23:33:13,344] ######## Epoch (VAL) 240 ########
[INFO: 2020-09-07 23:33:13,344] {'CIDEr': 1.1944538737037005}
[INFO: 2020-09-07 23:34:13,321] test_current @iteration 240: 1.2107026606997227, test_predictor: 1.2089621702377895
[INFO: 2020-09-07 23:34:13,321] mv_approxkl: 1.764741946241374e-07
[INFO: 2020-09-07 23:34:13,321] beta: 0.5
[INFO: 2020-09-07 23:34:13,321] mv_viloate: 1
[INFO: 2020-09-07 23:35:23,303] x: 0.8476384840541941, y: 0.8144143013701427 @iteration 240
[INFO: 2020-09-07 23:35:23,303] update predictor @iteration 240
[INFO: 2020-09-07 23:37:09,965] ######## Epoch (VAL) 256 ########
[INFO: 2020-09-07 23:37:09,965] {'CIDEr': 1.1980465515715193}
[INFO: 2020-09-07 23:38:09,941] test_current @iteration 256: 1.2146487334444134, test_predictor: 1.2107026606997227
[INFO: 2020-09-07 23:38:09,941] mv_approxkl: 3.270102454498957e-08
[INFO: 2020-09-07 23:38:09,941] beta: 0.5
[INFO: 2020-09-07 23:38:09,941] mv_viloate: 1
[INFO: 2020-09-07 23:39:19,837] x: 0.8502667745962895, y: 0.8399999860061982 @iteration 256
[INFO: 2020-09-07 23:39:19,838] update predictor @iteration 256
[INFO: 2020-09-07 23:41:05,521] ######## Epoch (VAL) 272 ########
[INFO: 2020-09-07 23:41:05,521] {'CIDEr': 1.2011476676732775}
[INFO: 2020-09-07 23:42:06,590] test_current @iteration 272: 1.2146899122917416, test_predictor: 1.2146487334444134
[INFO: 2020-09-07 23:42:06,590] mv_approxkl: 6.0595658678005305e-09
[INFO: 2020-09-07 23:42:06,590] beta: 0.5
[INFO: 2020-09-07 23:42:06,590] mv_viloate: 1
[INFO: 2020-09-07 23:43:15,693] x: 0.8725182193158829, y: 0.8567440513487067 @iteration 272
[INFO: 2020-09-07 23:43:15,693] update predictor @iteration 272
[INFO: 2020-09-07 23:45:00,996] ######## Epoch (VAL) 288 ########
[INFO: 2020-09-07 23:45:00,996] {'CIDEr': 1.2042512746193819}
[INFO: 2020-09-07 23:46:01,549] test_current @iteration 288: 1.2195527451307189, test_predictor: 1.2146899122917416
[INFO: 2020-09-07 23:46:01,549] mv_approxkl: 1.122849788871191e-09
[INFO: 2020-09-07 23:46:01,549] beta: 0.5
[INFO: 2020-09-07 23:46:01,550] mv_viloate: 1
[INFO: 2020-09-07 23:47:12,287] x: 0.8676289950846328, y: 0.8491625257103282 @iteration 288
[INFO: 2020-09-07 23:47:12,287] update predictor @iteration 288
[INFO: 2020-09-07 23:48:59,504] ######## Epoch (VAL) 304 ########
[INFO: 2020-09-07 23:48:59,504] {'CIDEr': 1.2033078177868144}
[INFO: 2020-09-07 23:49:59,649] test_current @iteration 304: 1.2227870435935573, test_predictor: 1.2195527451307189
[INFO: 2020-09-07 23:49:59,650] mv_approxkl: 2.0806633278263447e-10
[INFO: 2020-09-07 23:49:59,650] beta: 0.5
[INFO: 2020-09-07 23:49:59,650] mv_viloate: 1
[INFO: 2020-09-07 23:51:09,979] x: 0.8822594493803346, y: 0.8768003854007312 @iteration 304
[INFO: 2020-09-07 23:51:09,979] update predictor @iteration 304
[INFO: 2020-09-07 23:52:55,118] ######## Epoch (VAL) 320 ########
[INFO: 2020-09-07 23:52:55,118] {'CIDEr': 1.2057129798898385}
[INFO: 2020-09-07 23:53:55,694] test_current @iteration 320: 1.225324442537164, test_predictor: 1.2227870435935573
[INFO: 2020-09-07 23:53:55,694] mv_approxkl: 3.855511152665874e-11
[INFO: 2020-09-07 23:53:55,694] beta: 0.5
[INFO: 2020-09-07 23:53:55,694] mv_viloate: 1
[INFO: 2020-09-07 23:55:05,055] x: 0.9219253285958249, y: 0.9155366625653835 @iteration 320
[INFO: 2020-09-07 23:55:05,055] update predictor @iteration 320
[INFO: 2020-09-07 23:56:51,536] ######## Epoch (VAL) 336 ########
[INFO: 2020-09-07 23:56:51,536] {'CIDEr': 1.2068810537310741}
[INFO: 2020-09-07 23:57:51,558] test_current @iteration 336: 1.2230085166614515, test_predictor: 1.225324442537164
[INFO: 2020-09-07 23:57:51,558] mv_approxkl: 7.144340004233299e-12
[INFO: 2020-09-07 23:57:51,558] beta: 0.5
[INFO: 2020-09-07 23:57:51,558] mv_viloate: 1
[INFO: 2020-09-07 23:59:00,128] x: 0.91866676947125, y: 0.9084828205799694 @iteration 336
[INFO: 2020-09-07 23:59:00,128] update predictor @iteration 336
[INFO: 2020-09-08 00:00:46,450] ######## Epoch (VAL) 352 ########
[INFO: 2020-09-08 00:00:46,451] {'CIDEr': 1.2094025299256375}
[INFO: 2020-09-08 00:01:46,472] test_current @iteration 352: 1.2223447904979674, test_predictor: 1.2230085166614515
[INFO: 2020-09-08 00:01:46,472] mv_approxkl: 1.3238606263866154e-12
[INFO: 2020-09-08 00:01:46,472] beta: 0.5
[INFO: 2020-09-08 00:01:46,472] mv_viloate: 1
[INFO: 2020-09-08 00:02:56,210] x: 0.9021469864777913, y: 0.9000200363306995 @iteration 352
[INFO: 2020-09-08 00:02:56,211] update predictor @iteration 352
[INFO: 2020-09-08 00:04:41,694] ######## Epoch (VAL) 368 ########
[INFO: 2020-09-08 00:04:41,694] {'CIDEr': 1.2093808109090443}
[INFO: 2020-09-08 00:05:42,165] test_current @iteration 368: 1.224675428558555, test_predictor: 1.2223447904979674
[INFO: 2020-09-08 00:05:42,165] mv_approxkl: 2.4531404679204445e-13
[INFO: 2020-09-08 00:05:42,165] beta: 0.5
[INFO: 2020-09-08 00:05:42,165] mv_viloate: 1
[INFO: 2020-09-08 00:06:51,521] x: 0.9419824476740796, y: 0.9220135708800443 @iteration 368
[INFO: 2020-09-08 00:06:51,521] update predictor @iteration 368
[INFO: 2020-09-08 00:08:37,528] ######## Epoch (VAL) 384 ########
[INFO: 2020-09-08 00:08:37,529] {'CIDEr': 1.2117589921376934}
[INFO: 2020-09-08 00:09:37,877] test_current @iteration 384: 1.2281530661385704, test_predictor: 1.224675428558555
[INFO: 2020-09-08 00:09:37,878] mv_approxkl: 4.545718813146038e-14
[INFO: 2020-09-08 00:09:37,878] beta: 0.5
[INFO: 2020-09-08 00:09:37,878] mv_viloate: 1
[INFO: 2020-09-08 00:10:46,560] x: 0.9330132365096945, y: 0.8909198747019369 @iteration 384
[INFO: 2020-09-08 00:10:46,560] update predictor @iteration 384
[INFO: 2020-09-08 00:12:31,547] ######## Epoch (VAL) 400 ########
[INFO: 2020-09-08 00:12:31,548] {'CIDEr': 1.2122471387289697}
[INFO: 2020-09-08 00:13:32,543] test_current @iteration 400: 1.2280551793831536, test_predictor: 1.2281530661385704
[INFO: 2020-09-08 00:13:32,544] mv_approxkl: 8.423308733603242e-15
[INFO: 2020-09-08 00:13:32,544] beta: 0.5
[INFO: 2020-09-08 00:13:32,544] mv_viloate: 1
[INFO: 2020-09-08 00:14:41,996] x: 0.9523897512403326, y: 0.9357902322121577 @iteration 400
[INFO: 2020-09-08 00:14:41,997] update predictor @iteration 400
[INFO: 2020-09-08 00:16:27,718] ######## Epoch (VAL) 416 ########
[INFO: 2020-09-08 00:16:27,718] {'CIDEr': 1.2144969015581941}
[INFO: 2020-09-08 00:17:27,786] test_current @iteration 416: 1.2300199604665891, test_predictor: 1.2280551793831536
[INFO: 2020-09-08 00:17:27,787] mv_approxkl: 1.5608561140298845e-15
[INFO: 2020-09-08 00:17:27,787] beta: 0.5
[INFO: 2020-09-08 00:17:27,787] mv_viloate: 1
[INFO: 2020-09-08 00:18:36,629] x: 0.9639306597226011, y: 0.9454172938152999 @iteration 416
[INFO: 2020-09-08 00:18:36,629] update predictor @iteration 416
[INFO: 2020-09-08 00:20:23,247] ######## Epoch (VAL) 432 ########
[INFO: 2020-09-08 00:20:23,248] {'CIDEr': 1.2120217352245435}
[INFO: 2020-09-08 00:21:23,833] test_current @iteration 432: 1.2324924059467723, test_predictor: 1.2300199604665891
[INFO: 2020-09-08 00:21:23,833] mv_approxkl: 0.00012629918754129723
[INFO: 2020-09-08 00:21:23,833] beta: 0.5
[INFO: 2020-09-08 00:21:23,833] mv_viloate: 1
[INFO: 2020-09-08 00:22:32,886] x: 0.9781543337564199, y: 0.9704013589554785 @iteration 432
[INFO: 2020-09-08 00:22:32,887] update predictor @iteration 432
[INFO: 2020-09-08 00:24:18,801] ######## Epoch (VAL) 448 ########
[INFO: 2020-09-08 00:24:18,802] {'CIDEr': 1.2087822132897945}
[INFO: 2020-09-08 00:25:19,856] test_current @iteration 448: 1.2301665616984598, test_predictor: 1.2324924059467723
[INFO: 2020-09-08 00:25:19,856] mv_approxkl: 2.340349443496088e-05
[INFO: 2020-09-08 00:25:19,856] beta: 0.5
[INFO: 2020-09-08 00:25:19,856] mv_viloate: 1
[INFO: 2020-09-08 00:26:27,868] x: 0.9850609880191565, y: 0.980566515796553 @iteration 448
[INFO: 2020-09-08 00:26:27,868] update predictor @iteration 448
[INFO: 2020-09-08 00:28:13,542] ######## Epoch (VAL) 464 ########
[INFO: 2020-09-08 00:28:13,542] {'CIDEr': 1.210327479430657}
[INFO: 2020-09-08 00:29:14,096] test_current @iteration 464: 1.2304533770150095, test_predictor: 1.2301665616984598
[INFO: 2020-09-08 00:29:14,096] mv_approxkl: 4.3367147677664244e-06
[INFO: 2020-09-08 00:29:14,096] beta: 0.5
[INFO: 2020-09-08 00:29:14,096] mv_viloate: 1
[INFO: 2020-09-08 00:30:23,066] x: 0.9880281857294483, y: 0.9891202736565201 @iteration 464
[INFO: 2020-09-08 00:32:09,470] ######## Epoch (VAL) 480 ########
[INFO: 2020-09-08 00:32:09,471] {'CIDEr': 1.208752699194073}
[INFO: 2020-09-08 00:33:09,450] test_current @iteration 480: 1.2309467443902762, test_predictor: 1.2301665616984598
[INFO: 2020-09-08 00:33:09,451] mv_approxkl: 8.036020017963111e-07
[INFO: 2020-09-08 00:33:09,451] beta: 0.5
[INFO: 2020-09-08 00:33:09,451] mv_viloate: 1
[INFO: 2020-09-08 00:34:17,257] x: 0.9941883364520194, y: 0.9820197074066667 @iteration 480
[INFO: 2020-09-08 00:34:17,257] update predictor @iteration 480
[INFO: 2020-09-08 00:36:02,492] ######## Epoch (VAL) 496 ########
[INFO: 2020-09-08 00:36:02,492] {'CIDEr': 1.2098687225004274}
[INFO: 2020-09-08 00:37:04,095] test_current @iteration 496: 1.231500263065719, test_predictor: 1.2309467443902762
[INFO: 2020-09-08 00:37:04,095] mv_approxkl: 1.4890907331303183e-07
[INFO: 2020-09-08 00:37:04,095] beta: 0.5
[INFO: 2020-09-08 00:37:04,095] mv_viloate: 1
[INFO: 2020-09-08 00:38:12,876] x: 1.000939322053102, y: 0.9819574284036702 @iteration 496
[INFO: 2020-09-08 00:38:12,877] update predictor @iteration 496
[INFO: 2020-09-08 00:39:58,120] ######## Epoch (VAL) 512 ########
[INFO: 2020-09-08 00:39:58,120] {'CIDEr': 1.2107031213272685}
[INFO: 2020-09-08 00:40:58,182] test_current @iteration 512: 1.2315509371102171, test_predictor: 1.231500263065719
[INFO: 2020-09-08 00:40:58,182] mv_approxkl: 2.7593151915226693e-08
[INFO: 2020-09-08 00:40:58,182] beta: 0.5
[INFO: 2020-09-08 00:40:58,182] mv_viloate: 1
[INFO: 2020-09-08 00:42:05,985] x: 1.0161158758186064, y: 0.9988259068745237 @iteration 512
[INFO: 2020-09-08 00:42:05,985] update predictor @iteration 512
[INFO: 2020-09-08 00:43:52,601] ######## Epoch (VAL) 528 ########
[INFO: 2020-09-08 00:43:52,601] {'CIDEr': 1.2130639275885402}
[INFO: 2020-09-08 00:44:52,780] test_current @iteration 528: 1.2317025675606772, test_predictor: 1.2315509371102171
[INFO: 2020-09-08 00:44:52,780] mv_approxkl: 5.113066757297091e-09
[INFO: 2020-09-08 00:44:52,780] beta: 0.5
[INFO: 2020-09-08 00:44:52,780] mv_viloate: 1
[INFO: 2020-09-08 00:46:00,711] x: 1.0111197015117517, y: 1.0147588576398139 @iteration 528
[INFO: 2020-09-08 00:47:46,312] ######## Epoch (VAL) 544 ########
[INFO: 2020-09-08 00:47:46,312] {'CIDEr': 1.2134957949191398}
[INFO: 2020-09-08 00:48:47,596] test_current @iteration 544: 1.233067848572492, test_predictor: 1.2315509371102171
[INFO: 2020-09-08 00:48:47,596] mv_approxkl: 0.001467254231340623
[INFO: 2020-09-08 00:48:47,596] beta: 0.5
[INFO: 2020-09-08 00:48:47,596] mv_viloate: 1.0
[INFO: 2020-09-08 00:49:55,752] x: 1.0214415443774185, y: 1.0111669787951185 @iteration 544
[INFO: 2020-09-08 00:49:55,752] update predictor @iteration 544
[INFO: 2020-09-08 00:51:40,743] ######## Epoch (VAL) 560 ########
[INFO: 2020-09-08 00:51:40,744] {'CIDEr': 1.214693145786463}
[INFO: 2020-09-08 00:52:41,156] test_current @iteration 560: 1.2341312839581506, test_predictor: 1.233067848572492
[INFO: 2020-09-08 00:52:41,156] mv_approxkl: 0.0012064582554012285
[INFO: 2020-09-08 00:52:41,156] beta: 0.5
[INFO: 2020-09-08 00:52:41,156] mv_viloate: 1
[INFO: 2020-09-08 00:53:48,786] x: 1.0251102413475017, y: 1.030981632359878 @iteration 560
[INFO: 2020-09-08 00:55:34,403] ######## Epoch (VAL) 576 ########
[INFO: 2020-09-08 00:55:34,403] {'CIDEr': 1.2172713314695895}
[INFO: 2020-09-08 00:56:35,522] test_current @iteration 576: 1.2306700953508782, test_predictor: 1.233067848572492
[INFO: 2020-09-08 00:56:35,522] mv_approxkl: 0.017723943580318625
[INFO: 2020-09-08 00:56:35,522] beta: 1.0
[INFO: 2020-09-08 00:56:35,522] mv_viloate: 1.9314095430000002
[INFO: 2020-09-08 00:57:44,239] x: 1.0440653888694968, y: 1.023182743219345 @iteration 576
[INFO: 2020-09-08 00:57:44,239] update predictor @iteration 576
[INFO: 2020-09-08 00:59:29,875] ######## Epoch (VAL) 592 ########
[INFO: 2020-09-08 00:59:29,875] {'CIDEr': 1.216413203349906}
[INFO: 2020-09-08 01:00:30,304] test_current @iteration 592: 1.2291502910358323, test_predictor: 1.2306700953508782
[INFO: 2020-09-08 01:00:30,305] mv_approxkl: 0.017199904958103834
[INFO: 2020-09-08 01:00:30,305] beta: 0.5
[INFO: 2020-09-08 01:00:30,305] mv_viloate: 1.4481156600000002
[INFO: 2020-09-08 01:01:37,656] x: 1.0375769691685914, y: 1.049757604238797 @iteration 592
[INFO: 2020-09-08 01:03:23,704] ######## Epoch (VAL) 608 ########
[INFO: 2020-09-08 01:03:23,704] {'CIDEr': 1.2166248369303045}
[INFO: 2020-09-08 01:04:23,974] test_current @iteration 608: 1.229209780240422, test_predictor: 1.2306700953508782
[INFO: 2020-09-08 01:04:23,974] mv_approxkl: 0.02371724451890584
[INFO: 2020-09-08 01:04:23,975] beta: 0.5
[INFO: 2020-09-08 01:04:23,975] mv_viloate: 3.058250484787233
[INFO: 2020-09-08 01:05:32,375] x: 1.0310718629222633, y: 1.0551878697877999 @iteration 608
[INFO: 2020-09-08 01:07:17,807] ######## Epoch (VAL) 624 ########
[INFO: 2020-09-08 01:07:17,807] {'CIDEr': 1.2178041508338966}
[INFO: 2020-09-08 01:08:19,080] test_current @iteration 624: 1.232392262001679, test_predictor: 1.2306700953508782
[INFO: 2020-09-08 01:08:19,080] mv_approxkl: 0.02074642516317874
[INFO: 2020-09-08 01:08:19,080] beta: 0.5
[INFO: 2020-09-08 01:08:19,080] mv_viloate: 4.448245990371257
[INFO: 2020-09-08 01:09:26,714] x: 1.0587273945708902, y: 1.02426566652219 @iteration 624
[INFO: 2020-09-08 01:09:26,714] update predictor @iteration 624
[INFO: 2020-09-08 01:11:11,366] ######## Epoch (VAL) 640 ########
[INFO: 2020-09-08 01:11:11,366] {'CIDEr': 1.2165405607861048}
[INFO: 2020-09-08 01:12:11,395] test_current @iteration 640: 1.2332413008974508, test_predictor: 1.232392262001679
[INFO: 2020-09-08 01:12:11,396] mv_approxkl: 0.005259528350704446
[INFO: 2020-09-08 01:12:11,396] beta: 0.5
[INFO: 2020-09-08 01:12:11,396] mv_viloate: 1
[INFO: 2020-09-08 01:13:19,044] x: 1.0397012132663768, y: 1.0478372065668402 @iteration 640
[INFO: 2020-09-08 01:15:04,954] ######## Epoch (VAL) 656 ########
[INFO: 2020-09-08 01:15:04,954] {'CIDEr': 1.2149167607055984}
[INFO: 2020-09-08 01:16:05,069] test_current @iteration 656: 1.2342174674408763, test_predictor: 1.232392262001679
[INFO: 2020-09-08 01:16:05,069] mv_approxkl: 0.006969448142841608
[INFO: 2020-09-08 01:16:05,069] beta: 0.5
[INFO: 2020-09-08 01:16:05,069] mv_viloate: 1
[INFO: 2020-09-08 01:17:13,378] x: 1.0740294159714927, y: 1.0796761791525418 @iteration 656
[INFO: 2020-09-08 01:18:58,346] ######## Epoch (VAL) 672 ########
[INFO: 2020-09-08 01:18:58,346] {'CIDEr': 1.2176626171352773}
[INFO: 2020-09-08 01:19:59,946] test_current @iteration 672: 1.2331271315978098, test_predictor: 1.232392262001679
[INFO: 2020-09-08 01:19:59,946] mv_approxkl: 0.011019596942949132
[INFO: 2020-09-08 01:19:59,947] beta: 0.5
[INFO: 2020-09-08 01:19:59,947] mv_viloate: 1.4617000000000004
[INFO: 2020-09-08 01:21:07,529] x: 1.0558196029724156, y: 1.0295254187799148 @iteration 672
[INFO: 2020-09-08 01:21:07,529] update predictor @iteration 672
[INFO: 2020-09-08 01:22:52,765] ######## Epoch (VAL) 688 ########
[INFO: 2020-09-08 01:22:52,766] {'CIDEr': 1.2197297305191304}
[INFO: 2020-09-08 01:23:53,100] test_current @iteration 688: 1.2312441278572615, test_predictor: 1.2331271315978098
[INFO: 2020-09-08 01:23:53,101] mv_approxkl: 0.004955243733064312
[INFO: 2020-09-08 01:23:53,101] beta: 0.5
[INFO: 2020-09-08 01:23:53,101] mv_viloate: 1
[INFO: 2020-09-08 01:25:01,624] x: 1.070171363469199, y: 1.0588414098971797 @iteration 688
[INFO: 2020-09-08 01:25:01,625] update predictor @iteration 688
[INFO: 2020-09-08 01:26:46,594] ######## Epoch (VAL) 704 ########
[INFO: 2020-09-08 01:26:46,594] {'CIDEr': 1.2181716001072425}
[INFO: 2020-09-08 01:27:48,004] test_current @iteration 704: 1.2314329530634764, test_predictor: 1.2312441278572615
[INFO: 2020-09-08 01:27:48,004] mv_approxkl: 0.013476644100385828
[INFO: 2020-09-08 01:27:48,004] beta: 0.5
[INFO: 2020-09-08 01:27:48,004] mv_viloate: 1.0
[INFO: 2020-09-08 01:28:56,126] x: 1.0769848890168006, y: 1.06572652936438 @iteration 704
[INFO: 2020-09-08 01:28:56,126] update predictor @iteration 704
[INFO: 2020-09-08 01:30:40,970] ######## Epoch (VAL) 720 ########
[INFO: 2020-09-08 01:30:40,971] {'CIDEr': 1.219113728414215}
[INFO: 2020-09-08 01:31:41,418] test_current @iteration 720: 1.2326317130869908, test_predictor: 1.2314329530634764
[INFO: 2020-09-08 01:31:41,418] mv_approxkl: 0.004985281182227873
[INFO: 2020-09-08 01:31:41,418] beta: 0.5
[INFO: 2020-09-08 01:31:41,418] mv_viloate: 1
[INFO: 2020-09-08 01:32:49,464] x: 1.06359511443726, y: 1.06401443687069 @iteration 720
[INFO: 2020-09-08 01:34:35,199] ######## Epoch (VAL) 736 ########
[INFO: 2020-09-08 01:34:35,199] {'CIDEr': 1.2173937479735095}
[INFO: 2020-09-08 01:35:35,821] test_current @iteration 736: 1.231194333300332, test_predictor: 1.2314329530634764
[INFO: 2020-09-08 01:35:35,821] mv_approxkl: 0.021015312302132626
[INFO: 2020-09-08 01:35:35,821] beta: 1.0
[INFO: 2020-09-08 01:35:35,821] mv_viloate: 1.4020428835190002
[INFO: 2020-09-08 01:36:42,732] x: 1.0788036474038603, y: 1.079787004782308 @iteration 736
[INFO: 2020-09-08 01:38:27,671] ######## Epoch (VAL) 752 ########
[INFO: 2020-09-08 01:38:27,672] {'CIDEr': 1.2159623549807643}
[INFO: 2020-09-08 01:39:29,128] test_current @iteration 752: 1.2328944313434484, test_predictor: 1.2314329530634764
[INFO: 2020-09-08 01:39:29,128] mv_approxkl: 0.020026991475967395
[INFO: 2020-09-08 01:39:29,128] beta: 0.5
[INFO: 2020-09-08 01:39:29,128] mv_viloate: 1.5067770822446531
[INFO: 2020-09-08 01:40:37,064] x: 1.064126660097368, y: 1.0764049831070381 @iteration 752
[INFO: 2020-09-08 01:42:22,155] ######## Epoch (VAL) 768 ########
[INFO: 2020-09-08 01:42:22,156] {'CIDEr': 1.2151061763205173}
[INFO: 2020-09-08 01:43:22,347] test_current @iteration 768: 1.2354334296737606, test_predictor: 1.2314329530634764
[INFO: 2020-09-08 01:43:22,347] mv_approxkl: 0.03613709338091945
[INFO: 2020-09-08 01:43:22,347] beta: 4.0
[INFO: 2020-09-08 01:43:22,347] mv_viloate: 2.895645291981947
[INFO: 2020-09-08 01:44:30,068] x: 1.0484057725230214, y: 1.056825967526332 @iteration 768
[INFO: 2020-09-08 01:46:15,760] ######## Epoch (VAL) 784 ########
[INFO: 2020-09-08 01:46:15,761] {'CIDEr': 1.2152626115356673}
[INFO: 2020-09-08 01:47:15,695] test_current @iteration 784: 1.2329184569738216, test_predictor: 1.2314329530634764
[INFO: 2020-09-08 01:47:15,695] mv_approxkl: 0.0440912918642377
[INFO: 2020-09-08 01:47:15,695] beta: 4.0
[INFO: 2020-09-08 01:47:15,695] mv_viloate: 7.868100117533261
[INFO: 2020-09-08 01:48:23,964] x: 1.075830737150044, y: 1.0719995782970113 @iteration 784
[INFO: 2020-09-08 01:48:23,964] update predictor @iteration 784
[INFO: 2020-09-08 01:50:09,512] ######## Epoch (VAL) 800 ########
[INFO: 2020-09-08 01:50:09,512] {'CIDEr': 1.2173345551612158}
[INFO: 2020-09-08 01:51:11,549] test_current @iteration 800: 1.2341218545432373, test_predictor: 1.2329184569738216
[INFO: 2020-09-08 01:51:11,550] mv_approxkl: 0.008344415953359625
[INFO: 2020-09-08 01:51:11,550] beta: 0.5
[INFO: 2020-09-08 01:51:11,550] mv_viloate: 1.5549658961786683
[INFO: 2020-09-08 01:52:19,625] x: 1.0725457296387846, y: 1.0707881518092746 @iteration 800
[INFO: 2020-09-08 01:52:19,625] update predictor @iteration 800
[INFO: 2020-09-08 01:54:04,312] ######## Epoch (VAL) 816 ########
[INFO: 2020-09-08 01:54:04,312] {'CIDEr': 1.2180539297523423}
[INFO: 2020-09-08 01:55:04,499] test_current @iteration 816: 1.2332796050667645, test_predictor: 1.2341218545432373
[INFO: 2020-09-08 01:55:04,500] mv_approxkl: 0.0015462371225752774
[INFO: 2020-09-08 01:55:04,500] beta: 0.5
[INFO: 2020-09-08 01:55:04,500] mv_viloate: 1
[INFO: 2020-09-08 01:56:12,173] x: 1.0885637947862403, y: 1.0679865470772534 @iteration 816
[INFO: 2020-09-08 01:56:12,173] update predictor @iteration 816
[INFO: 2020-09-08 01:57:58,773] ######## Epoch (VAL) 832 ########
[INFO: 2020-09-08 01:57:58,773] {'CIDEr': 1.2177621398081209}
[INFO: 2020-09-08 01:58:59,054] test_current @iteration 832: 1.2335488365858007, test_predictor: 1.2332796050667645
[INFO: 2020-09-08 01:58:59,055] mv_approxkl: 0.00028652086048841686
[INFO: 2020-09-08 01:58:59,055] beta: 0.5
[INFO: 2020-09-08 01:58:59,055] mv_viloate: 1
[INFO: 2020-09-08 02:00:06,956] x: 1.0592906985226884, y: 1.0652372074769767 @iteration 832
[INFO: 2020-09-08 02:01:52,126] ######## Epoch (VAL) 848 ########
[INFO: 2020-09-08 02:01:52,126] {'CIDEr': 1.2166759896622126}
[INFO: 2020-09-08 02:02:52,246] test_current @iteration 848: 1.2339710240945863, test_predictor: 1.2332796050667645
[INFO: 2020-09-08 02:02:52,246] mv_approxkl: 5.309289390122384e-05
[INFO: 2020-09-08 02:02:52,246] beta: 0.5
[INFO: 2020-09-08 02:02:52,246] mv_viloate: 1
[INFO: 2020-09-08 02:04:01,699] x: 1.0779508265617048, y: 1.0827049284688925 @iteration 848
[INFO: 2020-09-08 02:05:47,687] ######## Epoch (VAL) 864 ########
[INFO: 2020-09-08 02:05:47,688] {'CIDEr': 1.2171214702712405}
[INFO: 2020-09-08 02:06:47,883] test_current @iteration 864: 1.232892128112973, test_predictor: 1.2332796050667645
[INFO: 2020-09-08 02:06:47,883] mv_approxkl: 9.83822042835366e-06
[INFO: 2020-09-08 02:06:47,883] beta: 0.5
[INFO: 2020-09-08 02:06:47,883] mv_viloate: 1
[INFO: 2020-09-08 02:07:55,367] x: 1.0977479661293479, y: 1.0923462824659058 @iteration 864
[INFO: 2020-09-08 02:07:55,367] update predictor @iteration 864
[INFO: 2020-09-08 02:09:39,808] ######## Epoch (VAL) 880 ########
[INFO: 2020-09-08 02:09:39,809] {'CIDEr': 1.2183634401527565}
[INFO: 2020-09-08 02:10:41,048] test_current @iteration 880: 1.2346093985433897, test_predictor: 1.232892128112973
[INFO: 2020-09-08 02:10:41,048] mv_approxkl: 1.8230421076113946e-06
[INFO: 2020-09-08 02:10:41,048] beta: 0.5
[INFO: 2020-09-08 02:10:41,048] mv_viloate: 1
[INFO: 2020-09-08 02:11:49,326] x: 1.0802059105878976, y: 1.08175846860604 @iteration 880
[INFO: 2020-09-08 02:13:34,229] ######## Epoch (VAL) 896 ########
[INFO: 2020-09-08 02:13:34,229] {'CIDEr': 1.2174176035902324}
[INFO: 2020-09-08 02:14:34,744] test_current @iteration 896: 1.2361151455280237, test_predictor: 1.232892128112973
[INFO: 2020-09-08 02:14:34,744] mv_approxkl: 3.378133830530926e-07
[INFO: 2020-09-08 02:14:34,744] beta: 0.5
[INFO: 2020-09-08 02:14:34,744] mv_viloate: 1
[INFO: 2020-09-08 02:15:42,224] x: 1.0973765936149298, y: 1.093571736474547 @iteration 896
[INFO: 2020-09-08 02:15:42,225] update predictor @iteration 896
[INFO: 2020-09-08 02:17:27,903] ######## Epoch (VAL) 912 ########
[INFO: 2020-09-08 02:17:27,903] {'CIDEr': 1.2183899851983102}
[INFO: 2020-09-08 02:18:28,378] test_current @iteration 912: 1.235992484087746, test_predictor: 1.2361151455280237
[INFO: 2020-09-08 02:18:28,379] mv_approxkl: 6.259750188617213e-08
[INFO: 2020-09-08 02:18:28,379] beta: 0.5
[INFO: 2020-09-08 02:18:28,379] mv_viloate: 1
[INFO: 2020-09-08 02:19:35,714] x: 1.0852440161790442, y: 1.1011231650592552 @iteration 912
[INFO: 2020-09-08 02:21:20,662] ######## Epoch (VAL) 928 ########
[INFO: 2020-09-08 02:21:20,662] {'CIDEr': 1.2190806449414684}
[INFO: 2020-09-08 02:22:22,077] test_current @iteration 928: 1.2341023357415088, test_predictor: 1.2361151455280237
[INFO: 2020-09-08 02:22:22,077] mv_approxkl: 1.1599443476676821e-08
[INFO: 2020-09-08 02:22:22,077] beta: 0.5
[INFO: 2020-09-08 02:22:22,077] mv_viloate: 1
[INFO: 2020-09-08 02:23:29,752] x: 1.0712421329017392, y: 1.0832197882400891 @iteration 928
[INFO: 2020-09-08 02:25:14,550] ######## Epoch (VAL) 944 ########
[INFO: 2020-09-08 02:25:14,551] {'CIDEr': 1.2202744380970387}
[INFO: 2020-09-08 02:26:14,575] test_current @iteration 944: 1.2346984665563907, test_predictor: 1.2361151455280237
[INFO: 2020-09-08 02:26:14,576] mv_approxkl: 2.1494002941727944e-09
[INFO: 2020-09-08 02:26:14,576] beta: 0.5
[INFO: 2020-09-08 02:26:14,576] mv_viloate: 1
[INFO: 2020-09-08 02:27:22,354] x: 1.1107379835449689, y: 1.1005579874803046 @iteration 944
[INFO: 2020-09-08 02:27:22,354] update predictor @iteration 944
[INFO: 2020-09-08 02:29:08,414] ######## Epoch (VAL) 960 ########
[INFO: 2020-09-08 02:29:08,415] {'CIDEr': 1.2198554081120663}
[INFO: 2020-09-08 02:30:08,662] test_current @iteration 960: 1.2333929739418659, test_predictor: 1.2346984665563907
[INFO: 2020-09-08 02:30:08,663] mv_approxkl: 3.982882139026277e-10
[INFO: 2020-09-08 02:30:08,663] beta: 0.5
[INFO: 2020-09-08 02:30:08,663] mv_viloate: 1
[INFO: 2020-09-08 02:31:15,990] x: 1.1203629104507655, y: 1.1097386030155818 @iteration 960
[INFO: 2020-09-08 02:31:15,990] update predictor @iteration 960
[INFO: 2020-09-08 02:33:01,165] ######## Epoch (VAL) 976 ########
[INFO: 2020-09-08 02:33:01,165] {'CIDEr': 1.2219478200777618}
[INFO: 2020-09-08 02:34:01,345] test_current @iteration 976: 1.2338377147014994, test_predictor: 1.2333929739418659
[INFO: 2020-09-08 02:34:01,345] mv_approxkl: 7.380361013433097e-11
[INFO: 2020-09-08 02:34:01,345] beta: 0.5
[INFO: 2020-09-08 02:34:01,345] mv_viloate: 1
[INFO: 2020-09-08 02:35:08,764] x: 1.1107543367624453, y: 1.1045885283089687 @iteration 976
[INFO: 2020-09-08 02:35:08,764] update predictor @iteration 976
[INFO: 2020-09-08 02:36:54,872] ######## Epoch (VAL) 992 ########
[INFO: 2020-09-08 02:36:54,873] {'CIDEr': 1.2231169178666517}
[INFO: 2020-09-08 02:37:55,460] test_current @iteration 992: 1.2345988224786026, test_predictor: 1.2338377147014994
[INFO: 2020-09-08 02:37:55,460] mv_approxkl: 1.3675957958906571e-11
[INFO: 2020-09-08 02:37:55,460] beta: 0.5
[INFO: 2020-09-08 02:37:55,460] mv_viloate: 1
[INFO: 2020-09-08 02:39:02,551] x: 1.1205420924489269, y: 1.0873271466176981 @iteration 992
[INFO: 2020-09-08 02:39:02,551] update predictor @iteration 992
[INFO: 2020-09-08 02:40:47,320] ######## Epoch (VAL) 1008 ########
[INFO: 2020-09-08 02:40:47,320] {'CIDEr': 1.2223569926241036}
[INFO: 2020-09-08 02:41:49,140] test_current @iteration 1008: 1.234175909693888, test_predictor: 1.2345988224786026
[INFO: 2020-09-08 02:41:49,141] mv_approxkl: 2.534182619974291e-12
[INFO: 2020-09-08 02:41:49,141] beta: 0.5
[INFO: 2020-09-08 02:41:49,141] mv_viloate: 1
[INFO: 2020-09-08 02:42:56,473] x: 1.1000463530735223, y: 1.1174231160194639 @iteration 1008
[INFO: 2020-09-08 02:44:41,201] ######## Epoch (VAL) 1024 ########
[INFO: 2020-09-08 02:44:41,201] {'CIDEr': 1.22306517377054}
[INFO: 2020-09-08 02:45:41,177] test_current @iteration 1024: 1.2345130325219473, test_predictor: 1.2345988224786026
[INFO: 2020-09-08 02:45:41,177] mv_approxkl: 4.695891557049817e-13
[INFO: 2020-09-08 02:45:41,177] beta: 0.5
[INFO: 2020-09-08 02:45:41,177] mv_viloate: 1
[INFO: 2020-09-08 02:46:47,762] x: 1.120032162904459, y: 1.126041267456952 @iteration 1024
[INFO: 2020-09-08 02:48:33,551] ######## Epoch (VAL) 1040 ########
[INFO: 2020-09-08 02:48:33,552] {'CIDEr': 1.2234581976847014}
[INFO: 2020-09-08 02:49:33,485] test_current @iteration 1040: 1.2345080367926533, test_predictor: 1.2345988224786026
[INFO: 2020-09-08 02:49:33,486] mv_approxkl: 8.70158185987222e-14
[INFO: 2020-09-08 02:49:33,486] beta: 0.5
[INFO: 2020-09-08 02:49:33,486] mv_viloate: 1
[INFO: 2020-09-08 02:50:40,320] x: 1.0881812464566585, y: 1.0850075641762071 @iteration 1040
[INFO: 2020-09-08 02:50:40,320] update predictor @iteration 1040
[INFO: 2020-09-08 02:52:24,780] ######## Epoch (VAL) 1056 ########
[INFO: 2020-09-08 02:52:24,780] {'CIDEr': 1.2249426047317964}
[INFO: 2020-09-08 02:53:26,185] test_current @iteration 1056: 1.2342171155033899, test_predictor: 1.2345080367926533
[INFO: 2020-09-08 02:53:26,185] mv_approxkl: 1.6124206861290184e-14
[INFO: 2020-09-08 02:53:26,185] beta: 0.5
[INFO: 2020-09-08 02:53:26,185] mv_viloate: 1
[INFO: 2020-09-08 02:54:33,314] x: 1.1340813511011703, y: 1.1331477205769573 @iteration 1056
[INFO: 2020-09-08 02:56:18,258] ######## Epoch (VAL) 1072 ########
[INFO: 2020-09-08 02:56:18,259] {'CIDEr': 1.2239742574443333}
[INFO: 2020-09-08 02:57:18,582] test_current @iteration 1072: 1.235009883292885, test_predictor: 1.2345080367926533
[INFO: 2020-09-08 02:57:18,582] mv_approxkl: 2.987848084319409e-15
[INFO: 2020-09-08 02:57:18,582] beta: 0.5
[INFO: 2020-09-08 02:57:18,582] mv_viloate: 1
[INFO: 2020-09-08 02:58:26,375] x: 1.1262427681180347, y: 1.1475523343710206 @iteration 1072
[INFO: 2020-09-08 03:00:12,615] ######## Epoch (VAL) 1088 ########
[INFO: 2020-09-08 03:00:12,615] {'CIDEr': 1.2238081501891673}
[INFO: 2020-09-08 03:01:13,334] test_current @iteration 1088: 1.2365694217109104, test_predictor: 1.2345080367926533
[INFO: 2020-09-08 03:01:13,334] mv_approxkl: 5.536542821466166e-16
[INFO: 2020-09-08 03:01:13,334] beta: 0.5
[INFO: 2020-09-08 03:01:13,335] mv_viloate: 1
[INFO: 2020-09-08 03:02:21,305] x: 1.1265665754068026, y: 1.1065334920984327 @iteration 1088
[INFO: 2020-09-08 03:02:21,305] update predictor @iteration 1088
[INFO: 2020-09-08 03:04:06,504] ######## Epoch (VAL) 1104 ########
[INFO: 2020-09-08 03:04:06,504] {'CIDEr': 1.2238398261295629}
[INFO: 2020-09-08 03:05:07,391] test_current @iteration 1104: 1.2362946240204826, test_predictor: 1.2365694217109104
[INFO: 2020-09-08 03:05:07,391] mv_approxkl: 1.0259325624619548e-16
[INFO: 2020-09-08 03:05:07,391] beta: 0.5
[INFO: 2020-09-08 03:05:07,391] mv_viloate: 1
[INFO: 2020-09-08 03:06:14,216] x: 1.152794876353755, y: 1.1444051555791268 @iteration 1104
[INFO: 2020-09-08 03:06:14,217] update predictor @iteration 1104
[INFO: 2020-09-08 03:07:59,939] ######## Epoch (VAL) 1120 ########
[INFO: 2020-09-08 03:07:59,939] {'CIDEr': 1.2249949458854763}
[INFO: 2020-09-08 03:09:00,233] test_current @iteration 1120: 1.2359351753712475, test_predictor: 1.2362946240204826
[INFO: 2020-09-08 03:09:00,233] mv_approxkl: 1.9010737506425056e-17
[INFO: 2020-09-08 03:09:00,234] beta: 0.5
[INFO: 2020-09-08 03:09:00,234] mv_viloate: 1
[INFO: 2020-09-08 03:10:08,767] x: 1.1144373322394272, y: 1.1015804724544813 @iteration 1120
[INFO: 2020-09-08 03:10:08,767] update predictor @iteration 1120
[INFO: 2020-09-08 03:11:55,176] ######## Epoch (VAL) 1136 ########
[INFO: 2020-09-08 03:11:55,176] {'CIDEr': 1.2244955114207947}
[INFO: 2020-09-08 03:12:55,535] test_current @iteration 1136: 1.2360201821371941, test_predictor: 1.2359351753712475
[INFO: 2020-09-08 03:12:55,535] mv_approxkl: 3.522728040436854e-18
[INFO: 2020-09-08 03:12:55,535] beta: 0.5
[INFO: 2020-09-08 03:12:55,535] mv_viloate: 1
[INFO: 2020-09-08 03:14:04,270] x: 1.1306863784870973, y: 1.1141090436379948 @iteration 1136
[INFO: 2020-09-08 03:14:04,271] update predictor @iteration 1136
[INFO: 2020-09-08 03:15:49,724] ######## Epoch (VAL) 1152 ########
[INFO: 2020-09-08 03:15:49,724] {'CIDEr': 1.223988122733723}
[INFO: 2020-09-08 03:16:50,085] test_current @iteration 1152: 1.236916516875633, test_predictor: 1.2360201821371941
[INFO: 2020-09-08 03:16:50,085] mv_approxkl: 6.527686178763979e-19
[INFO: 2020-09-08 03:16:50,085] beta: 0.5
[INFO: 2020-09-08 03:16:50,085] mv_viloate: 1
[INFO: 2020-09-08 03:17:56,617] x: 1.1323653064984045, y: 1.1440872104595101 @iteration 1152
[INFO: 2020-09-08 03:19:42,207] ######## Epoch (VAL) 1168 ########
[INFO: 2020-09-08 03:19:42,208] {'CIDEr': 1.2234338405769847}
[INFO: 2020-09-08 03:20:43,098] test_current @iteration 1168: 1.2370774665033644, test_predictor: 1.2360201821371941
[INFO: 2020-09-08 03:20:43,098] mv_approxkl: 1.209593427573879e-19
[INFO: 2020-09-08 03:20:43,098] beta: 0.5
[INFO: 2020-09-08 03:20:43,098] mv_viloate: 1
[INFO: 2020-09-08 03:21:50,428] x: 1.1253103225876169, y: 1.1155878602087101 @iteration 1168
[INFO: 2020-09-08 03:21:50,428] update predictor @iteration 1168
[INFO: 2020-09-08 03:23:35,029] ######## Epoch (VAL) 1184 ########
[INFO: 2020-09-08 03:23:35,029] {'CIDEr': 1.2225923362567654}
[INFO: 2020-09-08 03:24:36,542] test_current @iteration 1184: 1.2383691941093111, test_predictor: 1.2370774665033644
[INFO: 2020-09-08 03:24:36,542] mv_approxkl: 2.241401041596896e-20
[INFO: 2020-09-08 03:24:36,542] beta: 0.5
[INFO: 2020-09-08 03:24:36,542] mv_viloate: 1
[INFO: 2020-09-08 03:25:43,378] x: 1.1306658818875321, y: 1.1151775374788258 @iteration 1184
[INFO: 2020-09-08 03:25:43,378] update predictor @iteration 1184
[INFO: 2020-09-08 03:27:27,954] ######## Epoch (VAL) 1200 ########
[INFO: 2020-09-08 03:27:27,955] {'CIDEr': 1.2227691024887162}
[INFO: 2020-09-08 03:28:28,060] test_current @iteration 1200: 1.2386360715550462, test_predictor: 1.2383691941093111
[INFO: 2020-09-08 03:28:28,060] mv_approxkl: 4.1533613813925945e-21
[INFO: 2020-09-08 03:28:28,060] beta: 0.5
[INFO: 2020-09-08 03:28:28,060] mv_viloate: 1
[INFO: 2020-09-08 03:29:35,469] x: 1.1190647305766068, y: 1.118428745170334 @iteration 1200
[INFO: 2020-09-08 03:31:21,577] ######## Epoch (VAL) 1216 ########
[INFO: 2020-09-08 03:31:21,577] {'CIDEr': 1.2247408392133636}
[INFO: 2020-09-08 03:32:21,614] test_current @iteration 1216: 1.2392543375075762, test_predictor: 1.2383691941093111
[INFO: 2020-09-08 03:32:21,615] mv_approxkl: 7.696262491318052e-22
[INFO: 2020-09-08 03:32:21,615] beta: 0.5
[INFO: 2020-09-08 03:32:21,615] mv_viloate: 1
[INFO: 2020-09-08 03:33:28,152] x: 1.1391051237455523, y: 1.1219521393168943 @iteration 1216
[INFO: 2020-09-08 03:33:28,152] update predictor @iteration 1216
[INFO: 2020-09-08 03:35:12,485] ######## Epoch (VAL) 1232 ########
[INFO: 2020-09-08 03:35:12,485] {'CIDEr': 1.225881174026946}
[INFO: 2020-09-08 03:36:14,418] test_current @iteration 1232: 1.2389897002851682, test_predictor: 1.2392543375075762
[INFO: 2020-09-08 03:36:14,419] mv_approxkl: 1.4261329775115522e-22
[INFO: 2020-09-08 03:36:14,419] beta: 0.5
[INFO: 2020-09-08 03:36:14,419] mv_viloate: 1
[INFO: 2020-09-08 03:37:22,333] x: 1.1320002169868955, y: 1.1430373502216848 @iteration 1232
[INFO: 2020-09-08 03:39:06,632] ######## Epoch (VAL) 1248 ########
[INFO: 2020-09-08 03:39:06,633] {'CIDEr': 1.225711384430999}
[INFO: 2020-09-08 03:40:07,634] test_current @iteration 1248: 1.2385591429487708, test_predictor: 1.2392543375075762
[INFO: 2020-09-08 03:40:07,634] mv_approxkl: 2.6426531993162952e-23
[INFO: 2020-09-08 03:40:07,634] beta: 0.5
[INFO: 2020-09-08 03:40:07,634] mv_viloate: 1
[INFO: 2020-09-08 03:41:14,313] x: 1.1357683495677657, y: 1.1366379082478677 @iteration 1248
[INFO: 2020-09-08 03:42:59,682] ######## Epoch (VAL) 1264 ########
[INFO: 2020-09-08 03:42:59,683] {'CIDEr': 1.2246941385867318}
[INFO: 2020-09-08 03:43:59,940] test_current @iteration 1264: 1.2389873845297896, test_predictor: 1.2392543375075762
[INFO: 2020-09-08 03:43:59,941] mv_approxkl: 0.00017221784219145775
[INFO: 2020-09-08 03:43:59,941] beta: 0.5
[INFO: 2020-09-08 03:43:59,941] mv_viloate: 1.0
[INFO: 2020-09-08 03:45:06,489] x: 1.130721834476783, y: 1.1414942495873504 @iteration 1264
[INFO: 2020-09-08 03:46:51,835] ######## Epoch (VAL) 1280 ########
[INFO: 2020-09-08 03:46:51,835] {'CIDEr': 1.224935967433131}
[INFO: 2020-09-08 03:47:52,829] test_current @iteration 1280: 1.2392035802329955, test_predictor: 1.2392543375075762
[INFO: 2020-09-08 03:47:52,829] mv_approxkl: 3.191231384612717e-05
[INFO: 2020-09-08 03:47:52,830] beta: 0.5
[INFO: 2020-09-08 03:47:52,830] mv_viloate: 1
[INFO: 2020-09-08 03:48:59,710] x: 1.1612322585029868, y: 1.139475886379522 @iteration 1280
[INFO: 2020-09-08 03:48:59,710] update predictor @iteration 1280
[INFO: 2020-09-08 03:50:45,811] ######## Epoch (VAL) 1296 ########
[INFO: 2020-09-08 03:50:45,811] {'CIDEr': 1.2256885343461592}
[INFO: 2020-09-08 03:51:46,091] test_current @iteration 1296: 1.2398225262518936, test_predictor: 1.2392035802329955
[INFO: 2020-09-08 03:51:46,091] mv_approxkl: 5.91341618298498e-06
[INFO: 2020-09-08 03:51:46,091] beta: 0.5
[INFO: 2020-09-08 03:51:46,091] mv_viloate: 1
[INFO: 2020-09-08 03:52:52,766] x: 1.1384825712747197, y: 1.144682678536333 @iteration 1296
[INFO: 2020-09-08 03:54:38,032] ######## Epoch (VAL) 1312 ########
[INFO: 2020-09-08 03:54:38,032] {'CIDEr': 1.2259469792213658}
[INFO: 2020-09-08 03:55:41,103] test_current @iteration 1312: 1.2406160673751503, test_predictor: 1.2392035802329955
[INFO: 2020-09-08 03:55:41,103] mv_approxkl: 1.0957679572154368e-06
[INFO: 2020-09-08 03:55:41,104] beta: 0.5
[INFO: 2020-09-08 03:55:41,104] mv_viloate: 1
[INFO: 2020-09-08 03:56:47,565] x: 1.160097827185566, y: 1.1427698720702275 @iteration 1312
[INFO: 2020-09-08 03:56:47,566] update predictor @iteration 1312
[INFO: 2020-09-08 03:58:32,336] ######## Epoch (VAL) 1328 ########
[INFO: 2020-09-08 03:58:32,336] {'CIDEr': 1.2254844459824399}
[INFO: 2020-09-08 03:59:32,934] test_current @iteration 1328: 1.2408493761351382, test_predictor: 1.2406160673751503
[INFO: 2020-09-08 03:59:32,934] mv_approxkl: 2.0304801470171455e-07
[INFO: 2020-09-08 03:59:32,934] beta: 0.5
[INFO: 2020-09-08 03:59:32,934] mv_viloate: 1
[INFO: 2020-09-08 04:00:38,785] x: 1.159460838489454, y: 1.175009139816251 @iteration 1328
[INFO: 2020-09-08 04:02:24,748] ######## Epoch (VAL) 1344 ########
[INFO: 2020-09-08 04:02:24,748] {'CIDEr': 1.224518895666253}
[INFO: 2020-09-08 04:03:24,980] test_current @iteration 1344: 1.240194684148266, test_predictor: 1.2406160673751503
[INFO: 2020-09-08 04:03:24,980] mv_approxkl: 3.7625207054856267e-08
[INFO: 2020-09-08 04:03:24,980] beta: 0.5
[INFO: 2020-09-08 04:03:24,980] mv_viloate: 1
[INFO: 2020-09-08 04:04:31,957] x: 1.1471792326831909, y: 1.1614992606837018 @iteration 1344
[INFO: 2020-09-08 04:06:16,471] ######## Epoch (VAL) 1360 ########
[INFO: 2020-09-08 04:06:16,471] {'CIDEr': 1.227206829467629}
[INFO: 2020-09-08 04:07:18,142] test_current @iteration 1360: 1.2418136273016143, test_predictor: 1.2406160673751503
[INFO: 2020-09-08 04:07:18,142] mv_approxkl: 0.00038219829067290164
[INFO: 2020-09-08 04:07:18,142] beta: 0.5
[INFO: 2020-09-08 04:07:18,142] mv_viloate: 1
[INFO: 2020-09-08 04:08:24,648] x: 1.1506525323983674, y: 1.1505503543840458 @iteration 1360
[INFO: 2020-09-08 04:10:09,407] ######## Epoch (VAL) 1376 ########
[INFO: 2020-09-08 04:10:09,408] {'CIDEr': 1.2271454406811464}
[INFO: 2020-09-08 04:11:10,282] test_current @iteration 1376: 1.240455733724562, test_predictor: 1.2406160673751503
[INFO: 2020-09-08 04:11:10,283] mv_approxkl: 0.003076965125097577
[INFO: 2020-09-08 04:11:10,283] beta: 0.5
[INFO: 2020-09-08 04:11:10,283] mv_viloate: 1
[INFO: 2020-09-08 04:12:17,398] x: 1.1792019537803318, y: 1.1610236075157798 @iteration 1376
[INFO: 2020-09-08 04:12:17,398] update predictor @iteration 1376
[INFO: 2020-09-08 04:14:03,229] ######## Epoch (VAL) 1392 ########
[INFO: 2020-09-08 04:14:03,229] {'CIDEr': 1.2262981497410663}
[INFO: 2020-09-08 04:15:03,797] test_current @iteration 1392: 1.241525606800545, test_predictor: 1.240455733724562
[INFO: 2020-09-08 04:15:03,797] mv_approxkl: 0.0027847951605945672
[INFO: 2020-09-08 04:15:03,797] beta: 0.5
[INFO: 2020-09-08 04:15:03,797] mv_viloate: 1
[INFO: 2020-09-08 04:16:10,940] x: 1.1854807675101164, y: 1.1948976813895658 @iteration 1392
[INFO: 2020-09-08 04:17:56,437] ######## Epoch (VAL) 1408 ########
[INFO: 2020-09-08 04:17:56,437] {'CIDEr': 1.2284971304198924}
[INFO: 2020-09-08 04:18:57,966] test_current @iteration 1408: 1.239870651164851, test_predictor: 1.240455733724562
[INFO: 2020-09-08 04:18:57,966] mv_approxkl: 0.04431514955207432
[INFO: 2020-09-08 04:18:57,966] beta: 2.0
[INFO: 2020-09-08 04:18:57,966] mv_viloate: 1.8933424746765803
[INFO: 2020-09-08 04:20:04,340] x: 1.1485006759088408, y: 1.1414113237876453 @iteration 1408
[INFO: 2020-09-08 04:20:04,340] update predictor @iteration 1408
[INFO: 2020-09-08 04:21:49,377] ######## Epoch (VAL) 1424 ########
[INFO: 2020-09-08 04:21:49,377] {'CIDEr': 1.2276253958792076}
[INFO: 2020-09-08 04:22:50,018] test_current @iteration 1424: 1.2419819686739273, test_predictor: 1.239870651164851
[INFO: 2020-09-08 04:22:50,018] mv_approxkl: 0.015809782343416654
[INFO: 2020-09-08 04:22:50,018] beta: 0.5
[INFO: 2020-09-08 04:22:50,018] mv_viloate: 1.0353569770566413
[INFO: 2020-09-08 04:23:56,320] x: 1.1665672557222646, y: 1.1656482593896926 @iteration 1424
[INFO: 2020-09-08 04:25:41,834] ######## Epoch (VAL) 1440 ########
[INFO: 2020-09-08 04:25:41,834] {'CIDEr': 1.2249403441895637}
[INFO: 2020-09-08 04:26:42,141] test_current @iteration 1440: 1.2409616052812456, test_predictor: 1.239870651164851
[INFO: 2020-09-08 04:26:42,141] mv_approxkl: 0.013649841268411827
[INFO: 2020-09-08 04:26:42,141] beta: 0.5
[INFO: 2020-09-08 04:26:42,141] mv_viloate: 1.0424201973271439
[INFO: 2020-09-08 04:27:48,785] x: 1.1852023009721568, y: 1.1926174109025829 @iteration 1440
[INFO: 2020-09-08 04:29:33,879] ######## Epoch (VAL) 1456 ########
[INFO: 2020-09-08 04:29:33,879] {'CIDEr': 1.2286668558218772}
[INFO: 2020-09-08 04:30:35,854] test_current @iteration 1456: 1.240007365832672, test_predictor: 1.239870651164851
[INFO: 2020-09-08 04:30:35,854] mv_approxkl: 0.02844833039883434
[INFO: 2020-09-08 04:30:35,854] beta: 1.0
[INFO: 2020-09-08 04:30:35,854] mv_viloate: 1.624
[INFO: 2020-09-08 04:31:43,078] x: 1.1877015037877847, y: 1.1867953074497732 @iteration 1456
[INFO: 2020-09-08 04:33:27,544] ######## Epoch (VAL) 1472 ########
[INFO: 2020-09-08 04:33:27,544] {'CIDEr': 1.2287393949136087}
[INFO: 2020-09-08 04:34:27,758] test_current @iteration 1472: 1.2372631527169111, test_predictor: 1.239870651164851
[INFO: 2020-09-08 04:34:27,758] mv_approxkl: 0.010401521262347979
[INFO: 2020-09-08 04:34:27,758] beta: 0.5
[INFO: 2020-09-08 04:34:27,758] mv_viloate: 1.1627442624812163
[INFO: 2020-09-08 04:35:33,148] x: 1.1700312897819487, y: 1.1555401458005448 @iteration 1472
[INFO: 2020-09-08 04:35:33,149] update predictor @iteration 1472
[INFO: 2020-09-08 04:37:18,964] ######## Epoch (VAL) 1488 ########
[INFO: 2020-09-08 04:37:18,965] {'CIDEr': 1.2300608465744616}
[INFO: 2020-09-08 04:38:19,477] test_current @iteration 1488: 1.2369542911188185, test_predictor: 1.2372631527169111
[INFO: 2020-09-08 04:38:19,477] mv_approxkl: 0.0019274228893902494
[INFO: 2020-09-08 04:38:19,477] beta: 0.5
[INFO: 2020-09-08 04:38:19,477] mv_viloate: 1
[INFO: 2020-09-08 04:39:25,458] x: 1.1779523671454808, y: 1.1741168635790027 @iteration 1488
[INFO: 2020-09-08 04:39:25,458] update predictor @iteration 1488
[INFO: 2020-09-08 04:41:09,409] ######## Epoch (VAL) 1504 ########
[INFO: 2020-09-08 04:41:09,409] {'CIDEr': 1.2308745440219555}
[INFO: 2020-09-08 04:42:09,936] test_current @iteration 1504: 1.2361447830964742, test_predictor: 1.2369542911188185
[INFO: 2020-09-08 04:42:09,936] mv_approxkl: 0.0003571553526495283
[INFO: 2020-09-08 04:42:09,936] beta: 0.5
[INFO: 2020-09-08 04:42:09,936] mv_viloate: 1
[INFO: 2020-09-08 04:43:16,446] x: 1.1673612103497992, y: 1.1542066209569057 @iteration 1504
[INFO: 2020-09-08 04:43:16,446] update predictor @iteration 1504
[INFO: 2020-09-08 04:45:02,715] ######## Epoch (VAL) 1520 ########
[INFO: 2020-09-08 04:45:02,715] {'CIDEr': 1.2302905923918483}
[INFO: 2020-09-08 04:46:03,233] test_current @iteration 1520: 1.2389757114198807, test_predictor: 1.2361447830964742
[INFO: 2020-09-08 04:46:03,233] mv_approxkl: 6.61816079016075e-05
[INFO: 2020-09-08 04:46:03,233] beta: 0.5
[INFO: 2020-09-08 04:46:03,233] mv_viloate: 1
[INFO: 2020-09-08 04:47:09,281] x: 1.20049121674302, y: 1.2000031851616189 @iteration 1520
[INFO: 2020-09-08 04:48:53,764] ######## Epoch (VAL) 1536 ########
[INFO: 2020-09-08 04:48:53,764] {'CIDEr': 1.2310107474842937}
[INFO: 2020-09-08 04:49:55,540] test_current @iteration 1536: 1.2397692311099282, test_predictor: 1.2361447830964742
[INFO: 2020-09-08 04:49:55,540] mv_approxkl: 1.2263585557235528e-05
[INFO: 2020-09-08 04:49:55,540] beta: 0.5
[INFO: 2020-09-08 04:49:55,540] mv_viloate: 1
[INFO: 2020-09-08 04:51:02,002] x: 1.1708187987846446, y: 1.1720573159073873 @iteration 1536
[INFO: 2020-09-08 04:52:46,801] ######## Epoch (VAL) 1552 ########
[INFO: 2020-09-08 04:52:46,801] {'CIDEr': 1.2327257353906473}
[INFO: 2020-09-08 04:53:47,863] test_current @iteration 1552: 1.2398100971792732, test_predictor: 1.2361447830964742
[INFO: 2020-09-08 04:53:47,863] mv_approxkl: 2.2724671625269294e-06
[INFO: 2020-09-08 04:53:47,863] beta: 0.5
[INFO: 2020-09-08 04:53:47,863] mv_viloate: 1
[INFO: 2020-09-08 04:54:54,154] x: 1.1739267106967934, y: 1.1662985455133072 @iteration 1552
[INFO: 2020-09-08 04:54:54,154] update predictor @iteration 1552
[INFO: 2020-09-08 04:56:40,347] ######## Epoch (VAL) 1568 ########
[INFO: 2020-09-08 04:56:40,347] {'CIDEr': 1.2326441896472773}
[INFO: 2020-09-08 04:57:40,549] test_current @iteration 1568: 1.2417507652684936, test_predictor: 1.2398100971792732
[INFO: 2020-09-08 04:57:40,549] mv_approxkl: 4.2109275306652586e-07
[INFO: 2020-09-08 04:57:40,549] beta: 0.5
[INFO: 2020-09-08 04:57:40,549] mv_viloate: 1
[INFO: 2020-09-08 04:58:46,287] x: 1.1865103705005655, y: 1.1778970759442116 @iteration 1568
[INFO: 2020-09-08 04:58:46,287] update predictor @iteration 1568
[INFO: 2020-09-08 05:00:30,502] ######## Epoch (VAL) 1584 ########
[INFO: 2020-09-08 05:00:30,502] {'CIDEr': 1.23162034523114}
[INFO: 2020-09-08 05:01:32,287] test_current @iteration 1584: 1.2411941648322034, test_predictor: 1.2417507652684936
[INFO: 2020-09-08 05:01:32,287] mv_approxkl: 7.802933728114757e-08
[INFO: 2020-09-08 05:01:32,287] beta: 0.5
[INFO: 2020-09-08 05:01:32,287] mv_viloate: 1
[INFO: 2020-09-08 05:02:38,258] x: 1.2063647600916594, y: 1.18827051168671 @iteration 1584
[INFO: 2020-09-08 05:02:38,258] update predictor @iteration 1584
[INFO: 2020-09-08 05:04:24,050] ######## Epoch (VAL) 1600 ########
[INFO: 2020-09-08 05:04:24,051] {'CIDEr': 1.232561617298088}
[INFO: 2020-09-08 05:05:24,678] test_current @iteration 1600: 1.241915619115992, test_predictor: 1.2411941648322034
[INFO: 2020-09-08 05:05:24,678] mv_approxkl: 1.4458993730469612e-08
[INFO: 2020-09-08 05:05:24,678] beta: 0.5
[INFO: 2020-09-08 05:05:24,678] mv_viloate: 1
[INFO: 2020-09-08 05:06:30,923] x: 1.1929800387322356, y: 1.2073528170289467 @iteration 1600
[INFO: 2020-09-08 05:08:17,106] ######## Epoch (VAL) 1616 ########
[INFO: 2020-09-08 05:08:17,106] {'CIDEr': 1.2323159556680068}
[INFO: 2020-09-08 05:09:17,894] test_current @iteration 1616: 1.24230701500925, test_predictor: 1.2411941648322034
[INFO: 2020-09-08 05:09:17,894] mv_approxkl: 2.67928072930424e-09
[INFO: 2020-09-08 05:09:17,894] beta: 0.5
[INFO: 2020-09-08 05:09:17,894] mv_viloate: 1
[INFO: 2020-09-08 05:10:23,091] x: 1.1833673441592933, y: 1.1700309506213729 @iteration 1616
[INFO: 2020-09-08 05:10:23,092] update predictor @iteration 1616
[INFO: 2020-09-08 05:12:07,916] ######## Epoch (VAL) 1632 ########
[INFO: 2020-09-08 05:12:07,916] {'CIDEr': 1.232238528630976}
[INFO: 2020-09-08 05:13:08,251] test_current @iteration 1632: 1.2424145607029369, test_predictor: 1.24230701500925
[INFO: 2020-09-08 05:13:08,251] mv_approxkl: 4.964761283002441e-10
[INFO: 2020-09-08 05:13:08,251] beta: 0.5
[INFO: 2020-09-08 05:13:08,251] mv_viloate: 1
[INFO: 2020-09-08 05:14:14,448] x: 1.1895392651051608, y: 1.2071312039646511 @iteration 1632
[INFO: 2020-09-08 05:16:00,967] ######## Epoch (VAL) 1648 ########
[INFO: 2020-09-08 05:16:00,967] {'CIDEr': 1.2329097687738488}
[INFO: 2020-09-08 05:17:01,195] test_current @iteration 1648: 1.2443638159636496, test_predictor: 1.24230701500925
[INFO: 2020-09-08 05:17:01,195] mv_approxkl: 9.199802890233495e-11
[INFO: 2020-09-08 05:17:01,195] beta: 0.5
[INFO: 2020-09-08 05:17:01,195] mv_viloate: 1
[INFO: 2020-09-08 05:18:06,998] x: 1.1966477110367673, y: 1.2155875605953463 @iteration 1648
[INFO: 2020-09-08 05:19:51,940] ######## Epoch (VAL) 1664 ########
[INFO: 2020-09-08 05:19:51,941] {'CIDEr': 1.2328912742669258}
[INFO: 2020-09-08 05:20:53,358] test_current @iteration 1664: 1.243709277708235, test_predictor: 1.24230701500925
[INFO: 2020-09-08 05:20:53,359] mv_approxkl: 1.7047420489060187e-11
[INFO: 2020-09-08 05:20:53,359] beta: 0.5
[INFO: 2020-09-08 05:20:53,359] mv_viloate: 1
[INFO: 2020-09-08 05:21:59,850] x: 1.21749512220614, y: 1.2157976588305937 @iteration 1664
[INFO: 2020-09-08 05:21:59,851] update predictor @iteration 1664
[INFO: 2020-09-08 05:23:44,410] ######## Epoch (VAL) 1680 ########
[INFO: 2020-09-08 05:23:44,411] {'CIDEr': 1.2316032498124554}
[INFO: 2020-09-08 05:24:45,186] test_current @iteration 1680: 1.244205978558952, test_predictor: 1.243709277708235
[INFO: 2020-09-08 05:24:45,186] mv_approxkl: 3.158921433407506e-12
[INFO: 2020-09-08 05:24:45,186] beta: 0.5
[INFO: 2020-09-08 05:24:45,186] mv_viloate: 1
[INFO: 2020-09-08 05:25:50,988] x: 1.197163115300716, y: 1.1968986875608778 @iteration 1680
[INFO: 2020-09-08 05:27:37,256] ######## Epoch (VAL) 1696 ########
[INFO: 2020-09-08 05:27:37,256] {'CIDEr': 1.232008997888697}
[INFO: 2020-09-08 05:28:37,655] test_current @iteration 1696: 1.2448354210462447, test_predictor: 1.243709277708235
[INFO: 2020-09-08 05:28:37,655] mv_approxkl: 5.853545191100909e-13
[INFO: 2020-09-08 05:28:37,656] beta: 0.5
[INFO: 2020-09-08 05:28:37,656] mv_viloate: 1
[INFO: 2020-09-08 05:29:44,267] x: 1.1941023432771234, y: 1.2031452674631151 @iteration 1696
[INFO: 2020-09-08 05:31:28,655] ######## Epoch (VAL) 1712 ########
[INFO: 2020-09-08 05:31:28,655] {'CIDEr': 1.2334138673977995}
[INFO: 2020-09-08 05:32:30,192] test_current @iteration 1712: 1.2466943763071026, test_predictor: 1.243709277708235
[INFO: 2020-09-08 05:32:30,192] mv_approxkl: 1.0846737415466595e-13
[INFO: 2020-09-08 05:32:30,192] beta: 0.5
[INFO: 2020-09-08 05:32:30,192] mv_viloate: 1
[INFO: 2020-09-08 05:33:37,999] x: 1.2270669121619793, y: 1.19914019803768 @iteration 1712
[INFO: 2020-09-08 05:33:38,000] update predictor @iteration 1712
[INFO: 2020-09-08 05:35:22,698] ######## Epoch (VAL) 1728 ########
[INFO: 2020-09-08 05:35:22,698] {'CIDEr': 1.2347626657300728}
[INFO: 2020-09-08 05:36:23,342] test_current @iteration 1728: 1.245819666403021, test_predictor: 1.2466943763071026
[INFO: 2020-09-08 05:36:23,342] mv_approxkl: 2.0099223414034244e-14
[INFO: 2020-09-08 05:36:23,342] beta: 0.5
[INFO: 2020-09-08 05:36:23,342] mv_viloate: 1
[INFO: 2020-09-08 05:37:29,199] x: 1.215445790514333, y: 1.204378083667499 @iteration 1728
[INFO: 2020-09-08 05:37:29,200] update predictor @iteration 1728
[INFO: 2020-09-08 05:39:15,807] ######## Epoch (VAL) 1744 ########
[INFO: 2020-09-08 05:39:15,807] {'CIDEr': 1.2351806198496817}
[INFO: 2020-09-08 05:40:16,217] test_current @iteration 1744: 1.2457262981857986, test_predictor: 1.245819666403021
[INFO: 2020-09-08 05:40:16,217] mv_approxkl: 3.72442667664491e-15
[INFO: 2020-09-08 05:40:16,217] beta: 0.5
[INFO: 2020-09-08 05:40:16,217] mv_viloate: 1
[INFO: 2020-09-08 05:41:21,872] x: 1.2081551898879286, y: 1.2038904976358578 @iteration 1744
[INFO: 2020-09-08 05:41:21,872] update predictor @iteration 1744
[INFO: 2020-09-08 05:43:06,313] ######## Epoch (VAL) 1760 ########
[INFO: 2020-09-08 05:43:06,313] {'CIDEr': 1.2348741727865498}
[INFO: 2020-09-08 05:44:06,848] test_current @iteration 1760: 1.2456782171790532, test_predictor: 1.2457262981857986
[INFO: 2020-09-08 05:44:06,848] mv_approxkl: 6.901437823721387e-16
[INFO: 2020-09-08 05:44:06,848] beta: 0.5
[INFO: 2020-09-08 05:44:06,848] mv_viloate: 1
[INFO: 2020-09-08 05:45:12,666] x: 1.207564279185586, y: 1.2047340673831783 @iteration 1760
[INFO: 2020-09-08 05:45:12,666] update predictor @iteration 1760
[INFO: 2020-09-08 05:46:59,782] ######## Epoch (VAL) 1776 ########
[INFO: 2020-09-08 05:46:59,782] {'CIDEr': 1.2341776987208957}
[INFO: 2020-09-08 05:48:00,043] test_current @iteration 1776: 1.2457516099132429, test_predictor: 1.2456782171790532
[INFO: 2020-09-08 05:48:00,044] mv_approxkl: 1.2788503619461442e-16
[INFO: 2020-09-08 05:48:00,044] beta: 0.5
[INFO: 2020-09-08 05:48:00,044] mv_viloate: 1
[INFO: 2020-09-08 05:49:06,651] x: 1.2314106377262504, y: 1.2287521498768799 @iteration 1776
[INFO: 2020-09-08 05:49:06,652] update predictor @iteration 1776
[INFO: 2020-09-08 05:50:51,081] ######## Epoch (VAL) 1792 ########
[INFO: 2020-09-08 05:50:51,081] {'CIDEr': 1.2346440950694173}
[INFO: 2020-09-08 05:51:52,871] test_current @iteration 1792: 1.2456914386954012, test_predictor: 1.2457516099132429
[INFO: 2020-09-08 05:51:52,871] mv_approxkl: 2.36973553920669e-17
[INFO: 2020-09-08 05:51:52,871] beta: 0.5
[INFO: 2020-09-08 05:51:52,871] mv_viloate: 1
[INFO: 2020-09-08 05:52:58,621] x: 1.2243249942994294, y: 1.2151807664924803 @iteration 1792
[INFO: 2020-09-08 05:52:58,621] update predictor @iteration 1792
[INFO: 2020-09-08 05:54:42,736] ######## Epoch (VAL) 1808 ########
[INFO: 2020-09-08 05:54:42,736] {'CIDEr': 1.2329229743783812}
[INFO: 2020-09-08 05:55:43,360] test_current @iteration 1808: 1.247763051944153, test_predictor: 1.2456914386954012
[INFO: 2020-09-08 05:55:43,360] mv_approxkl: 4.391167796389702e-18
[INFO: 2020-09-08 05:55:43,360] beta: 0.5
[INFO: 2020-09-08 05:55:43,360] mv_viloate: 1
[INFO: 2020-09-08 05:56:50,377] x: 1.2057064167918796, y: 1.2064448859313504 @iteration 1808
[INFO: 2020-09-08 05:58:35,673] ######## Epoch (VAL) 1824 ########
[INFO: 2020-09-08 05:58:35,673] {'CIDEr': 1.2339566502130668}
[INFO: 2020-09-08 05:59:35,906] test_current @iteration 1824: 1.247328705050131, test_predictor: 1.2456914386954012
[INFO: 2020-09-08 05:59:35,906] mv_approxkl: 8.13692257934617e-19
[INFO: 2020-09-08 05:59:35,906] beta: 0.5
[INFO: 2020-09-08 05:59:35,906] mv_viloate: 1
[INFO: 2020-09-08 06:00:42,522] x: 1.2144197773047227, y: 1.2164049929187764 @iteration 1824
[INFO: 2020-09-08 06:02:27,201] ######## Epoch (VAL) 1840 ########
[INFO: 2020-09-08 06:02:27,202] {'CIDEr': 1.234336570340443}
[INFO: 2020-09-08 06:03:27,646] test_current @iteration 1840: 1.2467761820621772, test_predictor: 1.2456914386954012
[INFO: 2020-09-08 06:03:27,646] mv_approxkl: 1.507788181465285e-19
[INFO: 2020-09-08 06:03:27,646] beta: 0.5
[INFO: 2020-09-08 06:03:27,646] mv_viloate: 1
[INFO: 2020-09-08 06:04:33,783] x: 1.2147119743969785, y: 1.2180678395759472 @iteration 1840
[INFO: 2020-09-08 06:06:20,538] ######## Epoch (VAL) 1856 ########
[INFO: 2020-09-08 06:06:20,539] {'CIDEr': 1.2365478665017502}
[INFO: 2020-09-08 06:07:21,466] test_current @iteration 1856: 1.2473030317936578, test_predictor: 1.2456914386954012
[INFO: 2020-09-08 06:07:21,466] mv_approxkl: 0.00018113178892351317
[INFO: 2020-09-08 06:07:21,466] beta: 0.5
[INFO: 2020-09-08 06:07:21,466] mv_viloate: 1
[INFO: 2020-09-08 06:08:26,911] x: 1.2315900542655507, y: 1.2171233348045662 @iteration 1856
[INFO: 2020-09-08 06:08:26,911] update predictor @iteration 1856
[INFO: 2020-09-08 06:10:12,531] ######## Epoch (VAL) 1872 ########
[INFO: 2020-09-08 06:10:12,532] {'CIDEr': 1.2374552691866656}
[INFO: 2020-09-08 06:11:12,854] test_current @iteration 1872: 1.2483639027425657, test_predictor: 1.2473030317936578
[INFO: 2020-09-08 06:11:12,854] mv_approxkl: 3.356408617181202e-05
[INFO: 2020-09-08 06:11:12,854] beta: 0.5
[INFO: 2020-09-08 06:11:12,854] mv_viloate: 1
[INFO: 2020-09-08 06:12:18,964] x: 1.236554149831114, y: 1.2273896710595937 @iteration 1872
[INFO: 2020-09-08 06:12:18,965] update predictor @iteration 1872
[INFO: 2020-09-08 06:14:02,953] ######## Epoch (VAL) 1888 ########
[INFO: 2020-09-08 06:14:02,953] {'CIDEr': 1.236741282159174}
[INFO: 2020-09-08 06:15:03,710] test_current @iteration 1888: 1.2472122204209333, test_predictor: 1.2483639027425657
[INFO: 2020-09-08 06:15:03,711] mv_approxkl: 6.21949292967306e-06
[INFO: 2020-09-08 06:15:03,711] beta: 0.5
[INFO: 2020-09-08 06:15:03,711] mv_viloate: 1
[INFO: 2020-09-08 06:16:09,025] x: 1.2345075543786128, y: 1.2225032291245557 @iteration 1888
[INFO: 2020-09-08 06:16:09,025] update predictor @iteration 1888
[INFO: 2020-09-08 06:17:54,585] ######## Epoch (VAL) 1904 ########
[INFO: 2020-09-08 06:17:54,585] {'CIDEr': 1.236227918893463}
[INFO: 2020-09-08 06:18:54,762] test_current @iteration 1904: 1.2479646722319329, test_predictor: 1.2472122204209333
[INFO: 2020-09-08 06:18:54,763] mv_approxkl: 1.152484596310547e-06
[INFO: 2020-09-08 06:18:54,763] beta: 0.5
[INFO: 2020-09-08 06:18:54,763] mv_viloate: 1
[INFO: 2020-09-08 06:20:01,069] x: 1.2394520109733234, y: 1.218572689393901 @iteration 1904
[INFO: 2020-09-08 06:20:01,070] update predictor @iteration 1904
[INFO: 2020-09-08 06:21:45,617] ######## Epoch (VAL) 1920 ########
[INFO: 2020-09-08 06:21:45,617] {'CIDEr': 1.2374948067194398}
[INFO: 2020-09-08 06:22:47,624] test_current @iteration 1920: 1.248150782474887, test_predictor: 1.2479646722319329
[INFO: 2020-09-08 06:22:47,624] mv_approxkl: 2.1355772243042086e-07
[INFO: 2020-09-08 06:22:47,624] beta: 0.5
[INFO: 2020-09-08 06:22:47,624] mv_viloate: 1
[INFO: 2020-09-08 06:23:52,921] x: 1.2453572807317272, y: 1.218685180349034 @iteration 1920
[INFO: 2020-09-08 06:23:52,921] update predictor @iteration 1920
[INFO: 2020-09-08 06:25:37,754] ######## Epoch (VAL) 1936 ########
[INFO: 2020-09-08 06:25:37,754] {'CIDEr': 1.2363595773918232}
[INFO: 2020-09-08 06:26:38,322] test_current @iteration 1936: 1.2486003224723579, test_predictor: 1.248150782474887
[INFO: 2020-09-08 06:26:38,323] mv_approxkl: 3.9572677114878763e-08
[INFO: 2020-09-08 06:26:38,323] beta: 0.5
[INFO: 2020-09-08 06:26:38,323] mv_viloate: 1
[INFO: 2020-09-08 06:27:43,958] x: 1.225141869762304, y: 1.2103291853171956 @iteration 1936
[INFO: 2020-09-08 06:27:43,958] update predictor @iteration 1936
[INFO: 2020-09-08 06:29:29,913] ######## Epoch (VAL) 1952 ########
[INFO: 2020-09-08 06:29:29,913] {'CIDEr': 1.235378689546105}
[INFO: 2020-09-08 06:30:30,739] test_current @iteration 1952: 1.248659530985582, test_predictor: 1.2486003224723579
[INFO: 2020-09-08 06:30:30,739] mv_approxkl: 7.33289696207856e-09
[INFO: 2020-09-08 06:30:30,739] beta: 0.5
[INFO: 2020-09-08 06:30:30,739] mv_viloate: 1
[INFO: 2020-09-08 06:31:36,814] x: 1.2401581214539834, y: 1.2381102062953362 @iteration 1952
[INFO: 2020-09-08 06:31:36,814] update predictor @iteration 1952
[INFO: 2020-09-08 06:33:21,533] ######## Epoch (VAL) 1968 ########
[INFO: 2020-09-08 06:33:21,533] {'CIDEr': 1.2347093419442436}
[INFO: 2020-09-08 06:34:23,108] test_current @iteration 1968: 1.2487099142548435, test_predictor: 1.248659530985582
[INFO: 2020-09-08 06:34:23,108] mv_approxkl: 1.358800611350191e-09
[INFO: 2020-09-08 06:34:23,108] beta: 0.5
[INFO: 2020-09-08 06:34:23,109] mv_viloate: 1
[INFO: 2020-09-08 06:35:29,297] x: 1.2504819946958892, y: 1.2128220038397126 @iteration 1968
[INFO: 2020-09-08 06:35:29,297] update predictor @iteration 1968
[INFO: 2020-09-08 06:37:13,899] ######## Epoch (VAL) 1984 ########
[INFO: 2020-09-08 06:37:13,899] {'CIDEr': 1.2332036820031045}
[INFO: 2020-09-08 06:38:14,465] test_current @iteration 1984: 1.2472765721271586, test_predictor: 1.2487099142548435
[INFO: 2020-09-08 06:38:14,465] mv_approxkl: 2.5178849654561286e-10
[INFO: 2020-09-08 06:38:14,465] beta: 0.5
[INFO: 2020-09-08 06:38:14,465] mv_viloate: 1
[INFO: 2020-09-08 06:39:20,860] x: 1.2672885421952642, y: 1.2523534403738563 @iteration 1984
[INFO: 2020-09-08 06:39:20,860] update predictor @iteration 1984
[INFO: 2020-09-08 06:41:06,926] ######## Epoch (VAL) 2000 ########
[INFO: 2020-09-08 06:41:06,926] {'CIDEr': 1.236109692898782}
[INFO: 2020-09-08 06:42:07,585] test_current @iteration 2000: 1.2494908804980145, test_predictor: 1.2472765721271586
[INFO: 2020-09-08 06:42:07,585] mv_approxkl: 4.665691674196728e-11
[INFO: 2020-09-08 06:42:07,585] beta: 0.5
[INFO: 2020-09-08 06:42:07,585] mv_viloate: 1
[INFO: 2020-09-08 06:43:12,967] x: 1.2444684977837728, y: 1.261169859428324 @iteration 2000
[INFO: 2020-09-08 06:44:58,203] ######## Epoch (VAL) 2016 ########
[INFO: 2020-09-08 06:44:58,203] {'CIDEr': 1.236382518617817}
[INFO: 2020-09-08 06:45:58,572] test_current @iteration 2016: 1.2505806435346662, test_predictor: 1.2472765721271586
[INFO: 2020-09-08 06:45:58,572] mv_approxkl: 8.645620867244487e-12
[INFO: 2020-09-08 06:45:58,573] beta: 0.5
[INFO: 2020-09-08 06:45:58,573] mv_viloate: 1
[INFO: 2020-09-08 06:47:04,300] x: 1.2624901028867326, y: 1.2378799176857966 @iteration 2016
[INFO: 2020-09-08 06:47:04,300] update predictor @iteration 2016
[INFO: 2020-09-08 06:48:50,178] ######## Epoch (VAL) 2032 ########
[INFO: 2020-09-08 06:48:50,178] {'CIDEr': 1.2367096715678625}
[INFO: 2020-09-08 06:49:50,444] test_current @iteration 2032: 1.2502656302445536, test_predictor: 1.2505806435346662
[INFO: 2020-09-08 06:49:50,445] mv_approxkl: 1.6020510012162804e-12
[INFO: 2020-09-08 06:49:50,445] beta: 0.5
[INFO: 2020-09-08 06:49:50,445] mv_viloate: 1
[INFO: 2020-09-08 06:50:56,311] x: 1.2573747915268334, y: 1.232071634568041 @iteration 2032
[INFO: 2020-09-08 06:50:56,312] update predictor @iteration 2032
[INFO: 2020-09-08 06:52:41,174] ######## Epoch (VAL) 2048 ########
[INFO: 2020-09-08 06:52:41,174] {'CIDEr': 1.2373701001292665}
[INFO: 2020-09-08 06:53:43,050] test_current @iteration 2048: 1.2508418488666957, test_predictor: 1.2502656302445536
[INFO: 2020-09-08 06:53:43,050] mv_approxkl: 2.9686328488240754e-13
[INFO: 2020-09-08 06:53:43,050] beta: 0.5
[INFO: 2020-09-08 06:53:43,050] mv_viloate: 1
[INFO: 2020-09-08 06:54:48,404] x: 1.2532122146326667, y: 1.2476981316562044 @iteration 2048
[INFO: 2020-09-08 06:54:48,405] update predictor @iteration 2048
[INFO: 2020-09-08 06:56:32,494] ######## Epoch (VAL) 2064 ########
[INFO: 2020-09-08 06:56:32,495] {'CIDEr': 1.2377241158956669}
[INFO: 2020-09-08 06:57:32,612] test_current @iteration 2064: 1.2491556863459057, test_predictor: 1.2508418488666957
[INFO: 2020-09-08 06:57:32,612] mv_approxkl: 5.500936602159772e-14
[INFO: 2020-09-08 06:57:32,612] beta: 0.5
[INFO: 2020-09-08 06:57:32,612] mv_viloate: 1
[INFO: 2020-09-08 06:58:37,816] x: 1.2513579109602455, y: 1.244370615831874 @iteration 2064
[INFO: 2020-09-08 06:58:37,816] update predictor @iteration 2064
[INFO: 2020-09-08 07:00:23,092] ######## Epoch (VAL) 2080 ########
[INFO: 2020-09-08 07:00:23,093] {'CIDEr': 1.2393177445706973}
[INFO: 2020-09-08 07:01:23,219] test_current @iteration 2080: 1.2489042360483327, test_predictor: 1.2491556863459057
[INFO: 2020-09-08 07:01:23,219] mv_approxkl: 1.0193346581396112e-14
[INFO: 2020-09-08 07:01:23,220] beta: 0.5
[INFO: 2020-09-08 07:01:23,220] mv_viloate: 1
[INFO: 2020-09-08 07:02:28,332] x: 1.2440128348562522, y: 1.2531005704881055 @iteration 2080
[INFO: 2020-09-08 07:04:12,921] ######## Epoch (VAL) 2096 ########
[INFO: 2020-09-08 07:04:12,921] {'CIDEr': 1.2379462833777213}
[INFO: 2020-09-08 07:05:14,582] test_current @iteration 2096: 1.2471130131831, test_predictor: 1.2491556863459057
[INFO: 2020-09-08 07:05:14,583] mv_approxkl: 1.88884770072909e-15
[INFO: 2020-09-08 07:05:14,583] beta: 0.5
[INFO: 2020-09-08 07:05:14,583] mv_viloate: 1
[INFO: 2020-09-08 07:06:20,346] x: 1.2425768641972867, y: 1.2445249375904668 @iteration 2096
[INFO: 2020-09-08 07:08:04,161] ######## Epoch (VAL) 2112 ########
[INFO: 2020-09-08 07:08:04,162] {'CIDEr': 1.2388750666052466}
[INFO: 2020-09-08 07:09:04,763] test_current @iteration 2112: 1.2469878921239472, test_predictor: 1.2491556863459057
[INFO: 2020-09-08 07:09:04,763] mv_approxkl: 0.00019773187175384338
[INFO: 2020-09-08 07:09:04,763] beta: 0.5
[INFO: 2020-09-08 07:09:04,763] mv_viloate: 1
[INFO: 2020-09-08 07:10:11,989] x: 1.2637403611625109, y: 1.2500070506882197 @iteration 2112
[INFO: 2020-09-08 07:10:11,989] update predictor @iteration 2112
[INFO: 2020-09-08 07:11:58,601] ######## Epoch (VAL) 2128 ########
[INFO: 2020-09-08 07:11:58,602] {'CIDEr': 1.2396145745765899}
[INFO: 2020-09-08 07:12:59,929] test_current @iteration 2128: 1.2460497297433133, test_predictor: 1.2469878921239472
[INFO: 2020-09-08 07:12:59,929] mv_approxkl: 3.6640115033933505e-05
[INFO: 2020-09-08 07:12:59,929] beta: 0.5
[INFO: 2020-09-08 07:12:59,929] mv_viloate: 1
[INFO: 2020-09-08 07:14:05,320] x: 1.2585605922961423, y: 1.2644919782367174 @iteration 2128
[INFO: 2020-09-08 07:15:49,795] ######## Epoch (VAL) 2144 ########
[INFO: 2020-09-08 07:15:49,795] {'CIDEr': 1.2399788075129157}
[INFO: 2020-09-08 07:16:50,096] test_current @iteration 2144: 1.2470970088230162, test_predictor: 1.2469878921239472
[INFO: 2020-09-08 07:16:50,096] mv_approxkl: 0.002749727475629682
[INFO: 2020-09-08 07:16:50,096] beta: 0.5
[INFO: 2020-09-08 07:16:50,096] mv_viloate: 1.0
[INFO: 2020-09-08 07:17:54,734] x: 1.2669736417959232, y: 1.261796711912178 @iteration 2144
[INFO: 2020-09-08 07:17:54,734] update predictor @iteration 2144
[INFO: 2020-09-08 07:19:39,616] ######## Epoch (VAL) 2160 ########
[INFO: 2020-09-08 07:19:39,617] {'CIDEr': 1.2404152995671582}
[INFO: 2020-09-08 07:20:40,209] test_current @iteration 2160: 1.248479668997812, test_predictor: 1.2470970088230162
[INFO: 2020-09-08 07:20:40,209] mv_approxkl: 0.0005095300526182413
[INFO: 2020-09-08 07:20:40,209] beta: 0.5
[INFO: 2020-09-08 07:20:40,209] mv_viloate: 1
[INFO: 2020-09-08 07:21:45,066] x: 1.2696889727780933, y: 1.2683608118034222 @iteration 2160
[INFO: 2020-09-08 07:21:45,066] update predictor @iteration 2160
[INFO: 2020-09-08 07:23:29,965] ######## Epoch (VAL) 2176 ########
[INFO: 2020-09-08 07:23:29,965] {'CIDEr': 1.2392340484961906}
[INFO: 2020-09-08 07:24:31,465] test_current @iteration 2176: 1.2486184187285803, test_predictor: 1.248479668997812
[INFO: 2020-09-08 07:24:31,465] mv_approxkl: 9.441694743283422e-05
[INFO: 2020-09-08 07:24:31,465] beta: 0.5
[INFO: 2020-09-08 07:24:31,465] mv_viloate: 1
[INFO: 2020-09-08 07:25:36,536] x: 1.279337215263804, y: 1.2766413402357428 @iteration 2176
[INFO: 2020-09-08 07:25:36,537] update predictor @iteration 2176
[INFO: 2020-09-08 07:27:20,769] ######## Epoch (VAL) 2192 ########
[INFO: 2020-09-08 07:27:20,769] {'CIDEr': 1.241066274633895}
[INFO: 2020-09-08 07:28:21,411] test_current @iteration 2192: 1.2488761293966615, test_predictor: 1.2486184187285803
[INFO: 2020-09-08 07:28:21,411] mv_approxkl: 1.7495650976280494e-05
[INFO: 2020-09-08 07:28:21,411] beta: 0.5
[INFO: 2020-09-08 07:28:21,411] mv_viloate: 1
[INFO: 2020-09-08 07:29:27,108] x: 1.2582026011546592, y: 1.2572900192449703 @iteration 2192
[INFO: 2020-09-08 07:31:12,949] ######## Epoch (VAL) 2208 ########
[INFO: 2020-09-08 07:31:12,949] {'CIDEr': 1.24061518881083}
[INFO: 2020-09-08 07:32:13,761] test_current @iteration 2208: 1.2480661050763378, test_predictor: 1.2486184187285803
[INFO: 2020-09-08 07:32:13,761] mv_approxkl: 3.2419794476153196e-06
[INFO: 2020-09-08 07:32:13,761] beta: 0.5
[INFO: 2020-09-08 07:32:13,761] mv_viloate: 1
[INFO: 2020-09-08 07:33:18,745] x: 1.2829669282217468, y: 1.2808263548336536 @iteration 2208
[INFO: 2020-09-08 07:33:18,745] update predictor @iteration 2208
[INFO: 2020-09-08 07:35:04,074] ######## Epoch (VAL) 2224 ########
[INFO: 2020-09-08 07:35:04,075] {'CIDEr': 1.2423871060539848}
[INFO: 2020-09-08 07:36:05,910] test_current @iteration 2224: 1.247131547869346, test_predictor: 1.2480661050763378
[INFO: 2020-09-08 07:36:05,910] mv_approxkl: 6.007453368273928e-07
[INFO: 2020-09-08 07:36:05,910] beta: 0.5
[INFO: 2020-09-08 07:36:05,910] mv_viloate: 1
[INFO: 2020-09-08 07:37:10,346] x: 1.2529018868575057, y: 1.260640551297339 @iteration 2224
[INFO: 2020-09-08 07:38:54,652] ######## Epoch (VAL) 2240 ########
[INFO: 2020-09-08 07:38:54,652] {'CIDEr': 1.2424199976272727}
[INFO: 2020-09-08 07:39:55,050] test_current @iteration 2240: 1.2476436397966766, test_predictor: 1.2480661050763378
[INFO: 2020-09-08 07:39:55,050] mv_approxkl: 0.000619699208311485
[INFO: 2020-09-08 07:39:55,050] beta: 0.5
[INFO: 2020-09-08 07:39:55,050] mv_viloate: 1
[INFO: 2020-09-08 07:41:00,126] x: 1.2605695113624826, y: 1.2531017005340537 @iteration 2240
[INFO: 2020-09-08 07:41:00,127] update predictor @iteration 2240
[INFO: 2020-09-08 07:42:45,357] ######## Epoch (VAL) 2256 ########
[INFO: 2020-09-08 07:42:45,358] {'CIDEr': 1.241889836073926}
[INFO: 2020-09-08 07:43:45,495] test_current @iteration 2256: 1.2479351525005702, test_predictor: 1.2476436397966766
[INFO: 2020-09-08 07:43:45,495] mv_approxkl: 0.00011483151440166848
[INFO: 2020-09-08 07:43:45,495] beta: 0.5
[INFO: 2020-09-08 07:43:45,495] mv_viloate: 1
[INFO: 2020-09-08 07:44:50,274] x: 1.2664639152869532, y: 1.2419228829291231 @iteration 2256
[INFO: 2020-09-08 07:44:50,274] update predictor @iteration 2256
[INFO: 2020-09-08 07:46:34,735] ######## Epoch (VAL) 2272 ########
[INFO: 2020-09-08 07:46:34,736] {'CIDEr': 1.2427409347221732}
[INFO: 2020-09-08 07:47:36,928] test_current @iteration 2272: 1.247164126648245, test_predictor: 1.2479351525005702
[INFO: 2020-09-08 07:47:36,928] mv_approxkl: 2.1278511450272272e-05
[INFO: 2020-09-08 07:47:36,928] beta: 0.5
[INFO: 2020-09-08 07:47:36,928] mv_viloate: 1
[INFO: 2020-09-08 07:48:43,055] x: 1.2828625078528375, y: 1.2827794365010754 @iteration 2272
[INFO: 2020-09-08 07:50:27,476] ######## Epoch (VAL) 2288 ########
[INFO: 2020-09-08 07:50:27,476] {'CIDEr': 1.243653830915588}
[INFO: 2020-09-08 07:51:27,754] test_current @iteration 2288: 1.2470467472188245, test_predictor: 1.2479351525005702
[INFO: 2020-09-08 07:51:27,754] mv_approxkl: 0.003941024762342611
[INFO: 2020-09-08 07:51:27,754] beta: 0.5
[INFO: 2020-09-08 07:51:27,754] mv_viloate: 1.1
[INFO: 2020-09-08 07:52:32,841] x: 1.2961996196816528, y: 1.2917565744171278 @iteration 2288
[INFO: 2020-09-08 07:52:32,842] update predictor @iteration 2288
[INFO: 2020-09-08 07:54:18,344] ######## Epoch (VAL) 2304 ########
[INFO: 2020-09-08 07:54:18,344] {'CIDEr': 1.2431481843216192}
[INFO: 2020-09-08 07:55:18,694] test_current @iteration 2304: 1.247789790507286, test_predictor: 1.2470467472188245
[INFO: 2020-09-08 07:55:18,695] mv_approxkl: 0.0023617731078851953
[INFO: 2020-09-08 07:55:18,695] beta: 0.5
[INFO: 2020-09-08 07:55:18,695] mv_viloate: 1
[INFO: 2020-09-08 07:56:23,998] x: 1.280797160842002, y: 1.2720915380503397 @iteration 2304
[INFO: 2020-09-08 07:56:23,999] update predictor @iteration 2304
[INFO: 2020-09-08 07:58:08,700] ######## Epoch (VAL) 2320 ########
[INFO: 2020-09-08 07:58:08,700] {'CIDEr': 1.2426118888759}
[INFO: 2020-09-08 07:59:09,113] test_current @iteration 2320: 1.2494696255798363, test_predictor: 1.247789790507286
[INFO: 2020-09-08 07:59:09,114] mv_approxkl: 0.0004376413250398627
[INFO: 2020-09-08 07:59:09,114] beta: 0.5
[INFO: 2020-09-08 07:59:09,114] mv_viloate: 1
[INFO: 2020-09-08 08:00:13,710] x: 1.2936977502657374, y: 1.2833127311863461 @iteration 2320
[INFO: 2020-09-08 08:00:13,710] update predictor @iteration 2320
[INFO: 2020-09-08 08:01:59,427] ######## Epoch (VAL) 2336 ########
[INFO: 2020-09-08 08:01:59,427] {'CIDEr': 1.2412253212799558}
[INFO: 2020-09-08 08:02:59,532] test_current @iteration 2336: 1.2502802301917564, test_predictor: 1.2494696255798363
[INFO: 2020-09-08 08:02:59,532] mv_approxkl: 8.109582107747368e-05
[INFO: 2020-09-08 08:02:59,532] beta: 0.5
[INFO: 2020-09-08 08:02:59,532] mv_viloate: 1
[INFO: 2020-09-08 08:04:04,447] x: 1.2742113489061477, y: 1.2813787494433382 @iteration 2336
[INFO: 2020-09-08 08:05:49,471] ######## Epoch (VAL) 2352 ########
[INFO: 2020-09-08 08:05:49,471] {'CIDEr': 1.2409967205340884}
[INFO: 2020-09-08 08:06:51,789] test_current @iteration 2352: 1.2480747129953107, test_predictor: 1.2494696255798363
[INFO: 2020-09-08 08:06:51,789] mv_approxkl: 0.00039558154897271797
[INFO: 2020-09-08 08:06:51,789] beta: 0.5
[INFO: 2020-09-08 08:06:51,790] mv_viloate: 1
[INFO: 2020-09-08 08:07:56,776] x: 1.287456029918072, y: 1.2823832891183522 @iteration 2352
[INFO: 2020-09-08 08:07:56,776] update predictor @iteration 2352
[INFO: 2020-09-08 08:09:41,401] ######## Epoch (VAL) 2368 ########
[INFO: 2020-09-08 08:09:41,401] {'CIDEr': 1.2414041244783758}
[INFO: 2020-09-08 08:10:42,519] test_current @iteration 2368: 1.2483182100327188, test_predictor: 1.2480747129953107
[INFO: 2020-09-08 08:10:42,519] mv_approxkl: 0.0003943327358075441
[INFO: 2020-09-08 08:10:42,519] beta: 0.5
[INFO: 2020-09-08 08:10:42,519] mv_viloate: 1
[INFO: 2020-09-08 08:11:47,656] x: 1.290326364307644, y: 1.2828603859981669 @iteration 2368
[INFO: 2020-09-08 08:11:47,656] update predictor @iteration 2368
[INFO: 2020-09-08 08:13:33,080] ######## Epoch (VAL) 2384 ########
[INFO: 2020-09-08 08:13:33,080] {'CIDEr': 1.2418304199633394}
[INFO: 2020-09-08 08:14:33,260] test_current @iteration 2384: 1.2487079298606374, test_predictor: 1.2483182100327188
[INFO: 2020-09-08 08:14:33,260] mv_approxkl: 7.307065205765584e-05
[INFO: 2020-09-08 08:14:33,260] beta: 0.5
[INFO: 2020-09-08 08:14:33,260] mv_viloate: 1
[INFO: 2020-09-08 08:15:38,830] x: 1.2895929471621923, y: 1.2918156910876686 @iteration 2384
[INFO: 2020-09-08 08:17:22,814] ######## Epoch (VAL) 2400 ########
[INFO: 2020-09-08 08:17:22,814] {'CIDEr': 1.2431748415686794}
[INFO: 2020-09-08 08:18:23,336] test_current @iteration 2400: 1.2502555383759995, test_predictor: 1.2483182100327188
[INFO: 2020-09-08 08:18:23,336] mv_approxkl: 1.3540139347540462e-05
[INFO: 2020-09-08 08:18:23,336] beta: 0.5
[INFO: 2020-09-08 08:18:23,336] mv_viloate: 1
[INFO: 2020-09-08 08:19:28,917] x: 1.2816180414389111, y: 1.2925564115539754 @iteration 2400
[INFO: 2020-09-08 08:21:13,988] ######## Epoch (VAL) 2416 ########
[INFO: 2020-09-08 08:21:13,988] {'CIDEr': 1.2408023829921502}
[INFO: 2020-09-08 08:22:14,551] test_current @iteration 2416: 1.2486247059432671, test_predictor: 1.2483182100327188
[INFO: 2020-09-08 08:22:14,551] mv_approxkl: 0.0008572826011263327
[INFO: 2020-09-08 08:22:14,551] beta: 0.5
[INFO: 2020-09-08 08:22:14,551] mv_viloate: 1.1
[INFO: 2020-09-08 08:23:19,869] x: 1.295545014578795, y: 1.2841625470161484 @iteration 2416
[INFO: 2020-09-08 08:23:19,869] update predictor @iteration 2416
[INFO: 2020-09-08 08:25:03,617] ######## Epoch (VAL) 2432 ########
[INFO: 2020-09-08 08:25:03,617] {'CIDEr': 1.2409449260077778}
[INFO: 2020-09-08 08:26:05,229] test_current @iteration 2432: 1.2479487299046843, test_predictor: 1.2486247059432671
[INFO: 2020-09-08 08:26:05,229] mv_approxkl: 0.00015885619674385151
[INFO: 2020-09-08 08:26:05,229] beta: 0.5
[INFO: 2020-09-08 08:26:05,229] mv_viloate: 1
[INFO: 2020-09-08 08:27:10,169] x: 1.2887988301952147, y: 1.2791072924410911 @iteration 2432
[INFO: 2020-09-08 08:27:10,169] update predictor @iteration 2432
[INFO: 2020-09-08 08:28:54,832] ######## Epoch (VAL) 2448 ########
[INFO: 2020-09-08 08:28:54,833] {'CIDEr': 1.2410114000992665}
[INFO: 2020-09-08 08:29:55,562] test_current @iteration 2448: 1.2471342229943518, test_predictor: 1.2479487299046843
[INFO: 2020-09-08 08:29:55,562] mv_approxkl: 2.9436373969057707e-05
[INFO: 2020-09-08 08:29:55,562] beta: 0.5
[INFO: 2020-09-08 08:29:55,562] mv_viloate: 1
[INFO: 2020-09-08 08:31:00,856] x: 1.270497451078319, y: 1.2833396852601644 @iteration 2448
[INFO: 2020-09-08 08:32:45,533] ######## Epoch (VAL) 2464 ########
[INFO: 2020-09-08 08:32:45,533] {'CIDEr': 1.2423663405492544}
[INFO: 2020-09-08 08:33:46,372] test_current @iteration 2464: 1.2491673910468228, test_predictor: 1.2479487299046843
[INFO: 2020-09-08 08:33:46,372] mv_approxkl: 0.00020271594398752526
[INFO: 2020-09-08 08:33:46,372] beta: 0.5
[INFO: 2020-09-08 08:33:46,372] mv_viloate: 1
[INFO: 2020-09-08 08:34:51,725] x: 1.2979378461040818, y: 1.293822834753599 @iteration 2464
[INFO: 2020-09-08 08:34:51,725] update predictor @iteration 2464
[INFO: 2020-09-08 08:36:35,935] ######## Epoch (VAL) 2480 ########
[INFO: 2020-09-08 08:36:35,935] {'CIDEr': 1.240329240335611}
[INFO: 2020-09-08 08:37:37,931] test_current @iteration 2480: 1.250830165637657, test_predictor: 1.2491673910468228
[INFO: 2020-09-08 08:37:37,932] mv_approxkl: 3.756367368110433e-05
[INFO: 2020-09-08 08:37:37,932] beta: 0.5
[INFO: 2020-09-08 08:37:37,932] mv_viloate: 1
[INFO: 2020-09-08 08:38:42,842] x: 1.2869993816687013, y: 1.2680194868786765 @iteration 2480
[INFO: 2020-09-08 08:38:42,843] update predictor @iteration 2480
[INFO: 2020-09-08 08:40:27,485] ######## Epoch (VAL) 2496 ########
[INFO: 2020-09-08 08:40:27,485] {'CIDEr': 1.240494629477345}
[INFO: 2020-09-08 08:41:27,937] test_current @iteration 2496: 1.251026524374526, test_predictor: 1.250830165637657
[INFO: 2020-09-08 08:41:27,937] mv_approxkl: 6.9606245698528914e-06
[INFO: 2020-09-08 08:41:27,937] beta: 0.5
[INFO: 2020-09-08 08:41:27,937] mv_viloate: 1
[INFO: 2020-09-08 08:42:33,143] x: 1.29253895833816, y: 1.2827763017535891 @iteration 2496
[INFO: 2020-09-08 08:42:33,144] update predictor @iteration 2496
[INFO: 2020-09-08 08:44:17,896] ######## Epoch (VAL) 2512 ########
[INFO: 2020-09-08 08:44:17,896] {'CIDEr': 1.2420341869026141}
[INFO: 2020-09-08 08:45:18,616] test_current @iteration 2512: 1.2506712666919493, test_predictor: 1.251026524374526
[INFO: 2020-09-08 08:45:18,616] mv_approxkl: 1.289817785495557e-06
[INFO: 2020-09-08 08:45:18,616] beta: 0.5
[INFO: 2020-09-08 08:45:18,616] mv_viloate: 1
[INFO: 2020-09-08 08:46:23,627] x: 1.2965233666752467, y: 1.2891078847708721 @iteration 2512
[INFO: 2020-09-08 08:46:23,627] update predictor @iteration 2512
[INFO: 2020-09-08 08:48:07,999] ######## Epoch (VAL) 2528 ########
[INFO: 2020-09-08 08:48:07,999] {'CIDEr': 1.2411076956094207}
[INFO: 2020-09-08 08:49:09,060] test_current @iteration 2528: 1.2496268785526659, test_predictor: 1.2506712666919493
[INFO: 2020-09-08 08:49:09,060] mv_approxkl: 2.390058396463441e-07
[INFO: 2020-09-08 08:49:09,060] beta: 0.5
[INFO: 2020-09-08 08:49:09,060] mv_viloate: 1
[INFO: 2020-09-08 08:50:16,359] x: 1.284994105139399, y: 1.2945605241948506 @iteration 2528
[INFO: 2020-09-08 08:52:01,766] ######## Epoch (VAL) 2544 ########
[INFO: 2020-09-08 08:52:01,767] {'CIDEr': 1.2406905904924699}
[INFO: 2020-09-08 08:53:02,642] test_current @iteration 2544: 1.2491530812184837, test_predictor: 1.2506712666919493
[INFO: 2020-09-08 08:53:02,642] mv_approxkl: 0.0007643961800234637
[INFO: 2020-09-08 08:53:02,642] beta: 0.5
[INFO: 2020-09-08 08:53:02,642] mv_viloate: 1
[INFO: 2020-09-08 08:54:07,138] x: 1.3264436023583772, y: 1.3087420332710529 @iteration 2544
[INFO: 2020-09-08 08:54:07,138] update predictor @iteration 2544
[INFO: 2020-09-08 08:55:52,873] ######## Epoch (VAL) 2560 ########
[INFO: 2020-09-08 08:55:52,873] {'CIDEr': 1.242959339138351}
[INFO: 2020-09-08 08:56:53,228] test_current @iteration 2560: 1.2496373322952605, test_predictor: 1.2491530812184837
[INFO: 2020-09-08 08:56:53,228] mv_approxkl: 0.00043467582189080024
[INFO: 2020-09-08 08:56:53,228] beta: 0.5
[INFO: 2020-09-08 08:56:53,228] mv_viloate: 1.0
[INFO: 2020-09-08 08:57:57,986] x: 1.3102836271173117, y: 1.3062409049573447 @iteration 2560
[INFO: 2020-09-08 08:57:57,987] update predictor @iteration 2560
[INFO: 2020-09-08 08:59:41,646] ######## Epoch (VAL) 2576 ########
[INFO: 2020-09-08 08:59:41,646] {'CIDEr': 1.2420875981147008}
[INFO: 2020-09-08 09:00:42,296] test_current @iteration 2576: 1.2516546457395923, test_predictor: 1.2496373322952605
[INFO: 2020-09-08 09:00:42,296] mv_approxkl: 8.054630735694202e-05
[INFO: 2020-09-08 09:00:42,296] beta: 0.5
[INFO: 2020-09-08 09:00:42,296] mv_viloate: 1
[INFO: 2020-09-08 09:01:46,832] x: 1.3017649885437035, y: 1.3036121183911948 @iteration 2576
[INFO: 2020-09-08 09:03:31,865] ######## Epoch (VAL) 2592 ########
[INFO: 2020-09-08 09:03:31,865] {'CIDEr': 1.243259515988787}
[INFO: 2020-09-08 09:04:32,604] test_current @iteration 2592: 1.2522284276615472, test_predictor: 1.2496373322952605
[INFO: 2020-09-08 09:04:32,604] mv_approxkl: 0.00015658815216472108
[INFO: 2020-09-08 09:04:32,604] beta: 0.5
[INFO: 2020-09-08 09:04:32,604] mv_viloate: 1
[INFO: 2020-09-08 09:05:37,530] x: 1.3164356326736415, y: 1.3053456924615119 @iteration 2592
[INFO: 2020-09-08 09:05:37,531] update predictor @iteration 2592
[INFO: 2020-09-08 09:07:20,982] ######## Epoch (VAL) 2608 ########
[INFO: 2020-09-08 09:07:20,982] {'CIDEr': 1.243436795210486}
[INFO: 2020-09-08 09:08:22,969] test_current @iteration 2608: 1.253760971214806, test_predictor: 1.2522284276615472
[INFO: 2020-09-08 09:08:22,969] mv_approxkl: 2.9016100729623235e-05
[INFO: 2020-09-08 09:08:22,969] beta: 0.5
[INFO: 2020-09-08 09:08:22,969] mv_viloate: 1
[INFO: 2020-09-08 09:09:28,433] x: 1.282313796469978, y: 1.2873491980582275 @iteration 2608
[INFO: 2020-09-08 09:11:13,260] ######## Epoch (VAL) 2624 ########
[INFO: 2020-09-08 09:11:13,260] {'CIDEr': 1.2434951400257568}
[INFO: 2020-09-08 09:12:13,955] test_current @iteration 2624: 1.2522960843919868, test_predictor: 1.2522284276615472
[INFO: 2020-09-08 09:12:13,955] mv_approxkl: 5.376742045375052e-06
[INFO: 2020-09-08 09:12:13,955] beta: 0.5
[INFO: 2020-09-08 09:12:13,955] mv_viloate: 1
[INFO: 2020-09-08 09:13:21,036] x: 1.3083831330833604, y: 1.2933870406052768 @iteration 2624
[INFO: 2020-09-08 09:13:21,036] update predictor @iteration 2624
[INFO: 2020-09-08 09:15:06,356] ######## Epoch (VAL) 2640 ########
[INFO: 2020-09-08 09:15:06,356] {'CIDEr': 1.244015239217183}
[INFO: 2020-09-08 09:16:06,549] test_current @iteration 2640: 1.252455460974042, test_predictor: 1.2522960843919868
[INFO: 2020-09-08 09:16:06,549] mv_approxkl: 9.96321156032852e-07
[INFO: 2020-09-08 09:16:06,549] beta: 0.5
[INFO: 2020-09-08 09:16:06,549] mv_viloate: 1
[INFO: 2020-09-08 09:17:11,105] x: 1.3224502120267068, y: 1.336809863527899 @iteration 2640
[INFO: 2020-09-08 09:18:55,882] ######## Epoch (VAL) 2656 ########
[INFO: 2020-09-08 09:18:55,882] {'CIDEr': 1.2462672678697575}
[INFO: 2020-09-08 09:19:57,957] test_current @iteration 2656: 1.2527462995528422, test_predictor: 1.2522960843919868
[INFO: 2020-09-08 09:19:57,957] mv_approxkl: 1.8462032167090803e-07
[INFO: 2020-09-08 09:19:57,957] beta: 0.5
[INFO: 2020-09-08 09:19:57,957] mv_viloate: 1
[INFO: 2020-09-08 09:21:04,141] x: 1.2940439134793034, y: 1.2997812827892319 @iteration 2656
[INFO: 2020-09-08 09:22:50,548] ######## Epoch (VAL) 2672 ########
[INFO: 2020-09-08 09:22:50,548] {'CIDEr': 1.247398123889399}
[INFO: 2020-09-08 09:23:51,644] test_current @iteration 2672: 1.2525262160456718, test_predictor: 1.2522960843919868
[INFO: 2020-09-08 09:23:51,644] mv_approxkl: 0.00014653048850230268
[INFO: 2020-09-08 09:23:51,644] beta: 0.5
[INFO: 2020-09-08 09:23:51,644] mv_viloate: 1
[INFO: 2020-09-08 09:24:57,924] x: 1.3249635899056469, y: 1.3049302118346893 @iteration 2672
[INFO: 2020-09-08 09:24:57,924] update predictor @iteration 2672
[INFO: 2020-09-08 09:26:42,825] ######## Epoch (VAL) 2688 ########
[INFO: 2020-09-08 09:26:42,825] {'CIDEr': 1.2470973406690897}
[INFO: 2020-09-08 09:27:45,474] test_current @iteration 2688: 1.2519989205394642, test_predictor: 1.2525262160456718
[INFO: 2020-09-08 09:27:45,474] mv_approxkl: 2.7152395347708953e-05
[INFO: 2020-09-08 09:27:45,474] beta: 0.5
[INFO: 2020-09-08 09:27:45,474] mv_viloate: 1
[INFO: 2020-09-08 09:28:52,345] x: 1.284943750777922, y: 1.2923380583485093 @iteration 2688
[INFO: 2020-09-08 09:30:36,709] ######## Epoch (VAL) 2704 ########
[INFO: 2020-09-08 09:30:36,710] {'CIDEr': 1.2467963874521095}
[INFO: 2020-09-08 09:31:38,252] test_current @iteration 2704: 1.251434000132572, test_predictor: 1.2525262160456718
[INFO: 2020-09-08 09:31:38,252] mv_approxkl: 0.0003803638569352381
[INFO: 2020-09-08 09:31:38,252] beta: 0.5
[INFO: 2020-09-08 09:31:38,252] mv_viloate: 1.0
[INFO: 2020-09-08 09:32:44,184] x: 1.3290942907654688, y: 1.3221618523146328 @iteration 2704
[INFO: 2020-09-08 09:32:44,184] update predictor @iteration 2704
[INFO: 2020-09-08 09:34:30,737] ######## Epoch (VAL) 2720 ########
[INFO: 2020-09-08 09:34:30,737] {'CIDEr': 1.244850097874327}
[INFO: 2020-09-08 09:35:32,380] test_current @iteration 2720: 1.251267573791855, test_predictor: 1.251434000132572
[INFO: 2020-09-08 09:35:32,380] mv_approxkl: 7.048219060105497e-05
[INFO: 2020-09-08 09:35:32,380] beta: 0.5
[INFO: 2020-09-08 09:35:32,380] mv_viloate: 1
[INFO: 2020-09-08 09:36:36,897] x: 1.3201572351946915, y: 1.317529258479204 @iteration 2720
[INFO: 2020-09-08 09:36:36,898] update predictor @iteration 2720
[INFO: 2020-09-08 09:38:20,680] ######## Epoch (VAL) 2736 ########
[INFO: 2020-09-08 09:38:20,681] {'CIDEr': 1.2443134446654913}
[INFO: 2020-09-08 09:39:22,769] test_current @iteration 2736: 1.2526380905270336, test_predictor: 1.251267573791855
[INFO: 2020-09-08 09:39:22,770] mv_approxkl: 1.3060492213825837e-05
[INFO: 2020-09-08 09:39:22,770] beta: 0.5
[INFO: 2020-09-08 09:39:22,770] mv_viloate: 1
[INFO: 2020-09-08 09:40:27,823] x: 1.3174989919163067, y: 1.3062983452455235 @iteration 2736
[INFO: 2020-09-08 09:40:27,824] update predictor @iteration 2736
[INFO: 2020-09-08 09:42:13,169] ######## Epoch (VAL) 2752 ########
[INFO: 2020-09-08 09:42:13,169] {'CIDEr': 1.2430507948474496}
[INFO: 2020-09-08 09:43:14,564] test_current @iteration 2752: 1.253364208094874, test_predictor: 1.2526380905270336
[INFO: 2020-09-08 09:43:14,564] mv_approxkl: 2.4201355748561555e-06
[INFO: 2020-09-08 09:43:14,564] beta: 0.5
[INFO: 2020-09-08 09:43:14,564] mv_viloate: 1
[INFO: 2020-09-08 09:44:20,074] x: 1.3056553918264098, y: 1.3114154284020751 @iteration 2752
[INFO: 2020-09-08 09:46:06,473] ######## Epoch (VAL) 2768 ########
[INFO: 2020-09-08 09:46:06,473] {'CIDEr': 1.2424910728893608}
[INFO: 2020-09-08 09:47:08,017] test_current @iteration 2768: 1.2543324111723677, test_predictor: 1.2526380905270336
[INFO: 2020-09-08 09:47:08,017] mv_approxkl: 4.484560079967013e-07
[INFO: 2020-09-08 09:47:08,017] beta: 0.5
[INFO: 2020-09-08 09:47:08,017] mv_viloate: 1
[INFO: 2020-09-08 09:48:12,243] x: 1.3157265488629764, y: 1.3098913189714534 @iteration 2768
[INFO: 2020-09-08 09:48:12,244] update predictor @iteration 2768
[INFO: 2020-09-08 09:49:57,841] ######## Epoch (VAL) 2784 ########
[INFO: 2020-09-08 09:49:57,841] {'CIDEr': 1.2435403951522443}
[INFO: 2020-09-08 09:50:59,472] test_current @iteration 2784: 1.255921060120785, test_predictor: 1.2543324111723677
[INFO: 2020-09-08 09:50:59,472] mv_approxkl: 0.00047902421470243404
[INFO: 2020-09-08 09:50:59,472] beta: 0.5
[INFO: 2020-09-08 09:50:59,473] mv_viloate: 1
[INFO: 2020-09-08 09:52:04,381] x: 1.3049906804472158, y: 1.318794869684474 @iteration 2784
[INFO: 2020-09-08 09:53:50,602] ######## Epoch (VAL) 2800 ########
[INFO: 2020-09-08 09:53:50,602] {'CIDEr': 1.2426040183150437}
[INFO: 2020-09-08 09:54:51,996] test_current @iteration 2800: 1.25571888044975, test_predictor: 1.2543324111723677
[INFO: 2020-09-08 09:54:51,996] mv_approxkl: 0.00034077754209649975
[INFO: 2020-09-08 09:54:51,996] beta: 0.5
[INFO: 2020-09-08 09:54:51,996] mv_viloate: 1
[INFO: 2020-09-08 09:55:57,380] x: 1.3297518147115484, y: 1.3330547027643518 @iteration 2800
[INFO: 2020-09-08 09:57:41,624] ######## Epoch (VAL) 2816 ########
[INFO: 2020-09-08 09:57:41,624] {'CIDEr': 1.2440103097138788}
[INFO: 2020-09-08 09:58:43,980] test_current @iteration 2816: 1.2538255947055557, test_predictor: 1.2543324111723677
[INFO: 2020-09-08 09:58:43,980] mv_approxkl: 0.0015740030630243592
[INFO: 2020-09-08 09:58:43,980] beta: 0.5
[INFO: 2020-09-08 09:58:43,980] mv_viloate: 1.1
[INFO: 2020-09-08 09:59:48,973] x: 1.3082565347088737, y: 1.324218380137856 @iteration 2816
[INFO: 2020-09-08 10:01:33,782] ######## Epoch (VAL) 2832 ########
[INFO: 2020-09-08 10:01:33,783] {'CIDEr': 1.2429930722096092}
[INFO: 2020-09-08 10:02:35,279] test_current @iteration 2832: 1.2553467533092793, test_predictor: 1.2543324111723677
[INFO: 2020-09-08 10:02:35,279] mv_approxkl: 0.05776077573378448
[INFO: 2020-09-08 10:02:35,279] beta: 8.0
[INFO: 2020-09-08 10:02:35,279] mv_viloate: 4.4273029840453
[INFO: 2020-09-08 10:03:40,859] x: 1.319458058729507, y: 1.329557299024815 @iteration 2832
[INFO: 2020-09-08 10:05:26,189] ######## Epoch (VAL) 2848 ########
[INFO: 2020-09-08 10:05:26,189] {'CIDEr': 1.2416051942914452}
[INFO: 2020-09-08 10:06:27,755] test_current @iteration 2848: 1.2518887954690425, test_predictor: 1.2543324111723677
[INFO: 2020-09-08 10:06:27,755] mv_approxkl: 0.070570671003183
[INFO: 2020-09-08 10:06:27,755] beta: 100
[INFO: 2020-09-08 10:06:27,755] mv_viloate: 15.53291546044775
[INFO: 2020-09-08 10:07:33,859] x: 1.3400407270346069, y: 1.3383876521270706 @iteration 2848
[INFO: 2020-09-08 10:07:33,859] update predictor @iteration 2848
[INFO: 2020-09-08 10:09:19,552] ######## Epoch (VAL) 2864 ########
[INFO: 2020-09-08 10:09:19,553] {'CIDEr': 1.2375095729800631}
[INFO: 2020-09-08 10:10:22,327] test_current @iteration 2864: 1.243252883075223, test_predictor: 1.2518887954690425
[INFO: 2020-09-08 10:10:22,327] mv_approxkl: 0.044588473912315685
[INFO: 2020-09-08 10:10:22,327] beta: 50.0
[INFO: 2020-09-08 10:10:22,327] mv_viloate: 21.14540036596136
[INFO: 2020-09-08 10:11:27,296] x: 1.3012789851195503, y: 1.3093758439002496 @iteration 2864
[INFO: 2020-09-08 10:13:12,168] ######## Epoch (VAL) 2880 ########
[INFO: 2020-09-08 10:13:12,169] {'CIDEr': 1.2417338721765776}
[INFO: 2020-09-08 10:14:13,528] test_current @iteration 2880: 1.249303512859904, test_predictor: 1.2518887954690425
[INFO: 2020-09-08 10:14:13,528] mv_approxkl: 0.07905863009484797
[INFO: 2020-09-08 10:14:13,528] beta: 100
[INFO: 2020-09-08 10:14:13,528] mv_viloate: 21.950737458300914
[INFO: 2020-09-08 10:15:18,254] x: 1.3210785476778708, y: 1.3241590012048425 @iteration 2880
[INFO: 2020-09-08 10:17:04,315] ######## Epoch (VAL) 2896 ########
[INFO: 2020-09-08 10:17:04,315] {'CIDEr': 1.240293782945573}
[INFO: 2020-09-08 10:18:05,773] test_current @iteration 2896: 1.2516217734184492, test_predictor: 1.2518887954690425
[INFO: 2020-09-08 10:18:05,773] mv_approxkl: 0.0632822289898889
[INFO: 2020-09-08 10:18:05,773] beta: 100
[INFO: 2020-09-08 10:18:05,773] mv_viloate: 27.98729946880809
[INFO: 2020-09-08 10:19:09,810] x: 1.3350265492201265, y: 1.3377124035473527 @iteration 2896
[INFO: 2020-09-08 10:20:54,402] ######## Epoch (VAL) 2912 ########
[INFO: 2020-09-08 10:20:54,402] {'CIDEr': 1.235627784856374}
[INFO: 2020-09-08 10:21:55,783] test_current @iteration 2912: 1.2465887845823813, test_predictor: 1.2518887954690425
[INFO: 2020-09-08 10:21:55,784] mv_approxkl: 0.050543005105835176
[INFO: 2020-09-08 10:21:55,784] beta: 100.0
[INFO: 2020-09-08 10:21:55,784] mv_viloate: 33.00162565016961
[INFO: 2020-09-08 10:23:01,109] x: 1.3322813613800468, y: 1.3533772347124882 @iteration 2912
[INFO: 2020-09-08 10:24:47,036] ######## Epoch (VAL) 2928 ########
[INFO: 2020-09-08 10:24:47,036] {'CIDEr': 1.2394825315065374}
[INFO: 2020-09-08 10:25:48,077] test_current @iteration 2928: 1.2457539514290092, test_predictor: 1.2518887954690425
[INFO: 2020-09-08 10:25:48,078] mv_approxkl: 0.04664371172862863
[INFO: 2020-09-08 10:25:48,078] beta: 25.0
[INFO: 2020-09-08 10:25:48,078] mv_viloate: 33.42341570953452
[INFO: 2020-09-08 10:26:53,278] x: 1.3067977213424116, y: 1.3169147082775359 @iteration 2928
[INFO: 2020-09-08 10:26:53,340] reload model @iteration 2928
[INFO: 2020-09-08 10:28:38,542] ######## Epoch (VAL) 2944 ########
[INFO: 2020-09-08 10:28:38,542] {'CIDEr': 1.2411877087211756}
[INFO: 2020-09-08 10:29:41,267] test_current @iteration 2944: 1.251368312590598, test_predictor: 1.2518887954690425
[INFO: 2020-09-08 10:29:41,267] mv_approxkl: 0.0098569750077258
[INFO: 2020-09-08 10:29:41,267] beta: 0.5
[INFO: 2020-09-08 10:29:41,267] mv_viloate: 7.397423070233526
[INFO: 2020-09-08 10:30:46,212] x: 1.2858707026583334, y: 1.2948103977554393 @iteration 2944
[INFO: 2020-09-08 10:32:30,774] ######## Epoch (VAL) 2960 ########
[INFO: 2020-09-08 10:32:30,774] {'CIDEr': 1.24150672865469}
[INFO: 2020-09-08 10:33:31,797] test_current @iteration 2960: 1.2503142600230668, test_predictor: 1.2518887954690425
[INFO: 2020-09-08 10:33:31,797] mv_approxkl: 0.0138462542934234
[INFO: 2020-09-08 10:33:31,797] beta: 0.5
[INFO: 2020-09-08 10:33:31,797] mv_viloate: 4.541804626597599
[INFO: 2020-09-08 10:34:21,857] Training with config:
[INFO: 2020-09-08 10:34:21,859] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 10:36:38,946] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 10:36:38,946] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 10:36:38,948] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:39:26,335] ######## Iter (TEST) 16 ########
[INFO: 2020-09-08 10:39:26,335] {'CIDEr': 1.3253163200688525}
[INFO: 2020-09-08 10:39:26,337] val_current @iteration 16: 1.3127200194805286, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:39:26,337] mv_approxkl: 0.056888768420633146
[INFO: 2020-09-08 10:39:26,337] beta: 2.0
[INFO: 2020-09-08 10:39:26,337] mv_viloate: 3.633769552535001
[INFO: 2020-09-08 10:42:12,442] ######## Iter (TEST) 32 ########
[INFO: 2020-09-08 10:42:12,442] {'CIDEr': 1.3248558521482052}
[INFO: 2020-09-08 10:42:12,444] val_current @iteration 32: 1.3136841102736088, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:42:12,444] mv_approxkl: 0.10829880677148374
[INFO: 2020-09-08 10:42:12,444] beta: 2.0
[INFO: 2020-09-08 10:42:12,444] mv_viloate: 4.859303370942916
[INFO: 2020-09-08 10:44:58,958] ######## Iter (TEST) 48 ########
[INFO: 2020-09-08 10:44:58,958] {'CIDEr': 1.3273206656678422}
[INFO: 2020-09-08 10:44:58,960] val_current @iteration 48: 1.31350108944058, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:44:58,960] mv_approxkl: 0.08478728956264975
[INFO: 2020-09-08 10:44:58,960] beta: 32.0
[INFO: 2020-09-08 10:44:58,960] mv_viloate: 6.997304038121579
[INFO: 2020-09-08 10:47:44,539] ######## Iter (TEST) 64 ########
[INFO: 2020-09-08 10:47:44,540] {'CIDEr': 1.328403790465205}
[INFO: 2020-09-08 10:47:44,541] val_current @iteration 64: 1.3107517992056161, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:47:44,542] mv_approxkl: 0.15145959082369498
[INFO: 2020-09-08 10:47:44,542] beta: 100
[INFO: 2020-09-08 10:47:44,542] mv_viloate: 10.600334877244894
[INFO: 2020-09-08 10:50:30,316] ######## Iter (TEST) 80 ########
[INFO: 2020-09-08 10:50:30,317] {'CIDEr': 1.326063023884639}
[INFO: 2020-09-08 10:50:30,318] val_current @iteration 80: 1.3131299093103534, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:50:30,318] mv_approxkl: 0.13009518568778858
[INFO: 2020-09-08 10:50:30,318] beta: 50.0
[INFO: 2020-09-08 10:50:30,318] mv_viloate: 12.414581409300517
[INFO: 2020-09-08 10:50:30,383] reload model @iteration 80
[INFO: 2020-09-08 10:53:16,495] ######## Iter (TEST) 96 ########
[INFO: 2020-09-08 10:53:16,495] {'CIDEr': 1.3272374206469195}
[INFO: 2020-09-08 10:53:16,497] val_current @iteration 96: 1.3141498961648277, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:53:16,497] mv_approxkl: 0.06193021130646851
[INFO: 2020-09-08 10:53:16,497] beta: 1.0
[INFO: 2020-09-08 10:53:16,497] mv_viloate: 4.59773580279574
[INFO: 2020-09-08 10:56:01,288] ######## Iter (TEST) 112 ########
[INFO: 2020-09-08 10:56:01,289] {'CIDEr': 1.327011641471204}
[INFO: 2020-09-08 10:56:01,291] val_current @iteration 112: 1.3136725623355903, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:56:01,291] mv_approxkl: 0.07398544787454318
[INFO: 2020-09-08 10:56:01,291] beta: 25.0
[INFO: 2020-09-08 10:56:01,291] mv_viloate: 4.438035737082305
[INFO: 2020-09-08 10:58:48,626] ######## Iter (TEST) 128 ########
[INFO: 2020-09-08 10:58:48,626] {'CIDEr': 1.3282260956733365}
[INFO: 2020-09-08 10:58:48,628] val_current @iteration 128: 1.3140896082661655, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 10:58:48,628] mv_approxkl: 0.1030251044410678
[INFO: 2020-09-08 10:58:48,628] beta: 4.0
[INFO: 2020-09-08 10:58:48,628] mv_viloate: 4.645994485588438
[INFO: 2020-09-08 11:01:35,325] ######## Iter (TEST) 144 ########
[INFO: 2020-09-08 11:01:35,325] {'CIDEr': 1.3287563510078468}
[INFO: 2020-09-08 11:01:35,327] val_current @iteration 144: 1.3131238998704686, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:01:35,327] mv_approxkl: 0.120912418784243
[INFO: 2020-09-08 11:01:35,327] beta: 32.0
[INFO: 2020-09-08 11:01:35,327] mv_viloate: 5.724546244939395
[INFO: 2020-09-08 11:04:22,146] ######## Iter (TEST) 160 ########
[INFO: 2020-09-08 11:04:22,146] {'CIDEr': 1.3283578237151066}
[INFO: 2020-09-08 11:04:22,148] val_current @iteration 160: 1.3119500972415026, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:04:22,148] mv_approxkl: 0.1774931747842519
[INFO: 2020-09-08 11:04:22,148] beta: 1.0
[INFO: 2020-09-08 11:04:22,148] mv_viloate: 5.7986093076358225
[INFO: 2020-09-08 11:04:22,212] reload model @iteration 160
[INFO: 2020-09-08 11:07:08,617] ######## Iter (TEST) 176 ########
[INFO: 2020-09-08 11:07:08,617] {'CIDEr': 1.3282292748594657}
[INFO: 2020-09-08 11:07:08,619] val_current @iteration 176: 1.3130165546422916, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:07:08,619] mv_approxkl: 0.03288984362586274
[INFO: 2020-09-08 11:07:08,619] beta: 0.5
[INFO: 2020-09-08 11:07:08,619] mv_viloate: 1.0744940114313382
[INFO: 2020-09-08 11:09:54,092] ######## Iter (TEST) 192 ########
[INFO: 2020-09-08 11:09:54,092] {'CIDEr': 1.328196847249512}
[INFO: 2020-09-08 11:09:54,094] val_current @iteration 192: 1.3128793266639287, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:09:54,094] mv_approxkl: 0.007865223070727513
[INFO: 2020-09-08 11:09:54,094] beta: 0.5
[INFO: 2020-09-08 11:09:54,094] mv_viloate: 1
[INFO: 2020-09-08 11:12:41,374] ######## Iter (TEST) 208 ########
[INFO: 2020-09-08 11:12:41,374] {'CIDEr': 1.3282281702452008}
[INFO: 2020-09-08 11:12:41,376] val_current @iteration 208: 1.3126953657139122, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:12:41,376] mv_approxkl: 0.002149406246795605
[INFO: 2020-09-08 11:12:41,376] beta: 0.5
[INFO: 2020-09-08 11:12:41,376] mv_viloate: 1
[INFO: 2020-09-08 11:15:28,539] ######## Iter (TEST) 224 ########
[INFO: 2020-09-08 11:15:28,539] {'CIDEr': 1.3283040677706748}
[INFO: 2020-09-08 11:15:28,541] val_current @iteration 224: 1.3128057761101526, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:15:28,541] mv_approxkl: 0.015156979006246185
[INFO: 2020-09-08 11:15:28,541] beta: 0.5
[INFO: 2020-09-08 11:15:28,541] mv_viloate: 1
[INFO: 2020-09-08 11:18:15,013] ######## Iter (TEST) 240 ########
[INFO: 2020-09-08 11:18:15,013] {'CIDEr': 1.3281957138879465}
[INFO: 2020-09-08 11:18:15,015] val_current @iteration 240: 1.313115868707575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:18:15,015] mv_approxkl: 0.004877638933390511
[INFO: 2020-09-08 11:18:15,015] beta: 0.5
[INFO: 2020-09-08 11:18:15,015] mv_viloate: 1
[INFO: 2020-09-08 11:18:15,078] reload model @iteration 240
[INFO: 2020-09-08 11:21:02,455] ######## Iter (TEST) 256 ########
[INFO: 2020-09-08 11:21:02,456] {'CIDEr': 1.3275423734456602}
[INFO: 2020-09-08 11:21:02,458] val_current @iteration 256: 1.313730002546648, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:21:02,458] mv_approxkl: 0.000903836341750238
[INFO: 2020-09-08 11:21:02,458] beta: 0.5
[INFO: 2020-09-08 11:21:02,458] mv_viloate: 1
[INFO: 2020-09-08 11:23:48,890] ######## Iter (TEST) 272 ########
[INFO: 2020-09-08 11:23:48,890] {'CIDEr': 1.3275447096143018}
[INFO: 2020-09-08 11:23:48,892] val_current @iteration 272: 1.313594152617644, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:23:48,892] mv_approxkl: 0.00016748269886811837
[INFO: 2020-09-08 11:23:48,892] beta: 0.5
[INFO: 2020-09-08 11:23:48,892] mv_viloate: 1
[INFO: 2020-09-08 11:24:54,823] Training with config:
[INFO: 2020-09-08 11:24:54,825] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 11:27:12,013] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 11:27:12,013] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 11:27:12,015] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:29:58,019] ######## Iter (TEST) 16 ########
[INFO: 2020-09-08 11:29:58,019] {'CIDEr': 1.325165325110178}
[INFO: 2020-09-08 11:29:58,021] val_current @iteration 16: 1.3138509486494434, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:29:58,021] mv_approxkl: 0.12496423451270407
[INFO: 2020-09-08 11:29:58,021] beta: 8.0
[INFO: 2020-09-08 11:29:58,021] mv_viloate: 5.524500273044001
[INFO: 2020-09-08 11:32:43,435] ######## Iter (TEST) 32 ########
[INFO: 2020-09-08 11:32:43,435] {'CIDEr': 1.326798341271774}
[INFO: 2020-09-08 11:32:43,437] val_current @iteration 32: 1.3130064319892005, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:32:43,437] mv_approxkl: 0.06292975175426552
[INFO: 2020-09-08 11:32:43,437] beta: 8.0
[INFO: 2020-09-08 11:32:43,437] mv_viloate: 7.374776298795646
[INFO: 2020-09-08 11:35:30,194] ######## Iter (TEST) 48 ########
[INFO: 2020-09-08 11:35:30,194] {'CIDEr': 1.325885572449221}
[INFO: 2020-09-08 11:35:30,196] val_current @iteration 48: 1.3107903416119469, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:35:30,196] mv_approxkl: 0.07055212169079221
[INFO: 2020-09-08 11:35:30,196] beta: 50.0
[INFO: 2020-09-08 11:35:30,196] mv_viloate: 11.62404499320279
[INFO: 2020-09-08 11:38:16,914] ######## Iter (TEST) 64 ########
[INFO: 2020-09-08 11:38:16,915] {'CIDEr': 1.3264781147781455}
[INFO: 2020-09-08 11:38:16,916] val_current @iteration 64: 1.3117088553689134, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:38:16,917] mv_approxkl: 0.12292485087143822
[INFO: 2020-09-08 11:38:16,917] beta: 100
[INFO: 2020-09-08 11:38:16,917] mv_viloate: 18.206264109982342
[INFO: 2020-09-08 11:41:03,640] ######## Iter (TEST) 80 ########
[INFO: 2020-09-08 11:41:03,640] {'CIDEr': 1.3262047582270686}
[INFO: 2020-09-08 11:41:03,642] val_current @iteration 80: 1.3138378259206414, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:41:03,642] mv_approxkl: 0.079761166337392
[INFO: 2020-09-08 11:41:03,642] beta: 50.0
[INFO: 2020-09-08 11:41:03,642] mv_viloate: 17.380465375487443
[INFO: 2020-09-08 11:41:03,706] reload model @iteration 80
[INFO: 2020-09-08 11:43:50,076] ######## Iter (TEST) 96 ########
[INFO: 2020-09-08 11:43:50,076] {'CIDEr': 1.32784177645884}
[INFO: 2020-09-08 11:43:50,078] val_current @iteration 96: 1.3142749142768002, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:43:50,078] mv_approxkl: 0.03448154020891158
[INFO: 2020-09-08 11:43:50,078] beta: 2.0
[INFO: 2020-09-08 11:43:50,078] mv_viloate: 6.215305557741864
[INFO: 2020-09-08 11:46:35,532] ######## Iter (TEST) 112 ########
[INFO: 2020-09-08 11:46:35,533] {'CIDEr': 1.3273896853496445}
[INFO: 2020-09-08 11:46:35,535] val_current @iteration 112: 1.3138133249994175, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:46:35,535] mv_approxkl: 0.049710715822057036
[INFO: 2020-09-08 11:46:35,535] beta: 4.0
[INFO: 2020-09-08 11:46:35,535] mv_viloate: 7.529731800095285
[INFO: 2020-09-08 11:49:22,106] ######## Iter (TEST) 128 ########
[INFO: 2020-09-08 11:49:22,107] {'CIDEr': 1.3256854106062514}
[INFO: 2020-09-08 11:49:22,109] val_current @iteration 128: 1.3137107140575102, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:49:22,109] mv_approxkl: 0.09986122305496514
[INFO: 2020-09-08 11:49:22,109] beta: 64.0
[INFO: 2020-09-08 11:49:22,109] mv_viloate: 11.35975144718138
[INFO: 2020-09-08 11:52:07,458] ######## Iter (TEST) 144 ########
[INFO: 2020-09-08 11:52:07,458] {'CIDEr': 1.3227227825569747}
[INFO: 2020-09-08 11:52:07,460] val_current @iteration 144: 1.3118017009882748, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:52:07,460] mv_approxkl: 0.09725541626269418
[INFO: 2020-09-08 11:52:07,460] beta: 100
[INFO: 2020-09-08 11:52:07,460] mv_viloate: 14.638568166274368
[INFO: 2020-09-08 11:54:53,844] ######## Iter (TEST) 160 ########
[INFO: 2020-09-08 11:54:53,844] {'CIDEr': 1.3244427991929275}
[INFO: 2020-09-08 11:54:53,847] val_current @iteration 160: 1.3127616897851695, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:54:53,848] mv_approxkl: 0.07758428603389814
[INFO: 2020-09-08 11:54:53,848] beta: 100
[INFO: 2020-09-08 11:54:53,848] mv_viloate: 14.454708629590357
[INFO: 2020-09-08 11:54:53,912] reload model @iteration 160
[INFO: 2020-09-08 11:57:40,508] ######## Iter (TEST) 176 ########
[INFO: 2020-09-08 11:57:40,508] {'CIDEr': 1.3269937094503734}
[INFO: 2020-09-08 11:57:40,510] val_current @iteration 176: 1.3147333363419225, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 11:57:40,510] mv_approxkl: 0.03690617139061726
[INFO: 2020-09-08 11:57:40,510] beta: 1.0
[INFO: 2020-09-08 11:57:40,510] mv_viloate: 7.461909397500186
[INFO: 2020-09-08 11:57:40,510] update predictor @iteration 176
[INFO: 2020-09-08 12:00:26,507] ######## Iter (TEST) 192 ########
[INFO: 2020-09-08 12:00:26,507] {'CIDEr': 1.3268013018063578}
[INFO: 2020-09-08 12:00:26,509] val_current @iteration 192: 1.314408768057777, val_predictor: 1.3147333363419225
[INFO: 2020-09-08 12:00:26,509] mv_approxkl: 0.033263149780193166
[INFO: 2020-09-08 12:00:26,509] beta: 1.0
[INFO: 2020-09-08 12:00:26,509] mv_viloate: 3.6560558870951136
[INFO: 2020-09-08 12:03:13,914] ######## Iter (TEST) 208 ########
[INFO: 2020-09-08 12:03:13,914] {'CIDEr': 1.326814804191599}
[INFO: 2020-09-08 12:03:13,916] val_current @iteration 208: 1.3173517176717406, val_predictor: 1.3147333363419225
[INFO: 2020-09-08 12:03:13,916] mv_approxkl: 0.09101513796903743
[INFO: 2020-09-08 12:03:13,916] beta: 4.0
[INFO: 2020-09-08 12:03:13,916] mv_viloate: 8.284136090179466
[INFO: 2020-09-08 12:03:13,916] update predictor @iteration 208
[INFO: 2020-09-08 12:06:01,054] ######## Iter (TEST) 224 ########
[INFO: 2020-09-08 12:06:01,054] {'CIDEr': 1.325098497757972}
[INFO: 2020-09-08 12:06:01,056] val_current @iteration 224: 1.317250055139128, val_predictor: 1.3173517176717406
[INFO: 2020-09-08 12:06:01,056] mv_approxkl: 0.033454856855480664
[INFO: 2020-09-08 12:06:01,056] beta: 0.5
[INFO: 2020-09-08 12:06:01,056] mv_viloate: 3.859951518758872
[INFO: 2020-09-08 12:08:47,465] ######## Iter (TEST) 240 ########
[INFO: 2020-09-08 12:08:47,465] {'CIDEr': 1.3256979772584228}
[INFO: 2020-09-08 12:08:47,467] val_current @iteration 240: 1.315018337413946, val_predictor: 1.3173517176717406
[INFO: 2020-09-08 12:08:47,467] mv_approxkl: 0.040159070626841556
[INFO: 2020-09-08 12:08:47,467] beta: 16.0
[INFO: 2020-09-08 12:08:47,467] mv_viloate: 6.886709783477542
[INFO: 2020-09-08 12:10:52,899] Training with config:
[INFO: 2020-09-08 12:10:52,901] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 12:13:10,334] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 12:13:10,335] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 12:13:10,337] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:15:56,479] ######## Iter (TEST) 16 ########
[INFO: 2020-09-08 12:15:56,479] {'CIDEr': 1.3253049956573664}
[INFO: 2020-09-08 12:15:56,481] val_current @iteration 16: 1.3144386029142257, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:15:56,481] mv_approxkl: 0.06768696291513858
[INFO: 2020-09-08 12:15:56,481] beta: 64.0
[INFO: 2020-09-08 12:15:56,481] mv_viloate: 4.058030505258001
[INFO: 2020-09-08 12:18:42,598] ######## Iter (TEST) 32 ########
[INFO: 2020-09-08 12:18:42,598] {'CIDEr': 1.3270575557187712}
[INFO: 2020-09-08 12:18:42,600] val_current @iteration 32: 1.3142764901674144, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:18:42,600] mv_approxkl: 0.06088551540183751
[INFO: 2020-09-08 12:18:42,600] beta: 50.0
[INFO: 2020-09-08 12:18:42,600] mv_viloate: 6.344694477416487
[INFO: 2020-09-08 12:21:28,748] ######## Iter (TEST) 48 ########
[INFO: 2020-09-08 12:21:28,748] {'CIDEr': 1.326200680737677}
[INFO: 2020-09-08 12:21:28,750] val_current @iteration 48: 1.3124865156660537, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:21:28,750] mv_approxkl: 0.07841052670575163
[INFO: 2020-09-08 12:21:28,750] beta: 100
[INFO: 2020-09-08 12:21:28,750] mv_viloate: 10.738880755676611
[INFO: 2020-09-08 12:24:14,726] ######## Iter (TEST) 64 ########
[INFO: 2020-09-08 12:24:14,726] {'CIDEr': 1.3245240244828227}
[INFO: 2020-09-08 12:24:14,728] val_current @iteration 64: 1.3118557272975944, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:24:14,728] mv_approxkl: 0.13760039067472632
[INFO: 2020-09-08 12:24:14,728] beta: 100
[INFO: 2020-09-08 12:24:14,728] mv_viloate: 17.904189804552534
[INFO: 2020-09-08 12:27:01,108] ######## Iter (TEST) 80 ########
[INFO: 2020-09-08 12:27:01,109] {'CIDEr': 1.326772016723433}
[INFO: 2020-09-08 12:27:01,110] val_current @iteration 80: 1.3126406238515524, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:27:01,111] mv_approxkl: 0.07415855712715275
[INFO: 2020-09-08 12:27:01,111] beta: 100
[INFO: 2020-09-08 12:27:01,111] mv_viloate: 14.707025391337073
[INFO: 2020-09-08 12:29:47,858] ######## Iter (TEST) 96 ########
[INFO: 2020-09-08 12:29:47,859] {'CIDEr': 1.327196966878848}
[INFO: 2020-09-08 12:29:47,861] val_current @iteration 96: 1.313873356833466, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:29:47,861] mv_approxkl: 0.07486605233187925
[INFO: 2020-09-08 12:29:47,861] beta: 100
[INFO: 2020-09-08 12:29:47,861] mv_viloate: 18.728456986604492
[INFO: 2020-09-08 12:32:32,820] ######## Iter (TEST) 112 ########
[INFO: 2020-09-08 12:32:32,821] {'CIDEr': 1.3298661983060702}
[INFO: 2020-09-08 12:32:32,822] val_current @iteration 112: 1.3133807664974184, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:32:32,822] mv_approxkl: 0.11400977395249759
[INFO: 2020-09-08 12:32:32,823] beta: 100
[INFO: 2020-09-08 12:32:32,823] mv_viloate: 19.834652235853056
[INFO: 2020-09-08 12:35:20,247] ######## Iter (TEST) 128 ########
[INFO: 2020-09-08 12:35:20,248] {'CIDEr': 1.32763184980835}
[INFO: 2020-09-08 12:35:20,249] val_current @iteration 128: 1.3106566751127613, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:35:20,249] mv_approxkl: 0.12000439894525083
[INFO: 2020-09-08 12:35:20,250] beta: 100
[INFO: 2020-09-08 12:35:20,250] mv_viloate: 19.366469835547313
[INFO: 2020-09-08 12:38:06,474] ######## Iter (TEST) 144 ########
[INFO: 2020-09-08 12:38:06,474] {'CIDEr': 1.3254331182084451}
[INFO: 2020-09-08 12:38:06,476] val_current @iteration 144: 1.313284815480567, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:38:06,476] mv_approxkl: 0.14574948801566184
[INFO: 2020-09-08 12:38:06,476] beta: 100
[INFO: 2020-09-08 12:38:06,476] mv_viloate: 20.982470952404398
[INFO: 2020-09-08 12:40:54,284] ######## Iter (TEST) 160 ########
[INFO: 2020-09-08 12:40:54,284] {'CIDEr': 1.3264669885831892}
[INFO: 2020-09-08 12:40:54,286] val_current @iteration 160: 1.3125660471109066, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:40:54,286] mv_approxkl: 0.08194824351150967
[INFO: 2020-09-08 12:40:54,286] beta: 100
[INFO: 2020-09-08 12:40:54,286] mv_viloate: 22.062248917357955
[INFO: 2020-09-08 12:43:41,883] ######## Iter (TEST) 176 ########
[INFO: 2020-09-08 12:43:41,883] {'CIDEr': 1.3255199955017192}
[INFO: 2020-09-08 12:43:41,885] val_current @iteration 176: 1.3136773027436734, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:43:41,885] mv_approxkl: 0.11747426986915738
[INFO: 2020-09-08 12:43:41,885] beta: 100
[INFO: 2020-09-08 12:43:41,885] mv_viloate: 22.188967044362865
[INFO: 2020-09-08 12:46:28,028] ######## Iter (TEST) 192 ########
[INFO: 2020-09-08 12:46:28,028] {'CIDEr': 1.3265293604590696}
[INFO: 2020-09-08 12:46:28,030] val_current @iteration 192: 1.3116278779002706, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:46:28,030] mv_approxkl: 0.07744319178387611
[INFO: 2020-09-08 12:46:28,030] beta: 100
[INFO: 2020-09-08 12:46:28,030] mv_viloate: 23.675521548606138
[INFO: 2020-09-08 12:49:15,668] ######## Iter (TEST) 208 ########
[INFO: 2020-09-08 12:49:15,668] {'CIDEr': 1.3256670416668703}
[INFO: 2020-09-08 12:49:15,670] val_current @iteration 208: 1.3130023064274796, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:49:15,670] mv_approxkl: 0.0922647017010191
[INFO: 2020-09-08 12:49:15,670] beta: 100
[INFO: 2020-09-08 12:49:15,670] mv_viloate: 22.049012029381586
[INFO: 2020-09-08 12:52:03,293] ######## Iter (TEST) 224 ########
[INFO: 2020-09-08 12:52:03,294] {'CIDEr': 1.3251792302664456}
[INFO: 2020-09-08 12:52:03,295] val_current @iteration 224: 1.311934381924853, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:52:03,296] mv_approxkl: 0.13191845926505014
[INFO: 2020-09-08 12:52:03,296] beta: 100
[INFO: 2020-09-08 12:52:03,296] mv_viloate: 22.579684637674028
[INFO: 2020-09-08 12:52:46,722] Training with config:
[INFO: 2020-09-08 12:52:46,724] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 12:55:04,171] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 12:55:04,171] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 12:55:04,173] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:57:51,027] ######## Iter (TEST) 16 ########
[INFO: 2020-09-08 12:57:51,027] {'CIDEr': 1.3274806260682783}
[INFO: 2020-09-08 12:57:51,029] val_current @iteration 16: 1.3143204859766702, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 12:57:51,029] mv_approxkl: 0.034194451790577625
[INFO: 2020-09-08 12:57:51,029] beta: 0.5
[INFO: 2020-09-08 12:57:51,029] mv_viloate: 1.8552692471905008
[INFO: 2020-09-08 13:00:38,030] ######## Iter (TEST) 32 ########
[INFO: 2020-09-08 13:00:38,031] {'CIDEr': 1.325971760951848}
[INFO: 2020-09-08 13:00:38,032] val_current @iteration 32: 1.3124057799995734, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 13:00:38,032] mv_approxkl: 0.0727098947243481
[INFO: 2020-09-08 13:00:38,032] beta: 50.0
[INFO: 2020-09-08 13:00:38,033] mv_viloate: 4.590511169932738
[INFO: 2020-09-08 13:03:25,367] ######## Iter (TEST) 48 ########
[INFO: 2020-09-08 13:03:25,367] {'CIDEr': 1.324510768793809}
[INFO: 2020-09-08 13:03:25,370] val_current @iteration 48: 1.3135226211446653, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 13:03:25,370] mv_approxkl: 0.0594075830698232
[INFO: 2020-09-08 13:03:25,370] beta: 100
[INFO: 2020-09-08 13:03:25,370] mv_viloate: 7.870273921840449
[INFO: 2020-09-08 13:06:11,292] ######## Iter (TEST) 64 ########
[INFO: 2020-09-08 13:06:11,292] {'CIDEr': 1.3252405702753605}
[INFO: 2020-09-08 13:06:11,294] val_current @iteration 64: 1.3148608808662523, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 13:06:11,294] mv_approxkl: 0.13294241195682904
[INFO: 2020-09-08 13:06:11,294] beta: 100
[INFO: 2020-09-08 13:06:11,294] mv_viloate: 11.562076867481338
[INFO: 2020-09-08 13:06:11,294] update predictor @iteration 64
[INFO: 2020-09-08 13:08:58,366] ######## Iter (TEST) 80 ########
[INFO: 2020-09-08 13:08:58,366] {'CIDEr': 1.3243745633535104}
[INFO: 2020-09-08 13:08:58,370] val_current @iteration 80: 1.3139929631322074, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:08:58,370] mv_approxkl: 0.07354147596496993
[INFO: 2020-09-08 13:08:58,370] beta: 32.0
[INFO: 2020-09-08 13:08:58,370] mv_viloate: 2.3613892087270005
[INFO: 2020-09-08 13:11:45,276] ######## Iter (TEST) 96 ########
[INFO: 2020-09-08 13:11:45,277] {'CIDEr': 1.3248408925196573}
[INFO: 2020-09-08 13:11:45,278] val_current @iteration 96: 1.3141595596422855, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:11:45,278] mv_approxkl: 0.07007684390399907
[INFO: 2020-09-08 13:11:45,279] beta: 100
[INFO: 2020-09-08 13:11:45,279] mv_viloate: 4.321360040995327
[INFO: 2020-09-08 13:14:31,420] ######## Iter (TEST) 112 ########
[INFO: 2020-09-08 13:14:31,420] {'CIDEr': 1.3223093651302353}
[INFO: 2020-09-08 13:14:31,422] val_current @iteration 112: 1.3135578036232984, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:14:31,422] mv_approxkl: 0.11828911757251409
[INFO: 2020-09-08 13:14:31,422] beta: 100
[INFO: 2020-09-08 13:14:31,422] mv_viloate: 7.790587822058109
[INFO: 2020-09-08 13:17:19,332] ######## Iter (TEST) 128 ########
[INFO: 2020-09-08 13:17:19,332] {'CIDEr': 1.3219799582062228}
[INFO: 2020-09-08 13:17:19,334] val_current @iteration 128: 1.3140160652917572, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:17:19,334] mv_approxkl: 0.17658581799870093
[INFO: 2020-09-08 13:17:19,334] beta: 100
[INFO: 2020-09-08 13:17:19,334] mv_viloate: 10.895340329949555
[INFO: 2020-09-08 13:20:06,630] ######## Iter (TEST) 144 ########
[INFO: 2020-09-08 13:20:06,630] {'CIDEr': 1.3220924998898969}
[INFO: 2020-09-08 13:20:06,634] val_current @iteration 144: 1.3133894239068657, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:20:06,634] mv_approxkl: 0.15151590585144545
[INFO: 2020-09-08 13:20:06,634] beta: 100
[INFO: 2020-09-08 13:20:06,634] mv_viloate: 13.376375181139109
[INFO: 2020-09-08 13:22:53,243] ######## Iter (TEST) 160 ########
[INFO: 2020-09-08 13:22:53,243] {'CIDEr': 1.3225956098409861}
[INFO: 2020-09-08 13:22:53,245] val_current @iteration 160: 1.3136656547672758, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:22:53,245] mv_approxkl: 0.11322673972009256
[INFO: 2020-09-08 13:22:53,245] beta: 100
[INFO: 2020-09-08 13:22:53,245] mv_viloate: 11.598348729440104
[INFO: 2020-09-08 13:25:40,414] ######## Iter (TEST) 176 ########
[INFO: 2020-09-08 13:25:40,414] {'CIDEr': 1.3235530269350662}
[INFO: 2020-09-08 13:25:40,416] val_current @iteration 176: 1.3123230372726318, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:25:40,416] mv_approxkl: 0.09641466575753156
[INFO: 2020-09-08 13:25:40,416] beta: 100
[INFO: 2020-09-08 13:25:40,416] mv_viloate: 13.554754181793193
[INFO: 2020-09-08 13:28:26,929] ######## Iter (TEST) 192 ########
[INFO: 2020-09-08 13:28:26,929] {'CIDEr': 1.3255099661686611}
[INFO: 2020-09-08 13:28:26,931] val_current @iteration 192: 1.3131426643568842, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:28:26,931] mv_approxkl: 0.09549447570966726
[INFO: 2020-09-08 13:28:26,931] beta: 50.0
[INFO: 2020-09-08 13:28:26,931] mv_viloate: 13.168587228132177
[INFO: 2020-09-08 13:31:15,115] ######## Iter (TEST) 208 ########
[INFO: 2020-09-08 13:31:15,115] {'CIDEr': 1.3227671765580762}
[INFO: 2020-09-08 13:31:15,117] val_current @iteration 208: 1.312463420825628, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:31:15,117] mv_approxkl: 0.1523352349197342
[INFO: 2020-09-08 13:31:15,117] beta: 100
[INFO: 2020-09-08 13:31:15,117] mv_viloate: 11.471538350690782
[INFO: 2020-09-08 13:34:01,809] ######## Iter (TEST) 224 ########
[INFO: 2020-09-08 13:34:01,810] {'CIDEr': 1.3225539806887376}
[INFO: 2020-09-08 13:34:01,812] val_current @iteration 224: 1.3107239625373683, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:34:01,812] mv_approxkl: 0.10222637820408732
[INFO: 2020-09-08 13:34:01,812] beta: 100
[INFO: 2020-09-08 13:34:01,812] mv_viloate: 12.14517158764587
[INFO: 2020-09-08 13:36:49,592] ######## Iter (TEST) 240 ########
[INFO: 2020-09-08 13:36:49,593] {'CIDEr': 1.3240577070162267}
[INFO: 2020-09-08 13:36:49,595] val_current @iteration 240: 1.3134809886328447, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:36:49,595] mv_approxkl: 0.27901729823692056
[INFO: 2020-09-08 13:36:49,595] beta: 100
[INFO: 2020-09-08 13:36:49,595] mv_viloate: 15.75111004677899
[INFO: 2020-09-08 13:39:37,017] ######## Iter (TEST) 256 ########
[INFO: 2020-09-08 13:39:37,017] {'CIDEr': 1.3231849695487987}
[INFO: 2020-09-08 13:39:37,019] val_current @iteration 256: 1.3135134316996881, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:39:37,019] mv_approxkl: 0.15933436731253356
[INFO: 2020-09-08 13:39:37,019] beta: 100
[INFO: 2020-09-08 13:39:37,019] mv_viloate: 14.749400404128
[INFO: 2020-09-08 13:42:22,786] ######## Iter (TEST) 272 ########
[INFO: 2020-09-08 13:42:22,787] {'CIDEr': 1.3236738294556807}
[INFO: 2020-09-08 13:42:22,789] val_current @iteration 272: 1.3143399516046521, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:42:22,789] mv_approxkl: 0.19817375151098032
[INFO: 2020-09-08 13:42:22,789] beta: 100
[INFO: 2020-09-08 13:42:22,789] mv_viloate: 14.666244325132128
[INFO: 2020-09-08 13:45:10,626] ######## Iter (TEST) 288 ########
[INFO: 2020-09-08 13:45:10,626] {'CIDEr': 1.323787632188309}
[INFO: 2020-09-08 13:45:10,628] val_current @iteration 288: 1.3148172086556866, val_predictor: 1.3148608808662523
[INFO: 2020-09-08 13:45:10,628] mv_approxkl: 0.19129934820272732
[INFO: 2020-09-08 13:45:10,628] beta: 100
[INFO: 2020-09-08 13:45:10,628] mv_viloate: 15.360320222358522
[INFO: 2020-09-08 13:47:36,366] Training with config:
[INFO: 2020-09-08 13:47:36,368] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 13:49:54,414] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 13:49:54,414] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 13:49:54,416] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 13:51:40,900] Training with config:
[INFO: 2020-09-08 13:51:40,902] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 13:53:57,491] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 13:53:57,492] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 13:53:57,493] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 13:56:42,765] ######## Iter (TEST) 16 ########
[INFO: 2020-09-08 13:56:42,765] {'CIDEr': 1.325710524983979}
[INFO: 2020-09-08 13:56:42,767] val_current @iteration 16: 1.3155115900931065, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 13:56:42,767] mv_approxkl: 0.0006512263467814732
[INFO: 2020-09-08 13:56:42,767] beta: 0.5
[INFO: 2020-09-08 13:56:42,767] mv_violate: 1
[INFO: 2020-09-08 13:56:42,767] update predictor @iteration 16
[INFO: 2020-09-08 13:59:28,574] ######## Iter (TEST) 32 ########
[INFO: 2020-09-08 13:59:28,574] {'CIDEr': 1.324396525706627}
[INFO: 2020-09-08 13:59:28,576] val_current @iteration 32: 1.31664262982689, val_predictor: 1.3155115900931065
[INFO: 2020-09-08 13:59:28,576] mv_approxkl: 0.00026338576478698785
[INFO: 2020-09-08 13:59:28,576] beta: 0.5
[INFO: 2020-09-08 13:59:28,576] mv_violate: 1
[INFO: 2020-09-08 13:59:28,576] update predictor @iteration 32
[INFO: 2020-09-08 14:02:15,013] ######## Iter (TEST) 48 ########
[INFO: 2020-09-08 14:02:15,013] {'CIDEr': 1.3244951652425687}
[INFO: 2020-09-08 14:02:15,015] val_current @iteration 48: 1.3181332285899745, val_predictor: 1.31664262982689
[INFO: 2020-09-08 14:02:15,015] mv_approxkl: 0.000616212539163115
[INFO: 2020-09-08 14:02:15,015] beta: 0.5
[INFO: 2020-09-08 14:02:15,015] mv_violate: 1
[INFO: 2020-09-08 14:02:15,015] update predictor @iteration 48
[INFO: 2020-09-08 14:05:00,789] ######## Iter (TEST) 64 ########
[INFO: 2020-09-08 14:05:00,789] {'CIDEr': 1.325575475311867}
[INFO: 2020-09-08 14:05:00,792] val_current @iteration 64: 1.3155352874762727, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:05:00,792] mv_approxkl: 0.00034429052621055725
[INFO: 2020-09-08 14:05:00,792] beta: 0.5
[INFO: 2020-09-08 14:05:00,792] mv_violate: 1
[INFO: 2020-09-08 14:07:46,671] ######## Iter (TEST) 80 ########
[INFO: 2020-09-08 14:07:46,672] {'CIDEr': 1.3246448439914797}
[INFO: 2020-09-08 14:07:46,673] val_current @iteration 80: 1.315450183501842, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:07:46,674] mv_approxkl: 0.0014374510320972404
[INFO: 2020-09-08 14:07:46,674] beta: 0.5
[INFO: 2020-09-08 14:07:46,674] mv_violate: 1
[INFO: 2020-09-08 14:10:31,424] ######## Iter (TEST) 96 ########
[INFO: 2020-09-08 14:10:31,424] {'CIDEr': 1.3262831800559747}
[INFO: 2020-09-08 14:10:31,427] val_current @iteration 96: 1.3146021264716194, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:10:31,427] mv_approxkl: 0.0038811737095611008
[INFO: 2020-09-08 14:10:31,427] beta: 0.5
[INFO: 2020-09-08 14:10:31,428] mv_violate: 1
[INFO: 2020-09-08 14:13:17,574] ######## Iter (TEST) 112 ########
[INFO: 2020-09-08 14:13:17,575] {'CIDEr': 1.3254288294121064}
[INFO: 2020-09-08 14:13:17,578] val_current @iteration 112: 1.3162424311957028, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:13:17,578] mv_approxkl: 0.0037937929008250997
[INFO: 2020-09-08 14:13:17,578] beta: 0.5
[INFO: 2020-09-08 14:13:17,578] mv_violate: 1
[INFO: 2020-09-08 14:16:02,978] ######## Iter (TEST) 128 ########
[INFO: 2020-09-08 14:16:02,978] {'CIDEr': 1.3257693882877137}
[INFO: 2020-09-08 14:16:02,981] val_current @iteration 128: 1.3167512875560063, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:16:02,981] mv_approxkl: 0.0035771558501691606
[INFO: 2020-09-08 14:16:02,981] beta: 0.5
[INFO: 2020-09-08 14:16:02,981] mv_violate: 1
[INFO: 2020-09-08 14:18:47,904] ######## Iter (TEST) 144 ########
[INFO: 2020-09-08 14:18:47,904] {'CIDEr': 1.3240486839939667}
[INFO: 2020-09-08 14:18:47,906] val_current @iteration 144: 1.3162810142660788, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:18:47,906] mv_approxkl: 0.0051652236223505375
[INFO: 2020-09-08 14:18:47,906] beta: 0.5
[INFO: 2020-09-08 14:18:47,906] mv_violate: 1
[INFO: 2020-09-08 14:21:34,712] ######## Iter (TEST) 160 ########
[INFO: 2020-09-08 14:21:34,713] {'CIDEr': 1.3265383630307381}
[INFO: 2020-09-08 14:21:34,715] val_current @iteration 160: 1.315346269919939, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:21:34,715] mv_approxkl: 0.006315366952097979
[INFO: 2020-09-08 14:21:34,715] beta: 0.5
[INFO: 2020-09-08 14:21:34,715] mv_violate: 1
[INFO: 2020-09-08 14:24:20,641] ######## Iter (TEST) 176 ########
[INFO: 2020-09-08 14:24:20,642] {'CIDEr': 1.3248485827548604}
[INFO: 2020-09-08 14:24:20,643] val_current @iteration 176: 1.315396252203496, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:24:20,643] mv_approxkl: 0.00527355249623163
[INFO: 2020-09-08 14:24:20,644] beta: 0.5
[INFO: 2020-09-08 14:24:20,644] mv_violate: 1
[INFO: 2020-09-08 14:27:06,730] ######## Iter (TEST) 192 ########
[INFO: 2020-09-08 14:27:06,731] {'CIDEr': 1.324634543546409}
[INFO: 2020-09-08 14:27:06,732] val_current @iteration 192: 1.3178472181733278, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:27:06,733] mv_approxkl: 0.006252035176740784
[INFO: 2020-09-08 14:27:06,733] beta: 0.5
[INFO: 2020-09-08 14:27:06,733] mv_violate: 1
[INFO: 2020-09-08 14:29:53,973] ######## Iter (TEST) 208 ########
[INFO: 2020-09-08 14:29:53,974] {'CIDEr': 1.3253381165555174}
[INFO: 2020-09-08 14:29:53,975] val_current @iteration 208: 1.3168274133908822, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:29:53,976] mv_approxkl: 0.006914001082095993
[INFO: 2020-09-08 14:29:53,976] beta: 0.5
[INFO: 2020-09-08 14:29:53,976] mv_violate: 1
[INFO: 2020-09-08 14:32:40,512] ######## Iter (TEST) 224 ########
[INFO: 2020-09-08 14:32:40,512] {'CIDEr': 1.3258688700630918}
[INFO: 2020-09-08 14:32:40,514] val_current @iteration 224: 1.3181763982883672, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:32:40,514] mv_approxkl: 0.0069304374500485134
[INFO: 2020-09-08 14:32:40,514] beta: 0.5
[INFO: 2020-09-08 14:32:40,514] mv_violate: 1
[INFO: 2020-09-08 14:35:27,356] ######## Iter (TEST) 240 ########
[INFO: 2020-09-08 14:35:27,357] {'CIDEr': 1.3251930622553028}
[INFO: 2020-09-08 14:35:27,358] val_current @iteration 240: 1.3170874661452947, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:35:27,359] mv_approxkl: 0.006806256701088928
[INFO: 2020-09-08 14:35:27,359] beta: 0.5
[INFO: 2020-09-08 14:35:27,359] mv_violate: 1
[INFO: 2020-09-08 14:38:13,013] ######## Iter (TEST) 256 ########
[INFO: 2020-09-08 14:38:13,013] {'CIDEr': 1.3235408624111957}
[INFO: 2020-09-08 14:38:13,015] val_current @iteration 256: 1.317753312108683, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:38:13,015] mv_approxkl: 0.008207778114730214
[INFO: 2020-09-08 14:38:13,015] beta: 0.5
[INFO: 2020-09-08 14:38:13,015] mv_violate: 1
[INFO: 2020-09-08 14:40:58,435] ######## Iter (TEST) 272 ########
[INFO: 2020-09-08 14:40:58,435] {'CIDEr': 1.323240548983724}
[INFO: 2020-09-08 14:40:58,437] val_current @iteration 272: 1.3176473501884642, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:40:58,437] mv_approxkl: 0.008625204129099492
[INFO: 2020-09-08 14:40:58,437] beta: 1.0
[INFO: 2020-09-08 14:40:58,437] mv_violate: 1
[INFO: 2020-09-08 14:43:45,579] ######## Iter (TEST) 288 ########
[INFO: 2020-09-08 14:43:45,579] {'CIDEr': 1.3223216766529633}
[INFO: 2020-09-08 14:43:45,581] val_current @iteration 288: 1.3193097982998336, val_predictor: 1.3181332285899745
[INFO: 2020-09-08 14:43:45,581] mv_approxkl: 0.006805415014209625
[INFO: 2020-09-08 14:43:45,581] beta: 0.5
[INFO: 2020-09-08 14:43:45,581] mv_violate: 1
[INFO: 2020-09-08 14:43:45,581] update predictor @iteration 288
[INFO: 2020-09-08 14:46:31,120] ######## Iter (TEST) 304 ########
[INFO: 2020-09-08 14:46:31,120] {'CIDEr': 1.323251638463176}
[INFO: 2020-09-08 14:46:31,122] val_current @iteration 304: 1.3157326904645938, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 14:46:31,122] mv_approxkl: 0.0004987070110234826
[INFO: 2020-09-08 14:46:31,122] beta: 0.5
[INFO: 2020-09-08 14:46:31,122] mv_violate: 1
[INFO: 2020-09-08 14:49:17,074] ######## Iter (TEST) 320 ########
[INFO: 2020-09-08 14:49:17,075] {'CIDEr': 1.3264920380544325}
[INFO: 2020-09-08 14:49:17,076] val_current @iteration 320: 1.317872325209993, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 14:49:17,076] mv_approxkl: 0.0017825365478531267
[INFO: 2020-09-08 14:49:17,077] beta: 0.5
[INFO: 2020-09-08 14:49:17,077] mv_violate: 1
[INFO: 2020-09-08 14:52:02,978] ######## Iter (TEST) 336 ########
[INFO: 2020-09-08 14:52:02,978] {'CIDEr': 1.3259691745769575}
[INFO: 2020-09-08 14:52:02,980] val_current @iteration 336: 1.3182653388632262, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 14:52:02,980] mv_approxkl: 0.004824301651019612
[INFO: 2020-09-08 14:52:02,980] beta: 0.5
[INFO: 2020-09-08 14:52:02,980] mv_violate: 1
[INFO: 2020-09-08 14:54:47,675] ######## Iter (TEST) 352 ########
[INFO: 2020-09-08 14:54:47,675] {'CIDEr': 1.3281991440222067}
[INFO: 2020-09-08 14:54:47,677] val_current @iteration 352: 1.318669620303255, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 14:54:47,677] mv_approxkl: 0.004161415135812552
[INFO: 2020-09-08 14:54:47,677] beta: 0.5
[INFO: 2020-09-08 14:54:47,677] mv_violate: 1
[INFO: 2020-09-08 14:57:34,446] ######## Iter (TEST) 368 ########
[INFO: 2020-09-08 14:57:34,446] {'CIDEr': 1.3263229652681414}
[INFO: 2020-09-08 14:57:34,448] val_current @iteration 368: 1.3183633836100048, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 14:57:34,448] mv_approxkl: 0.004645029179942291
[INFO: 2020-09-08 14:57:34,448] beta: 0.5
[INFO: 2020-09-08 14:57:34,448] mv_violate: 1
[INFO: 2020-09-08 15:00:20,743] ######## Iter (TEST) 384 ########
[INFO: 2020-09-08 15:00:20,743] {'CIDEr': 1.3267440908730288}
[INFO: 2020-09-08 15:00:20,745] val_current @iteration 384: 1.3175050848134757, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:00:20,745] mv_approxkl: 0.0043163461021074505
[INFO: 2020-09-08 15:00:20,745] beta: 0.5
[INFO: 2020-09-08 15:00:20,745] mv_violate: 1
[INFO: 2020-09-08 15:03:06,850] ######## Iter (TEST) 400 ########
[INFO: 2020-09-08 15:03:06,851] {'CIDEr': 1.3292613870340322}
[INFO: 2020-09-08 15:03:06,853] val_current @iteration 400: 1.3189593346747313, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:03:06,853] mv_approxkl: 0.007124943468918567
[INFO: 2020-09-08 15:03:06,853] beta: 0.5
[INFO: 2020-09-08 15:03:06,853] mv_violate: 1
[INFO: 2020-09-08 15:05:52,859] ######## Iter (TEST) 416 ########
[INFO: 2020-09-08 15:05:52,860] {'CIDEr': 1.3274410870264375}
[INFO: 2020-09-08 15:05:52,861] val_current @iteration 416: 1.3169617271401184, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:05:52,861] mv_approxkl: 0.005327950612275723
[INFO: 2020-09-08 15:05:52,861] beta: 0.5
[INFO: 2020-09-08 15:05:52,862] mv_violate: 1
[INFO: 2020-09-08 15:08:38,633] ######## Iter (TEST) 432 ########
[INFO: 2020-09-08 15:08:38,633] {'CIDEr': 1.3258578827568384}
[INFO: 2020-09-08 15:08:38,635] val_current @iteration 432: 1.3169429171478522, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:08:38,635] mv_approxkl: 0.004767632920457774
[INFO: 2020-09-08 15:08:38,635] beta: 0.5
[INFO: 2020-09-08 15:08:38,635] mv_violate: 1
[INFO: 2020-09-08 15:11:24,174] ######## Iter (TEST) 448 ########
[INFO: 2020-09-08 15:11:24,174] {'CIDEr': 1.3264157622261303}
[INFO: 2020-09-08 15:11:24,176] val_current @iteration 448: 1.3176401092179866, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:11:24,176] mv_approxkl: 0.00617681069164584
[INFO: 2020-09-08 15:11:24,176] beta: 0.5
[INFO: 2020-09-08 15:11:24,176] mv_violate: 1
[INFO: 2020-09-08 15:14:10,683] ######## Iter (TEST) 464 ########
[INFO: 2020-09-08 15:14:10,683] {'CIDEr': 1.324325946960249}
[INFO: 2020-09-08 15:14:10,685] val_current @iteration 464: 1.3197270570446087, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:14:10,685] mv_approxkl: 0.006024934219939912
[INFO: 2020-09-08 15:14:10,685] beta: 0.5
[INFO: 2020-09-08 15:14:10,685] mv_violate: 1
[INFO: 2020-09-08 15:16:56,092] ######## Iter (TEST) 480 ########
[INFO: 2020-09-08 15:16:56,092] {'CIDEr': 1.3265630805684814}
[INFO: 2020-09-08 15:16:56,094] val_current @iteration 480: 1.3195499194354205, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:16:56,094] mv_approxkl: 0.0057929647098019146
[INFO: 2020-09-08 15:16:56,094] beta: 0.5
[INFO: 2020-09-08 15:16:56,094] mv_violate: 1
[INFO: 2020-09-08 15:19:40,808] ######## Iter (TEST) 496 ########
[INFO: 2020-09-08 15:19:40,809] {'CIDEr': 1.3267208219267652}
[INFO: 2020-09-08 15:19:40,811] val_current @iteration 496: 1.3170840956476189, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:19:40,811] mv_approxkl: 0.006089309166022925
[INFO: 2020-09-08 15:19:40,811] beta: 0.5
[INFO: 2020-09-08 15:19:40,811] mv_violate: 1
[INFO: 2020-09-08 15:22:27,031] ######## Iter (TEST) 512 ########
[INFO: 2020-09-08 15:22:27,032] {'CIDEr': 1.324849486043993}
[INFO: 2020-09-08 15:22:27,034] val_current @iteration 512: 1.317873481431503, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:22:27,034] mv_approxkl: 0.006801390373959996
[INFO: 2020-09-08 15:22:27,034] beta: 0.5
[INFO: 2020-09-08 15:22:27,034] mv_violate: 1
[INFO: 2020-09-08 15:25:12,742] ######## Iter (TEST) 528 ########
[INFO: 2020-09-08 15:25:12,743] {'CIDEr': 1.3249162921072537}
[INFO: 2020-09-08 15:25:12,744] val_current @iteration 528: 1.3169921989550455, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:25:12,745] mv_approxkl: 0.006802383171124256
[INFO: 2020-09-08 15:25:12,745] beta: 0.5
[INFO: 2020-09-08 15:25:12,745] mv_violate: 1
[INFO: 2020-09-08 15:27:59,152] ######## Iter (TEST) 544 ########
[INFO: 2020-09-08 15:27:59,152] {'CIDEr': 1.3253821218725717}
[INFO: 2020-09-08 15:27:59,154] val_current @iteration 544: 1.315398825188546, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:27:59,154] mv_approxkl: 0.007713481031415291
[INFO: 2020-09-08 15:27:59,154] beta: 0.5
[INFO: 2020-09-08 15:27:59,154] mv_violate: 1
[INFO: 2020-09-08 15:30:45,852] ######## Iter (TEST) 560 ########
[INFO: 2020-09-08 15:30:45,852] {'CIDEr': 1.3245466493404303}
[INFO: 2020-09-08 15:30:45,854] val_current @iteration 560: 1.3179946849156856, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:30:45,854] mv_approxkl: 0.007743123019050519
[INFO: 2020-09-08 15:30:45,854] beta: 0.5
[INFO: 2020-09-08 15:30:45,854] mv_violate: 1
[INFO: 2020-09-08 15:33:30,550] ######## Iter (TEST) 576 ########
[INFO: 2020-09-08 15:33:30,550] {'CIDEr': 1.3240096208469734}
[INFO: 2020-09-08 15:33:30,552] val_current @iteration 576: 1.3151019215096746, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:33:30,552] mv_approxkl: 0.010287870750542528
[INFO: 2020-09-08 15:33:30,552] beta: 0.5
[INFO: 2020-09-08 15:33:30,552] mv_violate: 1
[INFO: 2020-09-08 15:36:16,460] ######## Iter (TEST) 592 ########
[INFO: 2020-09-08 15:36:16,460] {'CIDEr': 1.3235000865915638}
[INFO: 2020-09-08 15:36:16,462] val_current @iteration 592: 1.3173779254633315, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:36:16,462] mv_approxkl: 0.011705019221078512
[INFO: 2020-09-08 15:36:16,462] beta: 0.5
[INFO: 2020-09-08 15:36:16,462] mv_violate: 1
[INFO: 2020-09-08 15:39:03,337] ######## Iter (TEST) 608 ########
[INFO: 2020-09-08 15:39:03,337] {'CIDEr': 1.3256002188370553}
[INFO: 2020-09-08 15:39:03,339] val_current @iteration 608: 1.317228898673139, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:39:03,339] mv_approxkl: 0.008991860174864728
[INFO: 2020-09-08 15:39:03,339] beta: 0.5
[INFO: 2020-09-08 15:39:03,339] mv_violate: 1
[INFO: 2020-09-08 15:41:48,768] ######## Iter (TEST) 624 ########
[INFO: 2020-09-08 15:41:48,768] {'CIDEr': 1.3241949626235732}
[INFO: 2020-09-08 15:41:48,770] val_current @iteration 624: 1.317900204517992, val_predictor: 1.3193097982998336
[INFO: 2020-09-08 15:41:48,770] mv_approxkl: 0.011093135296435923
[INFO: 2020-09-08 15:41:48,770] beta: 1.0
[INFO: 2020-09-08 15:41:48,770] mv_violate: 1
[INFO: 2020-09-08 15:43:09,257] Training with config:
[INFO: 2020-09-08 15:43:09,258] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 15:45:26,106] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 15:45:26,106] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 15:45:26,109] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 15:48:12,283] ######## Iter (TEST) 16 ########
[INFO: 2020-09-08 15:48:12,283] {'CIDEr': 1.3250646149887328}
[INFO: 2020-09-08 15:48:12,285] val_current @iteration 16: 1.3143408061054713, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 15:48:12,285] mv_approxkl: 0.000516724325411437
[INFO: 2020-09-08 15:50:57,437] ######## Iter (TEST) 32 ########
[INFO: 2020-09-08 15:50:57,437] {'CIDEr': 1.325601616211653}
[INFO: 2020-09-08 15:50:57,439] val_current @iteration 32: 1.3134352076302702, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 15:50:57,439] mv_approxkl: 0.0008791294635642164
[INFO: 2020-09-08 15:53:42,267] ######## Iter (TEST) 48 ########
[INFO: 2020-09-08 15:53:42,267] {'CIDEr': 1.3245759184923251}
[INFO: 2020-09-08 15:53:42,269] val_current @iteration 48: 1.313140606711175, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 15:53:42,269] mv_approxkl: 0.0018269778117990705
[INFO: 2020-09-08 15:56:26,547] ######## Iter (TEST) 64 ########
[INFO: 2020-09-08 15:56:26,547] {'CIDEr': 1.3262433047827349}
[INFO: 2020-09-08 15:56:26,549] val_current @iteration 64: 1.3129634700707398, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 15:56:26,549] mv_approxkl: 0.002668887624506323
[INFO: 2020-09-08 15:59:11,975] ######## Iter (TEST) 80 ########
[INFO: 2020-09-08 15:59:11,976] {'CIDEr': 1.325943186513485}
[INFO: 2020-09-08 15:59:11,977] val_current @iteration 80: 1.3138922697916444, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 15:59:11,977] mv_approxkl: 0.00224265670281032
[INFO: 2020-09-08 16:01:57,204] ######## Iter (TEST) 96 ########
[INFO: 2020-09-08 16:01:57,204] {'CIDEr': 1.3274583923869232}
[INFO: 2020-09-08 16:01:57,206] val_current @iteration 96: 1.3134852635632273, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:01:57,206] mv_approxkl: 0.0026673717700907824
[INFO: 2020-09-08 16:04:41,811] ######## Iter (TEST) 112 ########
[INFO: 2020-09-08 16:04:41,811] {'CIDEr': 1.3284898743258142}
[INFO: 2020-09-08 16:04:41,814] val_current @iteration 112: 1.3128816283375109, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:04:41,815] mv_approxkl: 0.0030602304161450058
[INFO: 2020-09-08 16:07:27,943] ######## Iter (TEST) 128 ########
[INFO: 2020-09-08 16:07:27,943] {'CIDEr': 1.3274093512769851}
[INFO: 2020-09-08 16:07:27,945] val_current @iteration 128: 1.3121598336955143, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:07:27,945] mv_approxkl: 0.002913843034015559
[INFO: 2020-09-08 16:10:12,670] ######## Iter (TEST) 144 ########
[INFO: 2020-09-08 16:10:12,670] {'CIDEr': 1.3249898774295499}
[INFO: 2020-09-08 16:10:12,672] val_current @iteration 144: 1.31150554767739, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:10:12,672] mv_approxkl: 0.004480944334608339
[INFO: 2020-09-08 16:12:59,138] ######## Iter (TEST) 160 ########
[INFO: 2020-09-08 16:12:59,138] {'CIDEr': 1.325232943401616}
[INFO: 2020-09-08 16:12:59,140] val_current @iteration 160: 1.3137316452374486, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:12:59,140] mv_approxkl: 0.004209271688070925
[INFO: 2020-09-08 16:15:44,980] ######## Iter (TEST) 176 ########
[INFO: 2020-09-08 16:15:44,980] {'CIDEr': 1.325557250141351}
[INFO: 2020-09-08 16:15:44,982] val_current @iteration 176: 1.3151129332212959, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:15:44,982] mv_approxkl: 0.0038248377012064286
[INFO: 2020-09-08 16:18:29,723] ######## Iter (TEST) 192 ########
[INFO: 2020-09-08 16:18:29,723] {'CIDEr': 1.3242281997905645}
[INFO: 2020-09-08 16:18:29,725] val_current @iteration 192: 1.3135452991807228, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:18:29,725] mv_approxkl: 0.003681587553196306
[INFO: 2020-09-08 16:21:16,193] ######## Iter (TEST) 208 ########
[INFO: 2020-09-08 16:21:16,194] {'CIDEr': 1.3249778375952466}
[INFO: 2020-09-08 16:21:16,195] val_current @iteration 208: 1.312962344165177, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:21:16,196] mv_approxkl: 0.0038112834243189397
[INFO: 2020-09-08 16:24:00,890] ######## Iter (TEST) 224 ########
[INFO: 2020-09-08 16:24:00,890] {'CIDEr': 1.3253700868855594}
[INFO: 2020-09-08 16:24:00,892] val_current @iteration 224: 1.3140022313708082, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:24:00,892] mv_approxkl: 0.004763630743546738
[INFO: 2020-09-08 16:26:46,904] ######## Iter (TEST) 240 ########
[INFO: 2020-09-08 16:26:46,904] {'CIDEr': 1.3248812899447144}
[INFO: 2020-09-08 16:26:46,906] val_current @iteration 240: 1.311655712860008, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:26:46,906] mv_approxkl: 0.004616150248259058
[INFO: 2020-09-08 16:29:32,802] ######## Iter (TEST) 256 ########
[INFO: 2020-09-08 16:29:32,802] {'CIDEr': 1.3253104276030134}
[INFO: 2020-09-08 16:29:32,804] val_current @iteration 256: 1.311053397274615, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:29:32,804] mv_approxkl: 0.0045914918205530435
[INFO: 2020-09-08 16:32:16,983] ######## Iter (TEST) 272 ########
[INFO: 2020-09-08 16:32:16,983] {'CIDEr': 1.3229751825580363}
[INFO: 2020-09-08 16:32:16,985] val_current @iteration 272: 1.3117028665964472, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:32:16,985] mv_approxkl: 0.005381625800887631
[INFO: 2020-09-08 16:35:02,207] ######## Iter (TEST) 288 ########
[INFO: 2020-09-08 16:35:02,207] {'CIDEr': 1.3231669882074772}
[INFO: 2020-09-08 16:35:02,209] val_current @iteration 288: 1.3121181056295304, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:35:02,209] mv_approxkl: 0.004353997351590543
[INFO: 2020-09-08 16:37:47,472] ######## Iter (TEST) 304 ########
[INFO: 2020-09-08 16:37:47,472] {'CIDEr': 1.3243336372160701}
[INFO: 2020-09-08 16:37:47,474] val_current @iteration 304: 1.3110325838663224, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:37:47,474] mv_approxkl: 0.00501367964518041
[INFO: 2020-09-08 16:40:32,372] ######## Iter (TEST) 320 ########
[INFO: 2020-09-08 16:40:32,372] {'CIDEr': 1.3260877893006011}
[INFO: 2020-09-08 16:40:32,374] val_current @iteration 320: 1.3102122254912993, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:40:32,374] mv_approxkl: 0.005215111048801851
[INFO: 2020-09-08 16:43:18,056] ######## Iter (TEST) 336 ########
[INFO: 2020-09-08 16:43:18,056] {'CIDEr': 1.3245928902812099}
[INFO: 2020-09-08 16:43:18,058] val_current @iteration 336: 1.3109963774100437, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:43:18,058] mv_approxkl: 0.005837761627617565
[INFO: 2020-09-08 16:44:46,976] Training with config:
[INFO: 2020-09-08 16:44:46,978] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 16:47:04,383] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 16:47:04,383] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 16:47:04,385] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:53:35,161] ######## Iter (TEST) 100 ########
[INFO: 2020-09-08 16:53:35,162] {'CIDEr': 1.3281185231692088}
[INFO: 2020-09-08 16:53:35,164] val_current @iteration 100: 1.3149654129374493, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 16:53:35,164] mv_approxkl: 0.0010029638471138642
[INFO: 2020-09-08 17:00:04,880] ######## Iter (TEST) 200 ########
[INFO: 2020-09-08 17:00:04,880] {'CIDEr': 1.326896630591941}
[INFO: 2020-09-08 17:00:04,882] val_current @iteration 200: 1.3139051712511771, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:00:04,882] mv_approxkl: 0.0010488182019191357
[INFO: 2020-09-08 17:13:57,070] Training with config:
[INFO: 2020-09-08 17:13:57,072] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 17:16:14,625] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 17:16:14,625] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 17:16:14,627] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:17:12,523] Training with config:
[INFO: 2020-09-08 17:17:12,526] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 17:19:30,376] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 17:19:30,376] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 17:19:30,378] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:20:58,861] Training with config:
[INFO: 2020-09-08 17:20:58,863] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 17:23:15,847] ######## Iter (TEST) 0 ########
[INFO: 2020-09-08 17:23:15,848] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-08 17:23:15,849] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:26:00,448] ######## Iter (TEST) 16 ########
[INFO: 2020-09-08 17:26:00,448] {'CIDEr': 1.3276298537350204}
[INFO: 2020-09-08 17:26:00,450] val_current @iteration 16: 1.3126899947148136, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:26:00,450] mv_approxkl: 6.969543556722967e-11
[INFO: 2020-09-08 17:28:44,685] ######## Iter (TEST) 32 ########
[INFO: 2020-09-08 17:28:44,685] {'CIDEr': 1.328491216365425}
[INFO: 2020-09-08 17:28:44,687] val_current @iteration 32: 1.3128495088937093, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:28:44,687] mv_approxkl: 1.3729195067786565e-05
[INFO: 2020-09-08 17:31:29,965] ######## Iter (TEST) 48 ########
[INFO: 2020-09-08 17:31:29,965] {'CIDEr': 1.3283555118415913}
[INFO: 2020-09-08 17:31:29,967] val_current @iteration 48: 1.3129465522629464, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:31:29,967] mv_approxkl: 6.388119395011199e-05
[INFO: 2020-09-08 17:34:14,176] ######## Iter (TEST) 64 ########
[INFO: 2020-09-08 17:34:14,176] {'CIDEr': 1.3288758634769091}
[INFO: 2020-09-08 17:34:14,178] val_current @iteration 64: 1.3126731266741327, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:34:14,178] mv_approxkl: 8.052707871904316e-05
[INFO: 2020-09-08 17:36:58,659] ######## Iter (TEST) 80 ########
[INFO: 2020-09-08 17:36:58,659] {'CIDEr': 1.3286652863860147}
[INFO: 2020-09-08 17:36:58,661] val_current @iteration 80: 1.3131871411642322, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:36:58,661] mv_approxkl: 8.632169004543513e-05
[INFO: 2020-09-08 17:39:42,543] ######## Iter (TEST) 96 ########
[INFO: 2020-09-08 17:39:42,543] {'CIDEr': 1.3286410668930502}
[INFO: 2020-09-08 17:39:42,545] val_current @iteration 96: 1.3131056278895497, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:39:42,545] mv_approxkl: 0.00013682118082477139
[INFO: 2020-09-08 17:42:27,769] ######## Iter (TEST) 112 ########
[INFO: 2020-09-08 17:42:27,769] {'CIDEr': 1.328447021436172}
[INFO: 2020-09-08 17:42:27,771] val_current @iteration 112: 1.3131316462397882, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:42:27,771] mv_approxkl: 0.00018126483604895356
[INFO: 2020-09-08 17:45:13,506] ######## Iter (TEST) 128 ########
[INFO: 2020-09-08 17:45:13,506] {'CIDEr': 1.3282491657952784}
[INFO: 2020-09-08 17:45:13,508] val_current @iteration 128: 1.3132627178938334, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:45:13,508] mv_approxkl: 0.00021601272589247955
[INFO: 2020-09-08 17:47:57,423] ######## Iter (TEST) 144 ########
[INFO: 2020-09-08 17:47:57,423] {'CIDEr': 1.3280846990718804}
[INFO: 2020-09-08 17:47:57,425] val_current @iteration 144: 1.3133424692748221, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:47:57,425] mv_approxkl: 0.0002213933731051043
[INFO: 2020-09-08 17:50:43,213] ######## Iter (TEST) 160 ########
[INFO: 2020-09-08 17:50:43,214] {'CIDEr': 1.3277362745528003}
[INFO: 2020-09-08 17:50:43,216] val_current @iteration 160: 1.3141333408155664, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:50:43,216] mv_approxkl: 0.00018987395745147348
[INFO: 2020-09-08 17:53:27,812] ######## Iter (TEST) 176 ########
[INFO: 2020-09-08 17:53:27,813] {'CIDEr': 1.327917547524277}
[INFO: 2020-09-08 17:53:27,814] val_current @iteration 176: 1.3144687994172284, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:53:27,815] mv_approxkl: 0.0001938467945094013
[INFO: 2020-09-08 17:56:11,819] ######## Iter (TEST) 192 ########
[INFO: 2020-09-08 17:56:11,820] {'CIDEr': 1.327790668824894}
[INFO: 2020-09-08 17:56:11,822] val_current @iteration 192: 1.3144836944223177, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:56:11,822] mv_approxkl: 0.0001890864483094384
[INFO: 2020-09-08 17:58:57,898] ######## Iter (TEST) 208 ########
[INFO: 2020-09-08 17:58:57,898] {'CIDEr': 1.3276434033347913}
[INFO: 2020-09-08 17:58:57,900] val_current @iteration 208: 1.314649259465413, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 17:58:57,900] mv_approxkl: 0.00019636331723816986
[INFO: 2020-09-08 18:01:44,369] ######## Iter (TEST) 224 ########
[INFO: 2020-09-08 18:01:44,369] {'CIDEr': 1.3268579612227256}
[INFO: 2020-09-08 18:01:44,371] val_current @iteration 224: 1.3147238087719315, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 18:01:44,371] mv_approxkl: 0.0002406474438104187
[INFO: 2020-09-08 18:04:29,399] ######## Iter (TEST) 240 ########
[INFO: 2020-09-08 18:04:29,399] {'CIDEr': 1.3267721498006908}
[INFO: 2020-09-08 18:04:29,401] val_current @iteration 240: 1.3148786883265016, val_predictor: 1.3134830622722575
[INFO: 2020-09-08 18:04:29,401] mv_approxkl: 0.0002555039071207826
[INFO: 2020-09-08 18:05:06,162] Training with config:
[INFO: 2020-09-08 18:05:06,164] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 18:05:22,829] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-08 18:11:50,921] ######## Iter (TEST) 100 ########
[INFO: 2020-09-08 18:11:50,921] {'CIDEr': 1.3252401308748682}
[INFO: 2020-09-08 18:11:50,923] val_current @iteration 100: 1.3132689992762046, val_predictor: 0
[INFO: 2020-09-08 18:11:50,923] mv_approxkl: 0.00370777086071349
[INFO: 2020-09-08 18:18:19,538] ######## Iter (TEST) 200 ########
[INFO: 2020-09-08 18:18:19,538] {'CIDEr': 1.3251368250784836}
[INFO: 2020-09-08 18:18:19,540] val_current @iteration 200: 1.311480366935824, val_predictor: 0
[INFO: 2020-09-08 18:18:19,540] mv_approxkl: 0.0025178328243130282
[INFO: 2020-09-08 18:24:48,912] ######## Iter (TEST) 300 ########
[INFO: 2020-09-08 18:24:48,912] {'CIDEr': 1.3271915089649482}
[INFO: 2020-09-08 18:24:48,914] val_current @iteration 300: 1.3124169581584546, val_predictor: 0
[INFO: 2020-09-08 18:24:48,914] mv_approxkl: 0.004309986373724128
[INFO: 2020-09-08 18:31:16,806] ######## Iter (TEST) 400 ########
[INFO: 2020-09-08 18:31:16,806] {'CIDEr': 1.3274606173594234}
[INFO: 2020-09-08 18:31:16,808] val_current @iteration 400: 1.3128049729645903, val_predictor: 0
[INFO: 2020-09-08 18:31:16,808] mv_approxkl: 0.004768983636402188
[INFO: 2020-09-08 18:37:45,421] ######## Iter (TEST) 500 ########
[INFO: 2020-09-08 18:37:45,421] {'CIDEr': 1.3270422264594386}
[INFO: 2020-09-08 18:37:45,424] val_current @iteration 500: 1.3112231197781479, val_predictor: 0
[INFO: 2020-09-08 18:37:45,424] mv_approxkl: 0.0029746186515311737
[INFO: 2020-09-08 18:44:13,455] ######## Iter (TEST) 600 ########
[INFO: 2020-09-08 18:44:13,455] {'CIDEr': 1.3300836955740636}
[INFO: 2020-09-08 18:44:13,457] val_current @iteration 600: 1.3124566990934716, val_predictor: 0
[INFO: 2020-09-08 18:44:13,457] mv_approxkl: 0.00392441369227506
[INFO: 2020-09-08 18:50:41,763] ######## Iter (TEST) 700 ########
[INFO: 2020-09-08 18:50:41,763] {'CIDEr': 1.3283745692705684}
[INFO: 2020-09-08 18:50:41,765] val_current @iteration 700: 1.3113160107720923, val_predictor: 0
[INFO: 2020-09-08 18:50:41,765] mv_approxkl: 0.0037512032748890124
[INFO: 2020-09-08 18:57:11,509] ######## Iter (TEST) 800 ########
[INFO: 2020-09-08 18:57:11,509] {'CIDEr': 1.331287209200577}
[INFO: 2020-09-08 18:57:11,511] val_current @iteration 800: 1.3166190365061754, val_predictor: 0
[INFO: 2020-09-08 18:57:11,511] mv_approxkl: 0.002222928035135584
[INFO: 2020-09-08 19:03:40,807] ######## Iter (TEST) 900 ########
[INFO: 2020-09-08 19:03:40,807] {'CIDEr': 1.33158454088153}
[INFO: 2020-09-08 19:03:40,809] val_current @iteration 900: 1.3139054932418417, val_predictor: 0
[INFO: 2020-09-08 19:03:40,809] mv_approxkl: 0.00363422631366459
[INFO: 2020-09-08 19:10:09,680] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-08 19:10:09,680] {'CIDEr': 1.3290146035806125}
[INFO: 2020-09-08 19:10:09,682] val_current @iteration 1000: 1.315142243187778, val_predictor: 0
[INFO: 2020-09-08 19:10:09,682] mv_approxkl: 0.0035664818149428634
[INFO: 2020-09-08 19:16:38,446] ######## Iter (TEST) 1100 ########
[INFO: 2020-09-08 19:16:38,446] {'CIDEr': 1.3290492001888283}
[INFO: 2020-09-08 19:16:38,448] val_current @iteration 1100: 1.313164467176214, val_predictor: 0
[INFO: 2020-09-08 19:16:38,448] mv_approxkl: 0.002714950550046682
[INFO: 2020-09-08 19:23:05,844] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-08 19:23:05,844] {'CIDEr': 1.3277506374503165}
[INFO: 2020-09-08 19:23:05,846] val_current @iteration 1200: 1.3174272823156539, val_predictor: 0
[INFO: 2020-09-08 19:23:05,846] mv_approxkl: 0.002829966776042599
[INFO: 2020-09-08 19:29:33,437] ######## Iter (TEST) 1300 ########
[INFO: 2020-09-08 19:29:33,438] {'CIDEr': 1.3277302868322656}
[INFO: 2020-09-08 19:29:33,439] val_current @iteration 1300: 1.3161389511676853, val_predictor: 0
[INFO: 2020-09-08 19:29:33,440] mv_approxkl: 0.0030174353405917538
[INFO: 2020-09-08 19:36:01,917] ######## Iter (TEST) 1400 ########
[INFO: 2020-09-08 19:36:01,917] {'CIDEr': 1.328895374687941}
[INFO: 2020-09-08 19:36:01,919] val_current @iteration 1400: 1.31498127537568, val_predictor: 0
[INFO: 2020-09-08 19:36:01,919] mv_approxkl: 0.002160984039723878
[INFO: 2020-09-08 19:42:29,838] ######## Iter (TEST) 1500 ########
[INFO: 2020-09-08 19:42:29,838] {'CIDEr': 1.3294225815978067}
[INFO: 2020-09-08 19:42:29,840] val_current @iteration 1500: 1.3150587643522598, val_predictor: 0
[INFO: 2020-09-08 19:42:29,840] mv_approxkl: 0.0027267917013910395
[INFO: 2020-09-08 19:48:59,066] ######## Iter (TEST) 1600 ########
[INFO: 2020-09-08 19:48:59,066] {'CIDEr': 1.3310072122554548}
[INFO: 2020-09-08 19:48:59,069] val_current @iteration 1600: 1.312492557425601, val_predictor: 0
[INFO: 2020-09-08 19:48:59,069] mv_approxkl: 0.005329176450209269
[INFO: 2020-09-08 19:55:26,118] ######## Iter (TEST) 1700 ########
[INFO: 2020-09-08 19:55:26,118] {'CIDEr': 1.3285002076045056}
[INFO: 2020-09-08 19:55:26,120] val_current @iteration 1700: 1.3102429127538755, val_predictor: 0
[INFO: 2020-09-08 19:55:26,120] mv_approxkl: 0.0028188439534525085
[INFO: 2020-09-08 20:01:53,394] ######## Iter (TEST) 1800 ########
[INFO: 2020-09-08 20:01:53,394] {'CIDEr': 1.3291860843552548}
[INFO: 2020-09-08 20:01:53,396] val_current @iteration 1800: 1.3117180302896658, val_predictor: 0
[INFO: 2020-09-08 20:01:53,396] mv_approxkl: 0.0026061337471161208
[INFO: 2020-09-08 20:08:21,022] ######## Iter (TEST) 1900 ########
[INFO: 2020-09-08 20:08:21,022] {'CIDEr': 1.330779622444943}
[INFO: 2020-09-08 20:08:21,024] val_current @iteration 1900: 1.3124489445945782, val_predictor: 0
[INFO: 2020-09-08 20:08:21,024] mv_approxkl: 0.0024909561106642303
[INFO: 2020-09-08 20:14:51,464] ######## Iter (TEST) 2000 ########
[INFO: 2020-09-08 20:14:51,464] {'CIDEr': 1.3320557976098428}
[INFO: 2020-09-08 20:14:51,466] val_current @iteration 2000: 1.3119820056833764, val_predictor: 0
[INFO: 2020-09-08 20:14:51,466] mv_approxkl: 0.0032459906296991065
[INFO: 2020-09-08 20:21:18,042] ######## Iter (TEST) 2100 ########
[INFO: 2020-09-08 20:21:18,042] {'CIDEr': 1.3331121447486955}
[INFO: 2020-09-08 20:21:18,044] val_current @iteration 2100: 1.3113508281349169, val_predictor: 0
[INFO: 2020-09-08 20:21:18,044] mv_approxkl: 0.003256261041350941
[INFO: 2020-09-08 20:27:47,826] ######## Iter (TEST) 2200 ########
[INFO: 2020-09-08 20:27:47,826] {'CIDEr': 1.3289320484603329}
[INFO: 2020-09-08 20:27:47,828] val_current @iteration 2200: 1.309508841983032, val_predictor: 0
[INFO: 2020-09-08 20:27:47,828] mv_approxkl: 0.0027838662815266742
[INFO: 2020-09-08 20:34:13,439] ######## Iter (TEST) 2300 ########
[INFO: 2020-09-08 20:34:13,440] {'CIDEr': 1.3290105120377322}
[INFO: 2020-09-08 20:34:13,442] val_current @iteration 2300: 1.3139072451863962, val_predictor: 0
[INFO: 2020-09-08 20:34:13,442] mv_approxkl: 0.004327316303652537
[INFO: 2020-09-08 20:40:41,549] ######## Iter (TEST) 2400 ########
[INFO: 2020-09-08 20:40:41,549] {'CIDEr': 1.3268287368462304}
[INFO: 2020-09-08 20:40:41,551] val_current @iteration 2400: 1.3095568282989876, val_predictor: 0
[INFO: 2020-09-08 20:40:41,551] mv_approxkl: 0.0029066905605469044
[INFO: 2020-09-08 20:47:09,269] ######## Iter (TEST) 2500 ########
[INFO: 2020-09-08 20:47:09,269] {'CIDEr': 1.3229294316946394}
[INFO: 2020-09-08 20:47:09,272] val_current @iteration 2500: 1.3092998484459428, val_predictor: 0
[INFO: 2020-09-08 20:47:09,272] mv_approxkl: 0.0033891390250485897
[INFO: 2020-09-08 20:47:25,930] Training with config:
[INFO: 2020-09-08 20:47:25,932] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 20:47:42,704] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-08 20:48:04,006] Training with config:
[INFO: 2020-09-08 20:48:04,008] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 20:48:20,965] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-08 20:54:50,120] ######## Iter (TEST) 100 ########
[INFO: 2020-09-08 20:54:50,121] {'CIDEr': 1.3234814089165572}
[INFO: 2020-09-08 20:54:50,122] val_current @iteration 100: 1.313358124354709, val_predictor: 0
[INFO: 2020-09-08 20:54:50,123] mv_approxkl: 0.004234512055070837
[INFO: 2020-09-08 21:01:21,524] ######## Iter (TEST) 200 ########
[INFO: 2020-09-08 21:01:21,525] {'CIDEr': 1.3236789201070414}
[INFO: 2020-09-08 21:01:21,526] val_current @iteration 200: 1.3100118200980029, val_predictor: 0
[INFO: 2020-09-08 21:01:21,527] mv_approxkl: 0.0030357537083979583
[INFO: 2020-09-08 21:07:51,151] ######## Iter (TEST) 300 ########
[INFO: 2020-09-08 21:07:51,151] {'CIDEr': 1.3291451780419168}
[INFO: 2020-09-08 21:07:51,153] val_current @iteration 300: 1.3120353561186981, val_predictor: 0
[INFO: 2020-09-08 21:07:51,153] mv_approxkl: 0.00294180210950613
[INFO: 2020-09-08 21:14:20,994] ######## Iter (TEST) 400 ########
[INFO: 2020-09-08 21:14:20,994] {'CIDEr': 1.3257399991481125}
[INFO: 2020-09-08 21:14:20,996] val_current @iteration 400: 1.315323542724147, val_predictor: 0
[INFO: 2020-09-08 21:14:20,996] mv_approxkl: 0.0030572475545716862
[INFO: 2020-09-08 21:20:49,730] ######## Iter (TEST) 500 ########
[INFO: 2020-09-08 21:20:49,730] {'CIDEr': 1.3289536366168235}
[INFO: 2020-09-08 21:20:49,733] val_current @iteration 500: 1.3116270177235672, val_predictor: 0
[INFO: 2020-09-08 21:20:49,734] mv_approxkl: 0.002744723229322355
[INFO: 2020-09-08 21:27:16,252] ######## Iter (TEST) 600 ########
[INFO: 2020-09-08 21:27:16,252] {'CIDEr': 1.3286520606029348}
[INFO: 2020-09-08 21:27:16,254] val_current @iteration 600: 1.31526168163885, val_predictor: 0
[INFO: 2020-09-08 21:27:16,254] mv_approxkl: 0.0029909247270456752
[INFO: 2020-09-08 21:33:47,423] ######## Iter (TEST) 700 ########
[INFO: 2020-09-08 21:33:47,423] {'CIDEr': 1.3250152168152238}
[INFO: 2020-09-08 21:33:47,425] val_current @iteration 700: 1.3135854108284282, val_predictor: 0
[INFO: 2020-09-08 21:33:47,425] mv_approxkl: 0.004010863356889719
[INFO: 2020-09-08 21:40:17,903] ######## Iter (TEST) 800 ########
[INFO: 2020-09-08 21:40:17,904] {'CIDEr': 1.3243980782591582}
[INFO: 2020-09-08 21:40:17,905] val_current @iteration 800: 1.3139920363141557, val_predictor: 0
[INFO: 2020-09-08 21:40:17,905] mv_approxkl: 0.004361995940205603
[INFO: 2020-09-08 21:40:32,192] Training with config:
[INFO: 2020-09-08 21:40:32,194] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-08 21:40:49,241] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-08 21:47:20,120] ######## Iter (TEST) 100 ########
[INFO: 2020-09-08 21:47:20,120] {'CIDEr': 1.3236883351424624}
[INFO: 2020-09-08 21:47:20,122] val_current @iteration 100: 1.312631763926718, val_predictor: 0
[INFO: 2020-09-08 21:47:20,122] mv_approxkl: 0.003765102649494091
[INFO: 2020-09-08 21:53:51,013] ######## Iter (TEST) 200 ########
[INFO: 2020-09-08 21:53:51,013] {'CIDEr': 1.3247828564396171}
[INFO: 2020-09-08 21:53:51,015] val_current @iteration 200: 1.3115357508230423, val_predictor: 0
[INFO: 2020-09-08 21:53:51,015] mv_approxkl: 0.002377013042361752
[INFO: 2020-09-08 22:00:21,247] ######## Iter (TEST) 300 ########
[INFO: 2020-09-08 22:00:21,247] {'CIDEr': 1.3252346485806008}
[INFO: 2020-09-08 22:00:21,249] val_current @iteration 300: 1.3103061847763964, val_predictor: 0
[INFO: 2020-09-08 22:00:21,249] mv_approxkl: 0.003493071985375172
[INFO: 2020-09-08 22:06:49,389] ######## Iter (TEST) 400 ########
[INFO: 2020-09-08 22:06:49,390] {'CIDEr': 1.327399272453131}
[INFO: 2020-09-08 22:06:49,391] val_current @iteration 400: 1.312911947545823, val_predictor: 0
[INFO: 2020-09-08 22:06:49,391] mv_approxkl: 0.00313073486228714
[INFO: 2020-09-08 22:13:17,135] ######## Iter (TEST) 500 ########
[INFO: 2020-09-08 22:13:17,135] {'CIDEr': 1.3281899338205894}
[INFO: 2020-09-08 22:13:17,137] val_current @iteration 500: 1.310775673925973, val_predictor: 0
[INFO: 2020-09-08 22:13:17,137] mv_approxkl: 0.0029402970514570367
[INFO: 2020-09-08 22:19:44,139] ######## Iter (TEST) 600 ########
[INFO: 2020-09-08 22:19:44,139] {'CIDEr': 1.3270999691540404}
[INFO: 2020-09-08 22:19:44,141] val_current @iteration 600: 1.3109366113790364, val_predictor: 0
[INFO: 2020-09-08 22:19:44,141] mv_approxkl: 0.0027551618576538814
[INFO: 2020-09-08 22:26:15,028] ######## Iter (TEST) 700 ########
[INFO: 2020-09-08 22:26:15,028] {'CIDEr': 1.3293454833235478}
[INFO: 2020-09-08 22:26:15,030] val_current @iteration 700: 1.3127632854328806, val_predictor: 0
[INFO: 2020-09-08 22:26:15,030] mv_approxkl: 0.0029529731030631195
[INFO: 2020-09-08 22:32:44,791] ######## Iter (TEST) 800 ########
[INFO: 2020-09-08 22:32:44,792] {'CIDEr': 1.3329268287156457}
[INFO: 2020-09-08 22:32:44,793] val_current @iteration 800: 1.3139259859239647, val_predictor: 0
[INFO: 2020-09-08 22:32:44,794] mv_approxkl: 0.002973321794755789
[INFO: 2020-09-08 22:39:12,584] ######## Iter (TEST) 900 ########
[INFO: 2020-09-08 22:39:12,584] {'CIDEr': 1.3307939789599779}
[INFO: 2020-09-08 22:39:12,586] val_current @iteration 900: 1.3159008880304277, val_predictor: 0
[INFO: 2020-09-08 22:39:12,586] mv_approxkl: 0.002255346058868491
[INFO: 2020-09-08 22:45:43,598] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-08 22:45:43,598] {'CIDEr': 1.3325470007093974}
[INFO: 2020-09-08 22:45:43,600] val_current @iteration 1000: 1.3136234224469265, val_predictor: 0
[INFO: 2020-09-08 22:45:43,600] mv_approxkl: 0.0029336599124931586
[INFO: 2020-09-08 22:52:10,636] ######## Iter (TEST) 1100 ########
[INFO: 2020-09-08 22:52:10,636] {'CIDEr': 1.3335064016475093}
[INFO: 2020-09-08 22:52:10,638] val_current @iteration 1100: 1.310547354219421, val_predictor: 0
[INFO: 2020-09-08 22:52:10,638] mv_approxkl: 0.0030269321946282887
[INFO: 2020-09-08 22:58:39,726] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-08 22:58:39,726] {'CIDEr': 1.330980882478389}
[INFO: 2020-09-08 22:58:39,728] val_current @iteration 1200: 1.3126558741210756, val_predictor: 0
[INFO: 2020-09-08 22:58:39,728] mv_approxkl: 0.0027248352941503335
[INFO: 2020-09-08 23:05:09,653] ######## Iter (TEST) 1300 ########
[INFO: 2020-09-08 23:05:09,654] {'CIDEr': 1.332363235307865}
[INFO: 2020-09-08 23:05:09,655] val_current @iteration 1300: 1.3163825656003283, val_predictor: 0
[INFO: 2020-09-08 23:05:09,656] mv_approxkl: 0.002747683566293115
[INFO: 2020-09-08 23:11:38,062] ######## Iter (TEST) 1400 ########
[INFO: 2020-09-08 23:11:38,063] {'CIDEr': 1.3340154068385042}
[INFO: 2020-09-08 23:11:38,064] val_current @iteration 1400: 1.3177662558329848, val_predictor: 0
[INFO: 2020-09-08 23:11:38,065] mv_approxkl: 0.00278214598878378
[INFO: 2020-09-08 23:18:06,863] ######## Iter (TEST) 1500 ########
[INFO: 2020-09-08 23:18:06,864] {'CIDEr': 1.3337879629514853}
[INFO: 2020-09-08 23:18:06,865] val_current @iteration 1500: 1.316331882985446, val_predictor: 0
[INFO: 2020-09-08 23:18:06,866] mv_approxkl: 0.002135498553177502
[INFO: 2020-09-08 23:24:37,657] ######## Iter (TEST) 1600 ########
[INFO: 2020-09-08 23:24:37,657] {'CIDEr': 1.3344072570203105}
[INFO: 2020-09-08 23:24:37,659] val_current @iteration 1600: 1.316712662924036, val_predictor: 0
[INFO: 2020-09-08 23:24:37,659] mv_approxkl: 0.0027427530288329904
[INFO: 2020-09-08 23:31:07,482] ######## Iter (TEST) 1700 ########
[INFO: 2020-09-08 23:31:07,482] {'CIDEr': 1.3315351647212996}
[INFO: 2020-09-08 23:31:07,484] val_current @iteration 1700: 1.317463300094762, val_predictor: 0
[INFO: 2020-09-08 23:31:07,484] mv_approxkl: 0.0031997191206315006
[INFO: 2020-09-08 23:37:38,527] ######## Iter (TEST) 1800 ########
[INFO: 2020-09-08 23:37:38,528] {'CIDEr': 1.3300904478143039}
[INFO: 2020-09-08 23:37:38,529] val_current @iteration 1800: 1.3166927436613531, val_predictor: 0
[INFO: 2020-09-08 23:37:38,529] mv_approxkl: 0.002712449342468315
[INFO: 2020-09-08 23:44:10,363] ######## Iter (TEST) 1900 ########
[INFO: 2020-09-08 23:44:10,363] {'CIDEr': 1.3286385376236463}
[INFO: 2020-09-08 23:44:10,365] val_current @iteration 1900: 1.3125191677765198, val_predictor: 0
[INFO: 2020-09-08 23:44:10,365] mv_approxkl: 0.0030472949558215984
[INFO: 2020-09-08 23:50:40,521] ######## Iter (TEST) 2000 ########
[INFO: 2020-09-08 23:50:40,522] {'CIDEr': 1.3269082083436767}
[INFO: 2020-09-08 23:50:40,523] val_current @iteration 2000: 1.3160763899372372, val_predictor: 0
[INFO: 2020-09-08 23:50:40,523] mv_approxkl: 0.0028786058277902294
[INFO: 2020-09-08 23:57:08,262] ######## Iter (TEST) 2100 ########
[INFO: 2020-09-08 23:57:08,262] {'CIDEr': 1.3278306136448208}
[INFO: 2020-09-08 23:57:08,264] val_current @iteration 2100: 1.313851451786292, val_predictor: 0
[INFO: 2020-09-08 23:57:08,264] mv_approxkl: 0.002243090970278935
[INFO: 2020-09-09 00:03:37,912] ######## Iter (TEST) 2200 ########
[INFO: 2020-09-09 00:03:37,912] {'CIDEr': 1.3315000386108158}
[INFO: 2020-09-09 00:03:37,914] val_current @iteration 2200: 1.3117659465196494, val_predictor: 0
[INFO: 2020-09-09 00:03:37,914] mv_approxkl: 0.0027948497601647487
[INFO: 2020-09-09 00:05:26,698] Training with config:
[INFO: 2020-09-09 00:05:26,700] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 00:05:43,419] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 00:12:13,682] ######## Iter (TEST) 100 ########
[INFO: 2020-09-09 00:12:13,682] {'CIDEr': 1.3240586294248955}
[INFO: 2020-09-09 00:12:13,684] val_current @iteration 100: 1.3137794591638248, val_predictor: 0
[INFO: 2020-09-09 00:12:13,684] mv_approxkl: 0.003494017216183907
[INFO: 2020-09-09 00:18:43,468] ######## Iter (TEST) 200 ########
[INFO: 2020-09-09 00:18:43,468] {'CIDEr': 1.3261043988013868}
[INFO: 2020-09-09 00:18:43,470] val_current @iteration 200: 1.311977554344874, val_predictor: 0
[INFO: 2020-09-09 00:18:43,470] mv_approxkl: 0.0021271458907835532
[INFO: 2020-09-09 00:25:15,252] ######## Iter (TEST) 300 ########
[INFO: 2020-09-09 00:25:15,252] {'CIDEr': 1.3284322216199735}
[INFO: 2020-09-09 00:25:15,254] val_current @iteration 300: 1.3133763854995333, val_predictor: 0
[INFO: 2020-09-09 00:25:15,254] mv_approxkl: 0.002737698624865166
[INFO: 2020-09-09 00:31:45,236] ######## Iter (TEST) 400 ########
[INFO: 2020-09-09 00:31:45,236] {'CIDEr': 1.329165574866733}
[INFO: 2020-09-09 00:31:45,238] val_current @iteration 400: 1.316869449583508, val_predictor: 0
[INFO: 2020-09-09 00:31:45,238] mv_approxkl: 0.002721815821710747
[INFO: 2020-09-09 00:38:16,479] ######## Iter (TEST) 500 ########
[INFO: 2020-09-09 00:38:16,479] {'CIDEr': 1.3297202201970197}
[INFO: 2020-09-09 00:38:16,481] val_current @iteration 500: 1.3172553176350368, val_predictor: 0
[INFO: 2020-09-09 00:38:16,481] mv_approxkl: 0.0023489370847213737
[INFO: 2020-09-09 00:44:46,512] ######## Iter (TEST) 600 ########
[INFO: 2020-09-09 00:44:46,513] {'CIDEr': 1.3288451811544608}
[INFO: 2020-09-09 00:44:46,514] val_current @iteration 600: 1.3149331892674365, val_predictor: 0
[INFO: 2020-09-09 00:44:46,515] mv_approxkl: 0.0026967818389842507
[INFO: 2020-09-09 00:51:17,736] ######## Iter (TEST) 700 ########
[INFO: 2020-09-09 00:51:17,737] {'CIDEr': 1.3301878602088728}
[INFO: 2020-09-09 00:51:17,739] val_current @iteration 700: 1.3140928283758577, val_predictor: 0
[INFO: 2020-09-09 00:51:17,739] mv_approxkl: 0.0027762717825733085
[INFO: 2020-09-09 00:57:48,197] ######## Iter (TEST) 800 ########
[INFO: 2020-09-09 00:57:48,198] {'CIDEr': 1.328482805005266}
[INFO: 2020-09-09 00:57:48,199] val_current @iteration 800: 1.3142988378796543, val_predictor: 0
[INFO: 2020-09-09 00:57:48,200] mv_approxkl: 0.003168553427038069
[INFO: 2020-09-09 01:04:18,709] ######## Iter (TEST) 900 ########
[INFO: 2020-09-09 01:04:18,710] {'CIDEr': 1.3289359277888324}
[INFO: 2020-09-09 01:04:18,711] val_current @iteration 900: 1.3144364440901772, val_predictor: 0
[INFO: 2020-09-09 01:04:18,711] mv_approxkl: 0.0028330739040465527
[INFO: 2020-09-09 01:10:50,788] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-09 01:10:50,788] {'CIDEr': 1.3308389849508202}
[INFO: 2020-09-09 01:10:50,790] val_current @iteration 1000: 1.3159301655602682, val_predictor: 0
[INFO: 2020-09-09 01:10:50,790] mv_approxkl: 0.0022414069956867557
[INFO: 2020-09-09 01:17:20,190] ######## Iter (TEST) 1100 ########
[INFO: 2020-09-09 01:17:20,190] {'CIDEr': 1.3306476815240516}
[INFO: 2020-09-09 01:17:20,192] val_current @iteration 1100: 1.3168538582681066, val_predictor: 0
[INFO: 2020-09-09 01:17:20,192] mv_approxkl: 0.0025191668311313757
[INFO: 2020-09-09 01:23:49,718] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-09 01:23:49,718] {'CIDEr': 1.3294797401836589}
[INFO: 2020-09-09 01:23:49,720] val_current @iteration 1200: 1.3152995525133138, val_predictor: 0
[INFO: 2020-09-09 01:23:49,720] mv_approxkl: 0.0032787624900517294
[INFO: 2020-09-09 01:30:22,046] ######## Iter (TEST) 1300 ########
[INFO: 2020-09-09 01:30:22,046] {'CIDEr': 1.3313025697530836}
[INFO: 2020-09-09 01:30:22,048] val_current @iteration 1300: 1.3132952736900054, val_predictor: 0
[INFO: 2020-09-09 01:30:22,048] mv_approxkl: 0.003287573862890111
[INFO: 2020-09-09 01:36:51,128] ######## Iter (TEST) 1400 ########
[INFO: 2020-09-09 01:36:51,129] {'CIDEr': 1.3300875088033524}
[INFO: 2020-09-09 01:36:51,130] val_current @iteration 1400: 1.3152497099201854, val_predictor: 0
[INFO: 2020-09-09 01:36:51,131] mv_approxkl: 0.002519254147204859
[INFO: 2020-09-09 01:43:21,136] ######## Iter (TEST) 1500 ########
[INFO: 2020-09-09 01:43:21,137] {'CIDEr': 1.330746100433211}
[INFO: 2020-09-09 01:43:21,139] val_current @iteration 1500: 1.3153433027220538, val_predictor: 0
[INFO: 2020-09-09 01:43:21,139] mv_approxkl: 0.002328054927516749
[INFO: 2020-09-09 01:49:50,661] ######## Iter (TEST) 1600 ########
[INFO: 2020-09-09 01:49:50,662] {'CIDEr': 1.3302280326892528}
[INFO: 2020-09-09 01:49:50,663] val_current @iteration 1600: 1.3130480158542104, val_predictor: 0
[INFO: 2020-09-09 01:49:50,664] mv_approxkl: 0.0023107581258763527
[INFO: 2020-09-09 01:56:18,138] ######## Iter (TEST) 1700 ########
[INFO: 2020-09-09 01:56:18,138] {'CIDEr': 1.3301787756234522}
[INFO: 2020-09-09 01:56:18,140] val_current @iteration 1700: 1.3121016509731986, val_predictor: 0
[INFO: 2020-09-09 01:56:18,140] mv_approxkl: 0.0024419216017524496
[INFO: 2020-09-09 02:02:47,497] ######## Iter (TEST) 1800 ########
[INFO: 2020-09-09 02:02:47,497] {'CIDEr': 1.3291865481500227}
[INFO: 2020-09-09 02:02:47,499] val_current @iteration 1800: 1.3133314482249823, val_predictor: 0
[INFO: 2020-09-09 02:02:47,499] mv_approxkl: 0.0034607741767303224
[INFO: 2020-09-09 02:09:15,537] ######## Iter (TEST) 1900 ########
[INFO: 2020-09-09 02:09:15,538] {'CIDEr': 1.33112011591915}
[INFO: 2020-09-09 02:09:15,539] val_current @iteration 1900: 1.3121401075918235, val_predictor: 0
[INFO: 2020-09-09 02:09:15,539] mv_approxkl: 0.002555086734818389
[INFO: 2020-09-09 02:15:43,942] ######## Iter (TEST) 2000 ########
[INFO: 2020-09-09 02:15:43,942] {'CIDEr': 1.330387296324976}
[INFO: 2020-09-09 02:15:43,944] val_current @iteration 2000: 1.3084637215285082, val_predictor: 0
[INFO: 2020-09-09 02:15:43,944] mv_approxkl: 0.0027681074021180187
[INFO: 2020-09-09 02:22:09,757] ######## Iter (TEST) 2100 ########
[INFO: 2020-09-09 02:22:09,758] {'CIDEr': 1.3300385861953512}
[INFO: 2020-09-09 02:22:09,760] val_current @iteration 2100: 1.3077344238031332, val_predictor: 0
[INFO: 2020-09-09 02:22:09,760] mv_approxkl: 0.0026553866036694435
[INFO: 2020-09-09 02:28:36,515] ######## Iter (TEST) 2200 ########
[INFO: 2020-09-09 02:28:36,515] {'CIDEr': 1.3299059217411147}
[INFO: 2020-09-09 02:28:36,517] val_current @iteration 2200: 1.3067393136335181, val_predictor: 0
[INFO: 2020-09-09 02:28:36,517] mv_approxkl: 0.0035036532900511795
[INFO: 2020-09-09 02:35:02,295] ######## Iter (TEST) 2300 ########
[INFO: 2020-09-09 02:35:02,295] {'CIDEr': 1.3288969830581823}
[INFO: 2020-09-09 02:35:02,297] val_current @iteration 2300: 1.3067963771281437, val_predictor: 0
[INFO: 2020-09-09 02:35:02,297] mv_approxkl: 0.003565149092181986
[INFO: 2020-09-09 02:41:29,948] ######## Iter (TEST) 2400 ########
[INFO: 2020-09-09 02:41:29,948] {'CIDEr': 1.331855774162568}
[INFO: 2020-09-09 02:41:29,950] val_current @iteration 2400: 1.3102673576178088, val_predictor: 0
[INFO: 2020-09-09 02:41:29,950] mv_approxkl: 0.0030562841460400883
[INFO: 2020-09-09 02:47:57,469] ######## Iter (TEST) 2500 ########
[INFO: 2020-09-09 02:47:57,469] {'CIDEr': 1.3310602956089934}
[INFO: 2020-09-09 02:47:57,471] val_current @iteration 2500: 1.3107883243245673, val_predictor: 0
[INFO: 2020-09-09 02:47:57,471] mv_approxkl: 0.0029421548986908815
[INFO: 2020-09-09 02:54:24,919] ######## Iter (TEST) 2600 ########
[INFO: 2020-09-09 02:54:24,919] {'CIDEr': 1.32907740056444}
[INFO: 2020-09-09 02:54:24,921] val_current @iteration 2600: 1.3109008957692034, val_predictor: 0
[INFO: 2020-09-09 02:54:24,921] mv_approxkl: 0.002646884672733959
[INFO: 2020-09-09 03:00:50,877] ######## Iter (TEST) 2700 ########
[INFO: 2020-09-09 03:00:50,877] {'CIDEr': 1.329783130803727}
[INFO: 2020-09-09 03:00:50,879] val_current @iteration 2700: 1.3105565234889793, val_predictor: 0
[INFO: 2020-09-09 03:00:50,879] mv_approxkl: 0.003113519230166151
[INFO: 2020-09-09 03:07:16,921] ######## Iter (TEST) 2800 ########
[INFO: 2020-09-09 03:07:16,921] {'CIDEr': 1.330125216709923}
[INFO: 2020-09-09 03:07:16,923] val_current @iteration 2800: 1.3103859757621308, val_predictor: 0
[INFO: 2020-09-09 03:07:16,923] mv_approxkl: 0.003956661727844294
[INFO: 2020-09-09 03:13:42,548] ######## Iter (TEST) 2900 ########
[INFO: 2020-09-09 03:13:42,548] {'CIDEr': 1.3270152128685442}
[INFO: 2020-09-09 03:13:42,550] val_current @iteration 2900: 1.3046749309425192, val_predictor: 0
[INFO: 2020-09-09 03:13:42,550] mv_approxkl: 0.0028775194494921265
[INFO: 2020-09-09 03:20:07,703] ######## Iter (TEST) 3000 ########
[INFO: 2020-09-09 03:20:07,703] {'CIDEr': 1.3315773516991987}
[INFO: 2020-09-09 03:20:07,705] val_current @iteration 3000: 1.3100816021429618, val_predictor: 0
[INFO: 2020-09-09 03:20:07,705] mv_approxkl: 0.0026392027810638557
[INFO: 2020-09-09 03:26:33,967] ######## Iter (TEST) 3100 ########
[INFO: 2020-09-09 03:26:33,967] {'CIDEr': 1.329220225330123}
[INFO: 2020-09-09 03:26:33,969] val_current @iteration 3100: 1.3090019495514422, val_predictor: 0
[INFO: 2020-09-09 03:26:33,969] mv_approxkl: 0.00248154603795514
[INFO: 2020-09-09 03:32:59,561] ######## Iter (TEST) 3200 ########
[INFO: 2020-09-09 03:32:59,561] {'CIDEr': 1.3288214794470943}
[INFO: 2020-09-09 03:32:59,563] val_current @iteration 3200: 1.3096511761656202, val_predictor: 0
[INFO: 2020-09-09 03:32:59,563] mv_approxkl: 0.003021679553570184
[INFO: 2020-09-09 03:39:27,149] ######## Iter (TEST) 3300 ########
[INFO: 2020-09-09 03:39:27,150] {'CIDEr': 1.3281737856348925}
[INFO: 2020-09-09 03:39:27,151] val_current @iteration 3300: 1.309560223157864, val_predictor: 0
[INFO: 2020-09-09 03:39:27,151] mv_approxkl: 0.002912485469011063
[INFO: 2020-09-09 03:45:54,350] ######## Iter (TEST) 3400 ########
[INFO: 2020-09-09 03:45:54,350] {'CIDEr': 1.3312337430951826}
[INFO: 2020-09-09 03:45:54,352] val_current @iteration 3400: 1.308285157640353, val_predictor: 0
[INFO: 2020-09-09 03:45:54,352] mv_approxkl: 0.0031930011758818425
[INFO: 2020-09-09 03:52:21,928] ######## Iter (TEST) 3500 ########
[INFO: 2020-09-09 03:52:21,928] {'CIDEr': 1.3304206886745131}
[INFO: 2020-09-09 03:52:21,930] val_current @iteration 3500: 1.308431592897068, val_predictor: 0
[INFO: 2020-09-09 03:52:21,930] mv_approxkl: 0.0028757727987245977
[INFO: 2020-09-09 03:58:52,716] ######## Iter (TEST) 3600 ########
[INFO: 2020-09-09 03:58:52,716] {'CIDEr': 1.3302108479650196}
[INFO: 2020-09-09 03:58:52,718] val_current @iteration 3600: 1.3089015533211623, val_predictor: 0
[INFO: 2020-09-09 03:58:52,718] mv_approxkl: 0.0035416631418296726
[INFO: 2020-09-09 04:05:19,362] ######## Iter (TEST) 3700 ########
[INFO: 2020-09-09 04:05:19,362] {'CIDEr': 1.328669111511875}
[INFO: 2020-09-09 04:05:19,364] val_current @iteration 3700: 1.3094596610227065, val_predictor: 0
[INFO: 2020-09-09 04:05:19,364] mv_approxkl: 0.0029618562460777256
[INFO: 2020-09-09 04:11:44,652] ######## Iter (TEST) 3800 ########
[INFO: 2020-09-09 04:11:44,652] {'CIDEr': 1.3304353953276866}
[INFO: 2020-09-09 04:11:44,654] val_current @iteration 3800: 1.3086037702169635, val_predictor: 0
[INFO: 2020-09-09 04:11:44,654] mv_approxkl: 0.003022306665900777
[INFO: 2020-09-09 04:18:12,220] ######## Iter (TEST) 3900 ########
[INFO: 2020-09-09 04:18:12,221] {'CIDEr': 1.3318665481118968}
[INFO: 2020-09-09 04:18:12,222] val_current @iteration 3900: 1.3089371559722534, val_predictor: 0
[INFO: 2020-09-09 04:18:12,222] mv_approxkl: 0.002453309538241735
[INFO: 2020-09-09 04:24:39,033] ######## Iter (TEST) 4000 ########
[INFO: 2020-09-09 04:24:39,033] {'CIDEr': 1.331644658929067}
[INFO: 2020-09-09 04:24:39,035] val_current @iteration 4000: 1.3081033994490856, val_predictor: 0
[INFO: 2020-09-09 04:24:39,035] mv_approxkl: 0.0034484019717925377
[INFO: 2020-09-09 04:31:06,873] ######## Iter (TEST) 4100 ########
[INFO: 2020-09-09 04:31:06,873] {'CIDEr': 1.3300421218303087}
[INFO: 2020-09-09 04:31:06,875] val_current @iteration 4100: 1.3114247843895457, val_predictor: 0
[INFO: 2020-09-09 04:31:06,875] mv_approxkl: 0.002733478429958042
[INFO: 2020-09-09 04:37:33,038] ######## Iter (TEST) 4200 ########
[INFO: 2020-09-09 04:37:33,038] {'CIDEr': 1.3299437747243876}
[INFO: 2020-09-09 04:37:33,040] val_current @iteration 4200: 1.3103133283667827, val_predictor: 0
[INFO: 2020-09-09 04:37:33,040] mv_approxkl: 0.0036745118163152603
[INFO: 2020-09-09 04:44:00,674] ######## Iter (TEST) 4300 ########
[INFO: 2020-09-09 04:44:00,675] {'CIDEr': 1.3301385640551053}
[INFO: 2020-09-09 04:44:00,676] val_current @iteration 4300: 1.3066350990187967, val_predictor: 0
[INFO: 2020-09-09 04:44:00,677] mv_approxkl: 0.003179137343220736
[INFO: 2020-09-09 04:50:27,341] ######## Iter (TEST) 4400 ########
[INFO: 2020-09-09 04:50:27,341] {'CIDEr': 1.3265841809223458}
[INFO: 2020-09-09 04:50:27,343] val_current @iteration 4400: 1.3083348274082476, val_predictor: 0
[INFO: 2020-09-09 04:50:27,343] mv_approxkl: 0.0027528113025432166
[INFO: 2020-09-09 04:56:55,694] ######## Iter (TEST) 4500 ########
[INFO: 2020-09-09 04:56:55,695] {'CIDEr': 1.3261856788664332}
[INFO: 2020-09-09 04:56:55,696] val_current @iteration 4500: 1.3075845424695556, val_predictor: 0
[INFO: 2020-09-09 04:56:55,696] mv_approxkl: 0.0030007031135511715
[INFO: 2020-09-09 05:03:23,054] ######## Iter (TEST) 4600 ########
[INFO: 2020-09-09 05:03:23,054] {'CIDEr': 1.328708882113094}
[INFO: 2020-09-09 05:03:23,056] val_current @iteration 4600: 1.3063431173130453, val_predictor: 0
[INFO: 2020-09-09 05:03:23,056] mv_approxkl: 0.0026145712077677743
[INFO: 2020-09-09 05:09:50,448] ######## Iter (TEST) 4700 ########
[INFO: 2020-09-09 05:09:50,448] {'CIDEr': 1.323371334830195}
[INFO: 2020-09-09 05:09:50,450] val_current @iteration 4700: 1.3071530320820428, val_predictor: 0
[INFO: 2020-09-09 05:09:50,450] mv_approxkl: 0.0032940663031689526
[INFO: 2020-09-09 05:16:18,042] ######## Iter (TEST) 4800 ########
[INFO: 2020-09-09 05:16:18,043] {'CIDEr': 1.3264303614539619}
[INFO: 2020-09-09 05:16:18,045] val_current @iteration 4800: 1.3077203407999918, val_predictor: 0
[INFO: 2020-09-09 05:16:18,045] mv_approxkl: 0.0025726182583026692
[INFO: 2020-09-09 05:22:45,501] ######## Iter (TEST) 4900 ########
[INFO: 2020-09-09 05:22:45,501] {'CIDEr': 1.3250270268917894}
[INFO: 2020-09-09 05:22:45,503] val_current @iteration 4900: 1.3079338740946198, val_predictor: 0
[INFO: 2020-09-09 05:22:45,503] mv_approxkl: 0.004138540127029588
[INFO: 2020-09-09 05:29:10,954] ######## Iter (TEST) 5000 ########
[INFO: 2020-09-09 05:29:10,954] {'CIDEr': 1.3288541881484182}
[INFO: 2020-09-09 05:29:10,956] val_current @iteration 5000: 1.3089906868768513, val_predictor: 0
[INFO: 2020-09-09 05:29:10,956] mv_approxkl: 0.0036219196687021947
[INFO: 2020-09-09 05:33:09,226] Training with config:
[INFO: 2020-09-09 05:33:09,227] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 05:33:25,792] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 05:34:02,025] Training with config:
[INFO: 2020-09-09 05:34:02,027] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 05:34:18,635] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 05:40:50,089] ######## Iter (TEST) 100 ########
[INFO: 2020-09-09 05:40:50,089] {'CIDEr': 1.3261718803634912}
[INFO: 2020-09-09 05:40:50,091] val_current @iteration 100: 1.3133690367112956, val_predictor: 0
[INFO: 2020-09-09 05:40:50,091] mv_approxkl: 0.0010617297653598662
[INFO: 2020-09-09 05:40:50,091] mv_entropy: 0.0935531222853796
[INFO: 2020-09-09 05:47:19,963] ######## Iter (TEST) 200 ########
[INFO: 2020-09-09 05:47:19,963] {'CIDEr': 1.3262318269322482}
[INFO: 2020-09-09 05:47:19,965] val_current @iteration 200: 1.3108654577817453, val_predictor: 0
[INFO: 2020-09-09 05:47:19,965] mv_approxkl: 0.0007086596905747243
[INFO: 2020-09-09 05:47:19,965] mv_entropy: 0.09028315414754082
[INFO: 2020-09-09 05:50:16,849] ######## Epoch 200 ########
[INFO: 2020-09-09 05:50:16,850] {'CIDEr': 1.3108654577817453}
[INFO: 2020-09-09 05:53:10,752] ######## Epoch 200 ########
[INFO: 2020-09-09 05:53:10,752] {'CIDEr': 1.3262318269322482}
[INFO: 2020-09-09 05:54:24,120] ######## Iter (TEST) 300 ########
[INFO: 2020-09-09 05:54:24,120] {'CIDEr': 1.327869543377874}
[INFO: 2020-09-09 05:54:24,122] val_current @iteration 300: 1.3148807503788777, val_predictor: 0
[INFO: 2020-09-09 05:54:24,122] mv_approxkl: 0.0008956974215557073
[INFO: 2020-09-09 05:54:24,122] mv_entropy: 0.09672888670999424
[INFO: 2020-09-09 06:00:52,196] ######## Iter (TEST) 400 ########
[INFO: 2020-09-09 06:00:52,196] {'CIDEr': 1.329474829703972}
[INFO: 2020-09-09 06:00:52,198] val_current @iteration 400: 1.3156299929484065, val_predictor: 0
[INFO: 2020-09-09 06:00:52,198] mv_approxkl: 0.0007366851902109649
[INFO: 2020-09-09 06:00:52,198] mv_entropy: 0.09336487477979154
[INFO: 2020-09-09 06:07:18,985] ######## Iter (TEST) 500 ########
[INFO: 2020-09-09 06:07:18,985] {'CIDEr': 1.331359544050525}
[INFO: 2020-09-09 06:07:18,987] val_current @iteration 500: 1.3144884288341174, val_predictor: 0
[INFO: 2020-09-09 06:07:18,987] mv_approxkl: 0.0008318652422667825
[INFO: 2020-09-09 06:07:18,987] mv_entropy: 0.09195105180541968
[INFO: 2020-09-09 06:13:46,930] ######## Iter (TEST) 600 ########
[INFO: 2020-09-09 06:13:46,930] {'CIDEr': 1.3307703424367234}
[INFO: 2020-09-09 06:13:46,932] val_current @iteration 600: 1.3145634366102823, val_predictor: 0
[INFO: 2020-09-09 06:13:46,932] mv_approxkl: 0.0007884969862271306
[INFO: 2020-09-09 06:13:46,932] mv_entropy: 0.08854661021133653
[INFO: 2020-09-09 06:20:17,458] ######## Iter (TEST) 700 ########
[INFO: 2020-09-09 06:20:17,458] {'CIDEr': 1.3339000997314414}
[INFO: 2020-09-09 06:20:17,460] val_current @iteration 700: 1.3150348996551682, val_predictor: 0
[INFO: 2020-09-09 06:20:17,460] mv_approxkl: 0.000685930474676437
[INFO: 2020-09-09 06:20:17,460] mv_entropy: 0.09635749779515469
[INFO: 2020-09-09 06:26:46,509] ######## Iter (TEST) 800 ########
[INFO: 2020-09-09 06:26:46,510] {'CIDEr': 1.3336800474931365}
[INFO: 2020-09-09 06:26:46,511] val_current @iteration 800: 1.3158501357027663, val_predictor: 0
[INFO: 2020-09-09 06:26:46,511] mv_approxkl: 0.0007633142067649845
[INFO: 2020-09-09 06:26:46,511] mv_entropy: 0.09554428071454979
[INFO: 2020-09-09 06:33:16,146] ######## Iter (TEST) 900 ########
[INFO: 2020-09-09 06:33:16,146] {'CIDEr': 1.3354141348434496}
[INFO: 2020-09-09 06:33:16,148] val_current @iteration 900: 1.3161762280179845, val_predictor: 0
[INFO: 2020-09-09 06:33:16,148] mv_approxkl: 0.001044981856000654
[INFO: 2020-09-09 06:33:16,148] mv_entropy: 0.09553435325792865
[INFO: 2020-09-09 06:39:45,772] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-09 06:39:45,772] {'CIDEr': 1.334327151336551}
[INFO: 2020-09-09 06:39:45,774] val_current @iteration 1000: 1.316120116733392, val_predictor: 0
[INFO: 2020-09-09 06:39:45,774] mv_approxkl: 0.0008694823489903
[INFO: 2020-09-09 06:39:45,774] mv_entropy: 0.09323042630871324
[INFO: 2020-09-09 06:43:51,194] ######## Epoch 1000 ########
[INFO: 2020-09-09 06:43:51,194] {'CIDEr': 1.334327151336551}
[INFO: 2020-09-09 06:45:26,485] ######## Epoch 1000 ########
[INFO: 2020-09-09 06:45:26,485] {'CIDEr': 1.334327151336551}
[INFO: 2020-09-09 06:46:41,524] Training with config:
[INFO: 2020-09-09 06:46:41,526] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 06:47:30,540] Training with config:
[INFO: 2020-09-09 06:47:30,542] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 06:54:46,972] iteration 100
[INFO: 2020-09-09 06:55:46,242] ######## Iteration (TEST) 100 ########
[INFO: 2020-09-09 06:55:46,242] {'CIDEr': 1.3266523121140525}
[INFO: 2020-09-09 07:02:44,989] iteration 200
[INFO: 2020-09-09 07:03:44,880] ######## Iteration (TEST) 200 ########
[INFO: 2020-09-09 07:03:44,880] {'CIDEr': 1.3289525159941837}
[INFO: 2020-09-09 07:10:44,530] iteration 300
[INFO: 2020-09-09 07:11:44,835] ######## Iteration (TEST) 300 ########
[INFO: 2020-09-09 07:11:44,836] {'CIDEr': 1.3294724491797423}
[INFO: 2020-09-09 07:18:45,291] iteration 400
[INFO: 2020-09-09 07:19:45,404] ######## Iteration (TEST) 400 ########
[INFO: 2020-09-09 07:19:45,404] {'CIDEr': 1.3286319792678727}
[INFO: 2020-09-09 07:26:43,482] iteration 500
[INFO: 2020-09-09 07:27:43,021] ######## Iteration (TEST) 500 ########
[INFO: 2020-09-09 07:27:43,021] {'CIDEr': 1.3311294936009566}
[INFO: 2020-09-09 07:34:43,391] iteration 600
[INFO: 2020-09-09 07:35:43,441] ######## Iteration (TEST) 600 ########
[INFO: 2020-09-09 07:35:43,442] {'CIDEr': 1.3276326508780305}
[INFO: 2020-09-09 07:42:45,573] iteration 700
[INFO: 2020-09-09 07:43:47,863] ######## Iteration (TEST) 700 ########
[INFO: 2020-09-09 07:43:47,864] {'CIDEr': 1.3278008213622925}
[INFO: 2020-09-09 07:50:46,970] iteration 800
[INFO: 2020-09-09 07:51:48,743] ######## Iteration (TEST) 800 ########
[INFO: 2020-09-09 07:51:48,743] {'CIDEr': 1.3299847391150075}
[INFO: 2020-09-09 07:58:51,275] iteration 900
[INFO: 2020-09-09 07:59:53,375] ######## Iteration (TEST) 900 ########
[INFO: 2020-09-09 07:59:53,375] {'CIDEr': 1.3315512044584792}
[INFO: 2020-09-09 08:06:56,021] iteration 1000
[INFO: 2020-09-09 08:07:58,112] ######## Iteration (TEST) 1000 ########
[INFO: 2020-09-09 08:07:58,112] {'CIDEr': 1.3298201445438613}
[INFO: 2020-09-09 08:15:04,526] iteration 1100
[INFO: 2020-09-09 08:16:06,126] ######## Iteration (TEST) 1100 ########
[INFO: 2020-09-09 08:16:06,126] {'CIDEr': 1.3320921841018354}
[INFO: 2020-09-09 08:23:09,171] iteration 1200
[INFO: 2020-09-09 08:24:09,723] ######## Iteration (TEST) 1200 ########
[INFO: 2020-09-09 08:24:09,723] {'CIDEr': 1.3318631299463815}
[INFO: 2020-09-09 08:31:13,502] iteration 1300
[INFO: 2020-09-09 08:32:14,938] ######## Iteration (TEST) 1300 ########
[INFO: 2020-09-09 08:32:14,938] {'CIDEr': 1.330580923701658}
[INFO: 2020-09-09 08:39:15,862] iteration 1400
[INFO: 2020-09-09 08:40:16,764] ######## Iteration (TEST) 1400 ########
[INFO: 2020-09-09 08:40:16,764] {'CIDEr': 1.3325275543187811}
[INFO: 2020-09-09 08:47:18,572] iteration 1500
[INFO: 2020-09-09 08:48:19,182] ######## Iteration (TEST) 1500 ########
[INFO: 2020-09-09 08:48:19,182] {'CIDEr': 1.3286795602479675}
[INFO: 2020-09-09 08:55:19,702] iteration 1600
[INFO: 2020-09-09 08:56:20,718] ######## Iteration (TEST) 1600 ########
[INFO: 2020-09-09 08:56:20,718] {'CIDEr': 1.3293096158832647}
[INFO: 2020-09-09 09:03:23,467] iteration 1700
[INFO: 2020-09-09 09:04:25,429] ######## Iteration (TEST) 1700 ########
[INFO: 2020-09-09 09:04:25,429] {'CIDEr': 1.3275339171440634}
[INFO: 2020-09-09 09:11:29,437] iteration 1800
[INFO: 2020-09-09 09:12:30,382] ######## Iteration (TEST) 1800 ########
[INFO: 2020-09-09 09:12:30,382] {'CIDEr': 1.330387542680171}
[INFO: 2020-09-09 09:19:32,328] iteration 1900
[INFO: 2020-09-09 09:20:33,460] ######## Iteration (TEST) 1900 ########
[INFO: 2020-09-09 09:20:33,460] {'CIDEr': 1.332198978765534}
[INFO: 2020-09-09 09:27:37,078] iteration 2000
[INFO: 2020-09-09 09:28:38,171] ######## Iteration (TEST) 2000 ########
[INFO: 2020-09-09 09:28:38,172] {'CIDEr': 1.331933436010889}
[INFO: 2020-09-09 09:35:43,129] iteration 2100
[INFO: 2020-09-09 09:36:46,019] ######## Iteration (TEST) 2100 ########
[INFO: 2020-09-09 09:36:46,019] {'CIDEr': 1.3318967739167937}
[INFO: 2020-09-09 09:43:48,534] iteration 2200
[INFO: 2020-09-09 09:44:50,892] ######## Iteration (TEST) 2200 ########
[INFO: 2020-09-09 09:44:50,892] {'CIDEr': 1.3313268857488623}
[INFO: 2020-09-09 09:51:52,419] iteration 2300
[INFO: 2020-09-09 09:52:54,351] ######## Iteration (TEST) 2300 ########
[INFO: 2020-09-09 09:52:54,351] {'CIDEr': 1.3300207336321217}
[INFO: 2020-09-09 09:59:53,311] iteration 2400
[INFO: 2020-09-09 10:00:54,842] ######## Iteration (TEST) 2400 ########
[INFO: 2020-09-09 10:00:54,842] {'CIDEr': 1.3317040834853282}
[INFO: 2020-09-09 10:07:54,951] iteration 2500
[INFO: 2020-09-09 10:08:56,631] ######## Iteration (TEST) 2500 ########
[INFO: 2020-09-09 10:08:56,631] {'CIDEr': 1.3272983104996963}
[INFO: 2020-09-09 10:15:59,329] iteration 2600
[INFO: 2020-09-09 10:16:59,804] ######## Iteration (TEST) 2600 ########
[INFO: 2020-09-09 10:16:59,804] {'CIDEr': 1.3291260071210844}
[INFO: 2020-09-09 10:24:02,918] iteration 2700
[INFO: 2020-09-09 10:25:03,970] ######## Iteration (TEST) 2700 ########
[INFO: 2020-09-09 10:25:03,970] {'CIDEr': 1.3303438037177857}
[INFO: 2020-09-09 10:32:06,712] iteration 2800
[INFO: 2020-09-09 10:33:07,787] ######## Iteration (TEST) 2800 ########
[INFO: 2020-09-09 10:33:07,787] {'CIDEr': 1.3286845055619207}
[INFO: 2020-09-09 10:40:08,403] iteration 2900
[INFO: 2020-09-09 10:41:09,206] ######## Iteration (TEST) 2900 ########
[INFO: 2020-09-09 10:41:09,206] {'CIDEr': 1.327345603046862}
[INFO: 2020-09-09 10:48:07,323] iteration 3000
[INFO: 2020-09-09 10:49:07,829] ######## Iteration (TEST) 3000 ########
[INFO: 2020-09-09 10:49:07,829] {'CIDEr': 1.3313153539456304}
[INFO: 2020-09-09 10:51:53,146] Training with config:
[INFO: 2020-09-09 10:51:53,148] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 10:52:10,358] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 10:58:44,873] ######## Iter (TEST) 100 ########
[INFO: 2020-09-09 10:58:44,873] {'CIDEr': 1.333616190008917}
[INFO: 2020-09-09 10:58:44,875] val_current @iteration 100: 1.3157556078898787, val_predictor: 0
[INFO: 2020-09-09 10:58:44,875] mv_approxkl: 0.0008428541084467226
[INFO: 2020-09-09 10:58:44,875] mv_entropy: 0.0889670266975963
[INFO: 2020-09-09 11:05:19,459] ######## Iter (TEST) 200 ########
[INFO: 2020-09-09 11:05:19,459] {'CIDEr': 1.336071450942716}
[INFO: 2020-09-09 11:05:19,461] val_current @iteration 200: 1.315679991540315, val_predictor: 0
[INFO: 2020-09-09 11:05:19,461] mv_approxkl: 0.0008096630882611508
[INFO: 2020-09-09 11:05:19,461] mv_entropy: 0.08985196652751623
[INFO: 2020-09-09 11:11:51,456] ######## Iter (TEST) 300 ########
[INFO: 2020-09-09 11:11:51,457] {'CIDEr': 1.3346995885187352}
[INFO: 2020-09-09 11:11:51,459] val_current @iteration 300: 1.3120345830251596, val_predictor: 0
[INFO: 2020-09-09 11:11:51,459] mv_approxkl: 0.0008600817147449739
[INFO: 2020-09-09 11:11:51,459] mv_entropy: 0.09394881102678915
[INFO: 2020-09-09 11:18:25,637] ######## Iter (TEST) 400 ########
[INFO: 2020-09-09 11:18:25,637] {'CIDEr': 1.3343105630164012}
[INFO: 2020-09-09 11:18:25,639] val_current @iteration 400: 1.3134476451984276, val_predictor: 0
[INFO: 2020-09-09 11:18:25,639] mv_approxkl: 0.0006838351583001369
[INFO: 2020-09-09 11:18:25,639] mv_entropy: 0.09070359939587407
[INFO: 2020-09-09 11:24:57,831] ######## Iter (TEST) 500 ########
[INFO: 2020-09-09 11:24:57,832] {'CIDEr': 1.3359470743318125}
[INFO: 2020-09-09 11:24:57,833] val_current @iteration 500: 1.3149299936729302, val_predictor: 0
[INFO: 2020-09-09 11:24:57,834] mv_approxkl: 0.0006161364607991086
[INFO: 2020-09-09 11:24:57,834] mv_entropy: 0.09075276432228713
[INFO: 2020-09-09 11:31:29,312] ######## Iter (TEST) 600 ########
[INFO: 2020-09-09 11:31:29,313] {'CIDEr': 1.3356563828124404}
[INFO: 2020-09-09 11:31:29,315] val_current @iteration 600: 1.3117472226926539, val_predictor: 0
[INFO: 2020-09-09 11:31:29,315] mv_approxkl: 0.0006981956063025392
[INFO: 2020-09-09 11:31:29,315] mv_entropy: 0.08552912569379229
[INFO: 2020-09-09 11:38:04,406] ######## Iter (TEST) 700 ########
[INFO: 2020-09-09 11:38:04,406] {'CIDEr': 1.3340110048348492}
[INFO: 2020-09-09 11:38:04,408] val_current @iteration 700: 1.313422605387639, val_predictor: 0
[INFO: 2020-09-09 11:38:04,408] mv_approxkl: 0.0009319883820621331
[INFO: 2020-09-09 11:38:04,408] mv_entropy: 0.09323727915256692
[INFO: 2020-09-09 11:44:38,565] ######## Iter (TEST) 800 ########
[INFO: 2020-09-09 11:44:38,565] {'CIDEr': 1.3337065120680733}
[INFO: 2020-09-09 11:44:38,567] val_current @iteration 800: 1.3126187485282548, val_predictor: 0
[INFO: 2020-09-09 11:44:38,567] mv_approxkl: 0.0007824013452396002
[INFO: 2020-09-09 11:44:38,567] mv_entropy: 0.09513681468281751
[INFO: 2020-09-09 11:51:14,573] ######## Iter (TEST) 900 ########
[INFO: 2020-09-09 11:51:14,573] {'CIDEr': 1.3347084313845345}
[INFO: 2020-09-09 11:51:14,575] val_current @iteration 900: 1.3121121944567322, val_predictor: 0
[INFO: 2020-09-09 11:51:14,575] mv_approxkl: 0.0010866263454354804
[INFO: 2020-09-09 11:51:14,575] mv_entropy: 0.09148913057978675
[INFO: 2020-09-09 11:57:48,586] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-09 11:57:48,586] {'CIDEr': 1.3359427763587057}
[INFO: 2020-09-09 11:57:48,588] val_current @iteration 1000: 1.316279350573355, val_predictor: 0
[INFO: 2020-09-09 11:57:48,588] mv_approxkl: 0.0007792549578353344
[INFO: 2020-09-09 11:57:48,588] mv_entropy: 0.0929328273150383
[INFO: 2020-09-09 12:04:23,322] ######## Iter (TEST) 1100 ########
[INFO: 2020-09-09 12:04:23,322] {'CIDEr': 1.334123840587664}
[INFO: 2020-09-09 12:04:23,324] val_current @iteration 1100: 1.3138407709841085, val_predictor: 0
[INFO: 2020-09-09 12:04:23,324] mv_approxkl: 0.0007293503392558272
[INFO: 2020-09-09 12:04:23,324] mv_entropy: 0.09504078764472611
[INFO: 2020-09-09 12:10:56,526] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-09 12:10:56,527] {'CIDEr': 1.3332341560911862}
[INFO: 2020-09-09 12:10:56,529] val_current @iteration 1200: 1.316487347983432, val_predictor: 0
[INFO: 2020-09-09 12:10:56,529] mv_approxkl: 0.0008230208848758695
[INFO: 2020-09-09 12:10:56,529] mv_entropy: 0.0924192787751412
[INFO: 2020-09-09 12:17:29,960] ######## Iter (TEST) 1300 ########
[INFO: 2020-09-09 12:17:29,960] {'CIDEr': 1.3325384304049497}
[INFO: 2020-09-09 12:17:29,962] val_current @iteration 1300: 1.3169031868742938, val_predictor: 0
[INFO: 2020-09-09 12:17:29,962] mv_approxkl: 0.0007966057803156033
[INFO: 2020-09-09 12:17:29,962] mv_entropy: 0.09425250201975101
[INFO: 2020-09-09 12:24:03,150] ######## Iter (TEST) 1400 ########
[INFO: 2020-09-09 12:24:03,150] {'CIDEr': 1.3323142109533084}
[INFO: 2020-09-09 12:24:03,152] val_current @iteration 1400: 1.3174631570307687, val_predictor: 0
[INFO: 2020-09-09 12:24:03,152] mv_approxkl: 0.0009601644051618812
[INFO: 2020-09-09 12:24:03,152] mv_entropy: 0.09683807015666768
[INFO: 2020-09-09 12:30:36,750] ######## Iter (TEST) 1500 ########
[INFO: 2020-09-09 12:30:36,750] {'CIDEr': 1.332060304778129}
[INFO: 2020-09-09 12:30:36,752] val_current @iteration 1500: 1.3153417994887633, val_predictor: 0
[INFO: 2020-09-09 12:30:36,752] mv_approxkl: 0.0006839769065788991
[INFO: 2020-09-09 12:30:36,752] mv_entropy: 0.09264162680192659
[INFO: 2020-09-09 12:37:12,905] ######## Iter (TEST) 1600 ########
[INFO: 2020-09-09 12:37:12,905] {'CIDEr': 1.3319986233305452}
[INFO: 2020-09-09 12:37:12,907] val_current @iteration 1600: 1.3148429945590283, val_predictor: 0
[INFO: 2020-09-09 12:37:12,907] mv_approxkl: 0.0007555110570866315
[INFO: 2020-09-09 12:37:12,907] mv_entropy: 0.09539471046456656
[INFO: 2020-09-09 12:43:46,580] ######## Iter (TEST) 1700 ########
[INFO: 2020-09-09 12:43:46,580] {'CIDEr': 1.3331018496608358}
[INFO: 2020-09-09 12:43:46,582] val_current @iteration 1700: 1.315977390118599, val_predictor: 0
[INFO: 2020-09-09 12:43:46,582] mv_approxkl: 0.000849055834559355
[INFO: 2020-09-09 12:43:46,582] mv_entropy: 0.08849681454468408
[INFO: 2020-09-09 12:50:19,815] ######## Iter (TEST) 1800 ########
[INFO: 2020-09-09 12:50:19,815] {'CIDEr': 1.331634463122462}
[INFO: 2020-09-09 12:50:19,817] val_current @iteration 1800: 1.315888067009447, val_predictor: 0
[INFO: 2020-09-09 12:50:19,817] mv_approxkl: 0.0009371279801360154
[INFO: 2020-09-09 12:50:19,817] mv_entropy: 0.09374086217940772
[INFO: 2020-09-09 12:56:52,587] ######## Iter (TEST) 1900 ########
[INFO: 2020-09-09 12:56:52,587] {'CIDEr': 1.3337608461499788}
[INFO: 2020-09-09 12:56:52,589] val_current @iteration 1900: 1.3162399400657017, val_predictor: 0
[INFO: 2020-09-09 12:56:52,589] mv_approxkl: 0.0008612422116407361
[INFO: 2020-09-09 12:56:52,589] mv_entropy: 0.0877698969630125
[INFO: 2020-09-09 13:03:25,702] ######## Iter (TEST) 2000 ########
[INFO: 2020-09-09 13:03:25,703] {'CIDEr': 1.3354053864818796}
[INFO: 2020-09-09 13:03:25,705] val_current @iteration 2000: 1.3151522117956116, val_predictor: 0
[INFO: 2020-09-09 13:03:25,705] mv_approxkl: 0.0007876133403436497
[INFO: 2020-09-09 13:03:25,705] mv_entropy: 0.08631727318827771
[INFO: 2020-09-09 13:09:58,972] ######## Iter (TEST) 2100 ########
[INFO: 2020-09-09 13:09:58,972] {'CIDEr': 1.3363488761468365}
[INFO: 2020-09-09 13:09:58,974] val_current @iteration 2100: 1.3176013383758816, val_predictor: 0
[INFO: 2020-09-09 13:09:58,974] mv_approxkl: 0.0006819186583029879
[INFO: 2020-09-09 13:09:58,974] mv_entropy: 0.09207349815344593
[INFO: 2020-09-09 13:16:32,150] ######## Iter (TEST) 2200 ########
[INFO: 2020-09-09 13:16:32,150] {'CIDEr': 1.3338877336789325}
[INFO: 2020-09-09 13:16:32,152] val_current @iteration 2200: 1.315765435007198, val_predictor: 0
[INFO: 2020-09-09 13:16:32,152] mv_approxkl: 0.000949034544692835
[INFO: 2020-09-09 13:16:32,152] mv_entropy: 0.09305020997139896
[INFO: 2020-09-09 13:23:03,279] ######## Iter (TEST) 2300 ########
[INFO: 2020-09-09 13:23:03,279] {'CIDEr': 1.3352456826146544}
[INFO: 2020-09-09 13:23:03,281] val_current @iteration 2300: 1.3155085682113798, val_predictor: 0
[INFO: 2020-09-09 13:23:03,281] mv_approxkl: 0.000777215894860644
[INFO: 2020-09-09 13:23:03,281] mv_entropy: 0.091709935433901
[INFO: 2020-09-09 13:29:36,250] ######## Iter (TEST) 2400 ########
[INFO: 2020-09-09 13:29:36,250] {'CIDEr': 1.3342032005690192}
[INFO: 2020-09-09 13:29:36,252] val_current @iteration 2400: 1.31654533904819, val_predictor: 0
[INFO: 2020-09-09 13:29:36,252] mv_approxkl: 0.0007667613419500952
[INFO: 2020-09-09 13:29:36,252] mv_entropy: 0.09029371443863787
[INFO: 2020-09-09 13:36:11,035] ######## Iter (TEST) 2500 ########
[INFO: 2020-09-09 13:36:11,035] {'CIDEr': 1.3328215649262747}
[INFO: 2020-09-09 13:36:11,037] val_current @iteration 2500: 1.316734723108853, val_predictor: 0
[INFO: 2020-09-09 13:36:11,037] mv_approxkl: 0.000929141527063924
[INFO: 2020-09-09 13:36:11,037] mv_entropy: 0.09585515094291588
[INFO: 2020-09-09 13:42:39,582] ######## Iter (TEST) 2600 ########
[INFO: 2020-09-09 13:42:39,582] {'CIDEr': 1.3330251908071398}
[INFO: 2020-09-09 13:42:39,585] val_current @iteration 2600: 1.3159100409740745, val_predictor: 0
[INFO: 2020-09-09 13:42:39,585] mv_approxkl: 0.0007860696192822224
[INFO: 2020-09-09 13:42:39,585] mv_entropy: 0.09551779116337701
[INFO: 2020-09-09 13:49:09,202] ######## Iter (TEST) 2700 ########
[INFO: 2020-09-09 13:49:09,202] {'CIDEr': 1.333189045359579}
[INFO: 2020-09-09 13:49:09,204] val_current @iteration 2700: 1.314149995895751, val_predictor: 0
[INFO: 2020-09-09 13:49:09,204] mv_approxkl: 0.000670297055813639
[INFO: 2020-09-09 13:49:09,204] mv_entropy: 0.09143581947450728
[INFO: 2020-09-09 13:55:39,116] ######## Iter (TEST) 2800 ########
[INFO: 2020-09-09 13:55:39,116] {'CIDEr': 1.3350578831794822}
[INFO: 2020-09-09 13:55:39,118] val_current @iteration 2800: 1.3153898043634729, val_predictor: 0
[INFO: 2020-09-09 13:55:39,118] mv_approxkl: 0.000755152153211546
[INFO: 2020-09-09 13:55:39,118] mv_entropy: 0.08836940947002954
[INFO: 2020-09-09 14:02:09,935] ######## Iter (TEST) 2900 ########
[INFO: 2020-09-09 14:02:09,935] {'CIDEr': 1.3368364671665245}
[INFO: 2020-09-09 14:02:09,937] val_current @iteration 2900: 1.3139051509149597, val_predictor: 0
[INFO: 2020-09-09 14:02:09,937] mv_approxkl: 0.001051056311144985
[INFO: 2020-09-09 14:02:09,937] mv_entropy: 0.09345713727091674
[INFO: 2020-09-09 14:08:42,351] ######## Iter (TEST) 3000 ########
[INFO: 2020-09-09 14:08:42,352] {'CIDEr': 1.3336452105313692}
[INFO: 2020-09-09 14:08:42,353] val_current @iteration 3000: 1.3131198770041559, val_predictor: 0
[INFO: 2020-09-09 14:08:42,353] mv_approxkl: 0.0006064740701805459
[INFO: 2020-09-09 14:08:42,353] mv_entropy: 0.09551923352713601
[INFO: 2020-09-09 14:17:08,029] Training with config:
[INFO: 2020-09-09 14:17:08,031] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 14:17:25,103] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 14:23:03,976] Training with config:
[INFO: 2020-09-09 14:23:03,978] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 14:23:20,845] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 14:36:53,723] Training with config:
[INFO: 2020-09-09 14:36:53,725] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 14:37:10,478] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 14:37:55,180] val_current @iteration 16: 0, val_predictor: 0
[INFO: 2020-09-09 14:37:55,182] mv_approxkl: 0.00024453633836348795
[INFO: 2020-09-09 14:37:55,182] mv_entropy: 0.08083751222238775
[INFO: 2020-09-09 14:38:37,248] val_current @iteration 32: 0, val_predictor: 0
[INFO: 2020-09-09 14:38:37,250] mv_approxkl: 0.0004138161280791377
[INFO: 2020-09-09 14:38:37,250] mv_entropy: 0.08569770296331745
[INFO: 2020-09-09 14:39:20,333] val_current @iteration 48: 0, val_predictor: 0
[INFO: 2020-09-09 14:39:20,335] mv_approxkl: 0.0004244937633063487
[INFO: 2020-09-09 14:39:20,335] mv_entropy: 0.09369671371151309
[INFO: 2020-09-09 14:40:02,797] val_current @iteration 64: 0, val_predictor: 0
[INFO: 2020-09-09 14:40:02,799] mv_approxkl: 0.0005992448630489065
[INFO: 2020-09-09 14:40:02,799] mv_entropy: 0.08908624543249279
[INFO: 2020-09-09 14:40:45,058] val_current @iteration 80: 0, val_predictor: 0
[INFO: 2020-09-09 14:40:45,059] mv_approxkl: 0.0006813871834260891
[INFO: 2020-09-09 14:40:45,060] mv_entropy: 0.09353002269510224
[INFO: 2020-09-09 14:41:27,686] val_current @iteration 96: 0, val_predictor: 0
[INFO: 2020-09-09 14:41:27,688] mv_approxkl: 0.000888444712636074
[INFO: 2020-09-09 14:41:27,688] mv_entropy: 0.0953953320591834
[INFO: 2020-09-09 14:42:10,564] val_current @iteration 112: 0, val_predictor: 0
[INFO: 2020-09-09 14:42:10,565] mv_approxkl: 0.0008418646306849138
[INFO: 2020-09-09 14:42:10,566] mv_entropy: 0.09643499327911548
[INFO: 2020-09-09 14:42:53,233] val_current @iteration 128: 0, val_predictor: 0
[INFO: 2020-09-09 14:42:53,234] mv_approxkl: 0.0008927762614185946
[INFO: 2020-09-09 14:42:53,234] mv_entropy: 0.09295750525456567
[INFO: 2020-09-09 14:43:35,810] val_current @iteration 144: 0, val_predictor: 0
[INFO: 2020-09-09 14:43:35,812] mv_approxkl: 0.0011477242815219584
[INFO: 2020-09-09 14:43:35,812] mv_entropy: 0.09922525343081237
[INFO: 2020-09-09 14:44:18,782] val_current @iteration 160: 0, val_predictor: 0
[INFO: 2020-09-09 14:44:18,783] mv_approxkl: 0.001278680862460681
[INFO: 2020-09-09 14:44:18,783] mv_entropy: 0.08706347693783084
[INFO: 2020-09-09 14:45:00,947] val_current @iteration 176: 0, val_predictor: 0
[INFO: 2020-09-09 14:45:00,948] mv_approxkl: 0.0014501788055445739
[INFO: 2020-09-09 14:45:00,948] mv_entropy: 0.08849662375033004
[INFO: 2020-09-09 14:45:43,142] val_current @iteration 192: 0, val_predictor: 0
[INFO: 2020-09-09 14:45:43,143] mv_approxkl: 0.0014450226785642877
[INFO: 2020-09-09 14:45:43,143] mv_entropy: 0.10044154835388817
[INFO: 2020-09-09 14:46:26,221] val_current @iteration 208: 0, val_predictor: 0
[INFO: 2020-09-09 14:46:26,222] mv_approxkl: 0.001401868176447998
[INFO: 2020-09-09 14:46:26,222] mv_entropy: 0.09337494793360124
[INFO: 2020-09-09 14:47:08,968] val_current @iteration 224: 0, val_predictor: 0
[INFO: 2020-09-09 14:47:08,970] mv_approxkl: 0.0013222380146197972
[INFO: 2020-09-09 14:47:08,970] mv_entropy: 0.09444612899711362
[INFO: 2020-09-09 14:47:51,614] val_current @iteration 240: 0, val_predictor: 0
[INFO: 2020-09-09 14:47:51,616] mv_approxkl: 0.0013099116288924726
[INFO: 2020-09-09 14:47:51,616] mv_entropy: 0.09105958476026027
[INFO: 2020-09-09 14:48:34,513] val_current @iteration 256: 0, val_predictor: 0
[INFO: 2020-09-09 14:48:34,515] mv_approxkl: 0.0015475247730162755
[INFO: 2020-09-09 14:48:34,515] mv_entropy: 0.0953743027577376
[INFO: 2020-09-09 14:49:17,439] val_current @iteration 272: 0, val_predictor: 0
[INFO: 2020-09-09 14:49:17,441] mv_approxkl: 0.0015226476201906465
[INFO: 2020-09-09 14:49:17,441] mv_entropy: 0.09441944649498457
[INFO: 2020-09-09 14:50:00,213] val_current @iteration 288: 0, val_predictor: 0
[INFO: 2020-09-09 14:50:00,214] mv_approxkl: 0.0014134929767473838
[INFO: 2020-09-09 14:50:00,214] mv_entropy: 0.09797860150592458
[INFO: 2020-09-09 14:50:42,817] val_current @iteration 304: 0, val_predictor: 0
[INFO: 2020-09-09 14:50:42,819] mv_approxkl: 0.0013690364211595902
[INFO: 2020-09-09 14:50:42,819] mv_entropy: 0.09380537926263213
[INFO: 2020-09-09 14:51:25,714] val_current @iteration 320: 0, val_predictor: 0
[INFO: 2020-09-09 14:51:25,716] mv_approxkl: 0.0014565357444505352
[INFO: 2020-09-09 14:51:25,716] mv_entropy: 0.09243001098337003
[INFO: 2020-09-09 14:52:07,879] val_current @iteration 336: 0, val_predictor: 0
[INFO: 2020-09-09 14:52:07,880] mv_approxkl: 0.001410158678728406
[INFO: 2020-09-09 14:52:07,880] mv_entropy: 0.0914540341262775
[INFO: 2020-09-09 14:52:50,624] val_current @iteration 352: 0, val_predictor: 0
[INFO: 2020-09-09 14:52:50,626] mv_approxkl: 0.0019333181984728443
[INFO: 2020-09-09 14:52:50,626] mv_entropy: 0.09821701767835557
[INFO: 2020-09-09 14:53:33,494] val_current @iteration 368: 0, val_predictor: 0
[INFO: 2020-09-09 14:53:33,496] mv_approxkl: 0.0017712917055221742
[INFO: 2020-09-09 14:53:33,496] mv_entropy: 0.09608787418014555
[INFO: 2020-09-09 14:54:16,388] val_current @iteration 384: 0, val_predictor: 0
[INFO: 2020-09-09 14:54:16,390] mv_approxkl: 0.00180381801918148
[INFO: 2020-09-09 14:54:16,390] mv_entropy: 0.09678920227667065
[INFO: 2020-09-09 14:54:59,021] val_current @iteration 400: 0, val_predictor: 0
[INFO: 2020-09-09 14:54:59,023] mv_approxkl: 0.0018971394945785022
[INFO: 2020-09-09 14:54:59,023] mv_entropy: 0.09421754708338673
[INFO: 2020-09-09 14:55:41,847] val_current @iteration 416: 0, val_predictor: 0
[INFO: 2020-09-09 14:55:41,848] mv_approxkl: 0.0018557351099038732
[INFO: 2020-09-09 14:55:41,848] mv_entropy: 0.09245441310163693
[INFO: 2020-09-09 14:56:24,633] val_current @iteration 432: 0, val_predictor: 0
[INFO: 2020-09-09 14:56:24,634] mv_approxkl: 0.0015519197721455017
[INFO: 2020-09-09 14:56:24,634] mv_entropy: 0.0921585644660319
[INFO: 2020-09-09 14:57:07,310] val_current @iteration 448: 0, val_predictor: 0
[INFO: 2020-09-09 14:57:07,312] mv_approxkl: 0.0019274167932401064
[INFO: 2020-09-09 14:57:07,312] mv_entropy: 0.09891679641107289
[INFO: 2020-09-09 14:57:49,873] val_current @iteration 464: 0, val_predictor: 0
[INFO: 2020-09-09 14:57:49,874] mv_approxkl: 0.002305736654589171
[INFO: 2020-09-09 14:57:49,874] mv_entropy: 0.09029244861490844
[INFO: 2020-09-09 14:58:32,350] val_current @iteration 480: 0, val_predictor: 0
[INFO: 2020-09-09 14:58:32,351] mv_approxkl: 0.0020349131208285917
[INFO: 2020-09-09 14:58:32,351] mv_entropy: 0.09122119315647252
[INFO: 2020-09-09 14:59:14,986] val_current @iteration 496: 0, val_predictor: 0
[INFO: 2020-09-09 14:59:14,987] mv_approxkl: 0.0021726063902589303
[INFO: 2020-09-09 14:59:14,987] mv_entropy: 0.09744841091722743
[INFO: 2020-09-09 14:59:57,716] val_current @iteration 512: 0, val_predictor: 0
[INFO: 2020-09-09 14:59:57,718] mv_approxkl: 0.001957063036213347
[INFO: 2020-09-09 14:59:57,718] mv_entropy: 0.09412401020813768
[INFO: 2020-09-09 15:00:40,467] val_current @iteration 528: 0, val_predictor: 0
[INFO: 2020-09-09 15:00:40,468] mv_approxkl: 0.002297140509901858
[INFO: 2020-09-09 15:00:40,468] mv_entropy: 0.0922673490340491
[INFO: 2020-09-09 15:01:22,207] val_current @iteration 544: 0, val_predictor: 0
[INFO: 2020-09-09 15:01:22,209] mv_approxkl: 0.0018574963295917063
[INFO: 2020-09-09 15:01:22,209] mv_entropy: 0.0988896688929782
[INFO: 2020-09-09 15:02:04,933] val_current @iteration 560: 0, val_predictor: 0
[INFO: 2020-09-09 15:02:04,934] mv_approxkl: 0.0018656900319672786
[INFO: 2020-09-09 15:02:04,934] mv_entropy: 0.08996460803647668
[INFO: 2020-09-09 15:02:48,005] val_current @iteration 576: 0, val_predictor: 0
[INFO: 2020-09-09 15:02:48,006] mv_approxkl: 0.002699536575065081
[INFO: 2020-09-09 15:02:48,006] mv_entropy: 0.10011889495299314
[INFO: 2020-09-09 15:03:30,222] val_current @iteration 592: 0, val_predictor: 0
[INFO: 2020-09-09 15:03:30,224] mv_approxkl: 0.0023451968067092184
[INFO: 2020-09-09 15:03:30,224] mv_entropy: 0.0901525565308095
[INFO: 2020-09-09 15:04:13,278] val_current @iteration 608: 0, val_predictor: 0
[INFO: 2020-09-09 15:04:13,280] mv_approxkl: 0.002181599223313946
[INFO: 2020-09-09 15:04:13,280] mv_entropy: 0.09213655836325554
[INFO: 2020-09-09 15:04:56,306] val_current @iteration 624: 0, val_predictor: 0
[INFO: 2020-09-09 15:04:56,308] mv_approxkl: 0.0023458443563054085
[INFO: 2020-09-09 15:04:56,308] mv_entropy: 0.09615957680381178
[INFO: 2020-09-09 15:05:39,226] val_current @iteration 640: 0, val_predictor: 0
[INFO: 2020-09-09 15:05:39,228] mv_approxkl: 0.0030010029382555137
[INFO: 2020-09-09 15:05:39,228] mv_entropy: 0.09104410140861197
[INFO: 2020-09-09 15:06:22,685] val_current @iteration 656: 0, val_predictor: 0
[INFO: 2020-09-09 15:06:22,686] mv_approxkl: 0.002275796085223308
[INFO: 2020-09-09 15:06:22,687] mv_entropy: 0.08773207088885182
[INFO: 2020-09-09 15:07:05,275] val_current @iteration 672: 0, val_predictor: 0
[INFO: 2020-09-09 15:07:05,276] mv_approxkl: 0.0022008878717095937
[INFO: 2020-09-09 15:07:05,276] mv_entropy: 0.09664397059698412
[INFO: 2020-09-09 15:07:48,863] val_current @iteration 688: 0, val_predictor: 0
[INFO: 2020-09-09 15:07:48,865] mv_approxkl: 0.002638161353875491
[INFO: 2020-09-09 15:07:48,865] mv_entropy: 0.09372073961714758
[INFO: 2020-09-09 15:08:31,512] val_current @iteration 704: 0, val_predictor: 0
[INFO: 2020-09-09 15:08:31,514] mv_approxkl: 0.002845267823983425
[INFO: 2020-09-09 15:08:31,514] mv_entropy: 0.0962753431978095
[INFO: 2020-09-09 15:09:13,997] val_current @iteration 720: 0, val_predictor: 0
[INFO: 2020-09-09 15:09:13,999] mv_approxkl: 0.0034578907869306963
[INFO: 2020-09-09 15:09:14,000] mv_entropy: 0.0948196086678317
[INFO: 2020-09-09 15:09:57,299] val_current @iteration 736: 0, val_predictor: 0
[INFO: 2020-09-09 15:09:57,300] mv_approxkl: 0.003151316960669401
[INFO: 2020-09-09 15:09:57,300] mv_entropy: 0.09758052339574867
[INFO: 2020-09-09 15:10:39,785] val_current @iteration 752: 0, val_predictor: 0
[INFO: 2020-09-09 15:10:39,787] mv_approxkl: 0.0035707482888191018
[INFO: 2020-09-09 15:10:39,787] mv_entropy: 0.09807593242764376
[INFO: 2020-09-09 15:11:22,743] val_current @iteration 768: 0, val_predictor: 0
[INFO: 2020-09-09 15:11:22,745] mv_approxkl: 0.003066493943633822
[INFO: 2020-09-09 15:11:22,745] mv_entropy: 0.09438716161713168
[INFO: 2020-09-09 15:12:05,214] val_current @iteration 784: 0, val_predictor: 0
[INFO: 2020-09-09 15:12:05,216] mv_approxkl: 0.0029713171680104643
[INFO: 2020-09-09 15:12:05,216] mv_entropy: 0.09725817576964647
[INFO: 2020-09-09 15:12:48,373] val_current @iteration 800: 0, val_predictor: 0
[INFO: 2020-09-09 15:12:48,374] mv_approxkl: 0.0025678385013282014
[INFO: 2020-09-09 15:12:48,374] mv_entropy: 0.09767262506140678
[INFO: 2020-09-09 15:13:32,140] val_current @iteration 816: 0, val_predictor: 0
[INFO: 2020-09-09 15:13:32,141] mv_approxkl: 0.003066596204178623
[INFO: 2020-09-09 15:13:32,141] mv_entropy: 0.0963715351947513
[INFO: 2020-09-09 15:14:14,792] val_current @iteration 832: 0, val_predictor: 0
[INFO: 2020-09-09 15:14:14,793] mv_approxkl: 0.0027713798366389634
[INFO: 2020-09-09 15:14:14,793] mv_entropy: 0.09723870051924155
[INFO: 2020-09-09 15:14:57,160] val_current @iteration 848: 0, val_predictor: 0
[INFO: 2020-09-09 15:14:57,161] mv_approxkl: 0.002316352164683839
[INFO: 2020-09-09 15:14:57,161] mv_entropy: 0.09364926377321175
[INFO: 2020-09-09 15:15:39,565] val_current @iteration 864: 0, val_predictor: 0
[INFO: 2020-09-09 15:15:39,566] mv_approxkl: 0.0029645691990925318
[INFO: 2020-09-09 15:15:39,566] mv_entropy: 0.09682445138324638
[INFO: 2020-09-09 15:16:22,178] val_current @iteration 880: 0, val_predictor: 0
[INFO: 2020-09-09 15:16:22,179] mv_approxkl: 0.0027797259693283453
[INFO: 2020-09-09 15:16:22,179] mv_entropy: 0.09048763145288959
[INFO: 2020-09-09 15:17:04,995] val_current @iteration 896: 0, val_predictor: 0
[INFO: 2020-09-09 15:17:04,996] mv_approxkl: 0.0026332775103805185
[INFO: 2020-09-09 15:17:04,996] mv_entropy: 0.09890835243851313
[INFO: 2020-09-09 15:17:47,470] val_current @iteration 912: 0, val_predictor: 0
[INFO: 2020-09-09 15:17:47,471] mv_approxkl: 0.002308597284112981
[INFO: 2020-09-09 15:17:47,472] mv_entropy: 0.09461931073733368
[INFO: 2020-09-09 15:18:30,385] val_current @iteration 928: 0, val_predictor: 0
[INFO: 2020-09-09 15:18:30,386] mv_approxkl: 0.0031754402850948647
[INFO: 2020-09-09 15:18:30,386] mv_entropy: 0.09685540632417305
[INFO: 2020-09-09 15:19:13,587] val_current @iteration 944: 0, val_predictor: 0
[INFO: 2020-09-09 15:19:13,588] mv_approxkl: 0.0033644409880712865
[INFO: 2020-09-09 15:19:13,588] mv_entropy: 0.09986113001216858
[INFO: 2020-09-09 15:19:57,089] val_current @iteration 960: 0, val_predictor: 0
[INFO: 2020-09-09 15:19:57,090] mv_approxkl: 0.0029471881465901965
[INFO: 2020-09-09 15:19:57,090] mv_entropy: 0.09372506296122474
[INFO: 2020-09-09 15:20:39,720] val_current @iteration 976: 0, val_predictor: 0
[INFO: 2020-09-09 15:20:39,722] mv_approxkl: 0.002795524735924557
[INFO: 2020-09-09 15:20:39,722] mv_entropy: 0.09862343335215684
[INFO: 2020-09-09 15:21:22,637] val_current @iteration 992: 0, val_predictor: 0
[INFO: 2020-09-09 15:21:22,639] mv_approxkl: 0.003075008394043007
[INFO: 2020-09-09 15:21:22,639] mv_entropy: 0.10130284803916352
[INFO: 2020-09-09 15:22:06,722] val_current @iteration 1008: 0, val_predictor: 0
[INFO: 2020-09-09 15:22:06,724] mv_approxkl: 0.0026296825566972325
[INFO: 2020-09-09 15:22:06,724] mv_entropy: 0.09645700304721158
[INFO: 2020-09-09 15:22:48,935] val_current @iteration 1024: 0, val_predictor: 0
[INFO: 2020-09-09 15:22:48,937] mv_approxkl: 0.0028583850940724965
[INFO: 2020-09-09 15:22:48,937] mv_entropy: 0.09898486902303827
[INFO: 2020-09-09 15:25:30,279] Training with config:
[INFO: 2020-09-09 15:25:30,281] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 15:25:47,144] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-09 15:36:44,610] ######## Iter (TEST) 200 ########
[INFO: 2020-09-09 15:36:44,610] {'CIDEr': 1.3252435530375448}
[INFO: 2020-09-09 15:36:44,613] val_current @iteration 200: 1.310775984085998, val_predictor: 0
[INFO: 2020-09-09 15:36:44,613] mv_approxkl: 0.0011535770306932076
[INFO: 2020-09-09 15:36:44,613] mv_entropy: 0.09133955026958004
[INFO: 2020-09-09 15:47:42,929] ######## Iter (TEST) 400 ########
[INFO: 2020-09-09 15:47:42,929] {'CIDEr': 1.3264085449755911}
[INFO: 2020-09-09 15:47:42,931] val_current @iteration 400: 1.3139922092509504, val_predictor: 0
[INFO: 2020-09-09 15:47:42,931] mv_approxkl: 0.001527863233352648
[INFO: 2020-09-09 15:47:42,931] mv_entropy: 0.09384965683318208
[INFO: 2020-09-09 15:58:39,383] ######## Iter (TEST) 600 ########
[INFO: 2020-09-09 15:58:39,383] {'CIDEr': 1.3263499947524922}
[INFO: 2020-09-09 15:58:39,385] val_current @iteration 600: 1.3134349485396752, val_predictor: 0
[INFO: 2020-09-09 15:58:39,385] mv_approxkl: 0.0013015085490830104
[INFO: 2020-09-09 15:58:39,385] mv_entropy: 0.09053557394931978
[INFO: 2020-09-09 16:09:37,789] ######## Iter (TEST) 800 ########
[INFO: 2020-09-09 16:09:37,790] {'CIDEr': 1.32837245573922}
[INFO: 2020-09-09 16:09:37,791] val_current @iteration 800: 1.3139065038671325, val_predictor: 0
[INFO: 2020-09-09 16:09:37,791] mv_approxkl: 0.0011658835107557204
[INFO: 2020-09-09 16:09:37,791] mv_entropy: 0.09514324817976332
[INFO: 2020-09-09 16:20:35,990] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-09 16:20:35,990] {'CIDEr': 1.3281294925521743}
[INFO: 2020-09-09 16:20:35,992] val_current @iteration 1000: 1.3158996647388248, val_predictor: 0
[INFO: 2020-09-09 16:20:35,992] mv_approxkl: 0.0012355866789794411
[INFO: 2020-09-09 16:20:35,992] mv_entropy: 0.09546997360268455
[INFO: 2020-09-09 16:31:36,346] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-09 16:31:36,346] {'CIDEr': 1.3286768742670665}
[INFO: 2020-09-09 16:31:36,348] val_current @iteration 1200: 1.3150601765288914, val_predictor: 0
[INFO: 2020-09-09 16:31:36,348] mv_approxkl: 0.001219955121672548
[INFO: 2020-09-09 16:31:36,348] mv_entropy: 0.09434371709003997
[INFO: 2020-09-09 16:42:32,584] ######## Iter (TEST) 1400 ########
[INFO: 2020-09-09 16:42:32,585] {'CIDEr': 1.330994543853247}
[INFO: 2020-09-09 16:42:32,586] val_current @iteration 1400: 1.3120450033141142, val_predictor: 0
[INFO: 2020-09-09 16:42:32,586] mv_approxkl: 0.0013641883093156696
[INFO: 2020-09-09 16:42:32,586] mv_entropy: 0.09974581592298062
[INFO: 2020-09-09 16:53:31,737] ######## Iter (TEST) 1600 ########
[INFO: 2020-09-09 16:53:31,738] {'CIDEr': 1.331710954755048}
[INFO: 2020-09-09 16:53:31,739] val_current @iteration 1600: 1.3126054693515452, val_predictor: 0
[INFO: 2020-09-09 16:53:31,739] mv_approxkl: 0.0012711150540251812
[INFO: 2020-09-09 16:53:31,739] mv_entropy: 0.09408163209501026
[INFO: 2020-09-09 17:04:28,807] ######## Iter (TEST) 1800 ########
[INFO: 2020-09-09 17:04:28,807] {'CIDEr': 1.330625787650163}
[INFO: 2020-09-09 17:04:28,809] val_current @iteration 1800: 1.3157020541078774, val_predictor: 0
[INFO: 2020-09-09 17:04:28,809] mv_approxkl: 0.0013867653790874174
[INFO: 2020-09-09 17:04:28,809] mv_entropy: 0.09476082992635365
[INFO: 2020-09-09 17:15:25,270] ######## Iter (TEST) 2000 ########
[INFO: 2020-09-09 17:15:25,270] {'CIDEr': 1.333205188071488}
[INFO: 2020-09-09 17:15:25,272] val_current @iteration 2000: 1.316133760533365, val_predictor: 0
[INFO: 2020-09-09 17:15:25,272] mv_approxkl: 0.0010777118657910754
[INFO: 2020-09-09 17:15:25,272] mv_entropy: 0.08846399372723697
[INFO: 2020-09-09 17:22:05,317] ######## Epoch 2000 ########
[INFO: 2020-09-09 17:22:05,317] {'CIDEr': 1.333205188071488}
[INFO: 2020-09-09 17:24:39,859] ######## Epoch 2000 ########
[INFO: 2020-09-09 17:24:39,859] {'CIDEr': 1.333205188071488}
[INFO: 2020-09-09 17:26:55,145] ######## Iter (TEST) 2200 ########
[INFO: 2020-09-09 17:26:55,145] {'CIDEr': 1.3321354542169825}
[INFO: 2020-09-09 17:26:55,147] val_current @iteration 2200: 1.3132807783619258, val_predictor: 0
[INFO: 2020-09-09 17:26:55,147] mv_approxkl: 0.0013491004401191284
[INFO: 2020-09-09 17:26:55,147] mv_entropy: 0.09214595148290587
[INFO: 2020-09-09 17:37:50,849] ######## Iter (TEST) 2400 ########
[INFO: 2020-09-09 17:37:50,849] {'CIDEr': 1.333250323914032}
[INFO: 2020-09-09 17:37:50,851] val_current @iteration 2400: 1.3147666484077254, val_predictor: 0
[INFO: 2020-09-09 17:37:50,851] mv_approxkl: 0.0013444248821288206
[INFO: 2020-09-09 17:37:50,851] mv_entropy: 0.09196590636727019
[INFO: 2020-09-09 17:48:45,528] ######## Iter (TEST) 2600 ########
[INFO: 2020-09-09 17:48:45,528] {'CIDEr': 1.3342540871429853}
[INFO: 2020-09-09 17:48:45,530] val_current @iteration 2600: 1.3140315821216577, val_predictor: 0
[INFO: 2020-09-09 17:48:45,530] mv_approxkl: 0.001477631639493274
[INFO: 2020-09-09 17:48:45,530] mv_entropy: 0.09691751139527843
[INFO: 2020-09-09 17:59:42,965] ######## Iter (TEST) 2800 ########
[INFO: 2020-09-09 17:59:42,965] {'CIDEr': 1.331923094871601}
[INFO: 2020-09-09 17:59:42,967] val_current @iteration 2800: 1.314724787748115, val_predictor: 0
[INFO: 2020-09-09 17:59:42,967] mv_approxkl: 0.0013841399740623273
[INFO: 2020-09-09 17:59:42,967] mv_entropy: 0.08783676027352438
[INFO: 2020-09-09 18:10:42,368] ######## Iter (TEST) 3000 ########
[INFO: 2020-09-09 18:10:42,369] {'CIDEr': 1.3328654303596434}
[INFO: 2020-09-09 18:10:42,371] val_current @iteration 3000: 1.3143506518567614, val_predictor: 0
[INFO: 2020-09-09 18:10:42,371] mv_approxkl: 0.0012493630179486758
[INFO: 2020-09-09 18:10:42,371] mv_entropy: 0.09569557024407505
[INFO: 2020-09-09 18:21:38,360] ######## Iter (TEST) 3200 ########
[INFO: 2020-09-09 18:21:38,361] {'CIDEr': 1.3322714123002288}
[INFO: 2020-09-09 18:21:38,362] val_current @iteration 3200: 1.3129468526088153, val_predictor: 0
[INFO: 2020-09-09 18:21:38,362] mv_approxkl: 0.0013561227616942723
[INFO: 2020-09-09 18:21:38,363] mv_entropy: 0.10231420392234658
[INFO: 2020-09-09 18:32:33,353] ######## Iter (TEST) 3400 ########
[INFO: 2020-09-09 18:32:33,353] {'CIDEr': 1.3356527455324736}
[INFO: 2020-09-09 18:32:33,355] val_current @iteration 3400: 1.3137795495040139, val_predictor: 0
[INFO: 2020-09-09 18:32:33,355] mv_approxkl: 0.0011592967827936047
[INFO: 2020-09-09 18:32:33,355] mv_entropy: 0.09163944583350997
[INFO: 2020-09-09 18:43:29,482] ######## Iter (TEST) 3600 ########
[INFO: 2020-09-09 18:43:29,483] {'CIDEr': 1.3349202979948596}
[INFO: 2020-09-09 18:43:29,484] val_current @iteration 3600: 1.312759638481886, val_predictor: 0
[INFO: 2020-09-09 18:43:29,484] mv_approxkl: 0.0016844894015319396
[INFO: 2020-09-09 18:43:29,484] mv_entropy: 0.09571863376046699
[INFO: 2020-09-09 18:54:26,910] ######## Iter (TEST) 3800 ########
[INFO: 2020-09-09 18:54:26,910] {'CIDEr': 1.3344159656409305}
[INFO: 2020-09-09 18:54:26,912] val_current @iteration 3800: 1.3123361020464261, val_predictor: 0
[INFO: 2020-09-09 18:54:26,912] mv_approxkl: 0.0010298066528911377
[INFO: 2020-09-09 18:54:26,912] mv_entropy: 0.08666212346220235
[INFO: 2020-09-09 19:05:22,311] ######## Iter (TEST) 4000 ########
[INFO: 2020-09-09 19:05:22,311] {'CIDEr': 1.333381970844916}
[INFO: 2020-09-09 19:05:22,313] val_current @iteration 4000: 1.3106307755487854, val_predictor: 0
[INFO: 2020-09-09 19:05:22,313] mv_approxkl: 0.001225920201288551
[INFO: 2020-09-09 19:05:22,313] mv_entropy: 0.09009203675617712
[INFO: 2020-09-09 19:16:17,421] ######## Iter (TEST) 4200 ########
[INFO: 2020-09-09 19:16:17,422] {'CIDEr': 1.3328248317915374}
[INFO: 2020-09-09 19:16:17,423] val_current @iteration 4200: 1.3114949911368157, val_predictor: 0
[INFO: 2020-09-09 19:16:17,423] mv_approxkl: 0.0012038787123477234
[INFO: 2020-09-09 19:16:17,424] mv_entropy: 0.08797397314254471
[INFO: 2020-09-09 19:27:13,003] ######## Iter (TEST) 4400 ########
[INFO: 2020-09-09 19:27:13,004] {'CIDEr': 1.330665719462329}
[INFO: 2020-09-09 19:27:13,005] val_current @iteration 4400: 1.3111966832031228, val_predictor: 0
[INFO: 2020-09-09 19:27:13,006] mv_approxkl: 0.0014697110969455903
[INFO: 2020-09-09 19:27:13,006] mv_entropy: 0.09396692286935776
[INFO: 2020-09-09 19:38:06,893] ######## Iter (TEST) 4600 ########
[INFO: 2020-09-09 19:38:06,893] {'CIDEr': 1.3317547393933842}
[INFO: 2020-09-09 19:38:06,895] val_current @iteration 4600: 1.3114149996780466, val_predictor: 0
[INFO: 2020-09-09 19:38:06,895] mv_approxkl: 0.0015910400418384044
[INFO: 2020-09-09 19:38:06,895] mv_entropy: 0.08804130543870659
[INFO: 2020-09-09 19:49:03,061] ######## Iter (TEST) 4800 ########
[INFO: 2020-09-09 19:49:03,061] {'CIDEr': 1.331901919058203}
[INFO: 2020-09-09 19:49:03,063] val_current @iteration 4800: 1.3098443364284649, val_predictor: 0
[INFO: 2020-09-09 19:49:03,063] mv_approxkl: 0.0012050451751419318
[INFO: 2020-09-09 19:49:03,063] mv_entropy: 0.09178832696244503
[INFO: 2020-09-09 19:59:56,078] ######## Iter (TEST) 5000 ########
[INFO: 2020-09-09 19:59:56,078] {'CIDEr': 1.3311802282553238}
[INFO: 2020-09-09 19:59:56,080] val_current @iteration 5000: 1.3116835904512392, val_predictor: 0
[INFO: 2020-09-09 19:59:56,080] mv_approxkl: 0.0011575861631194968
[INFO: 2020-09-09 19:59:56,080] mv_entropy: 0.08815369529818083
[INFO: 2020-09-09 20:10:52,572] ######## Iter (TEST) 5200 ########
[INFO: 2020-09-09 20:10:52,573] {'CIDEr': 1.3330332961215787}
[INFO: 2020-09-09 20:10:52,574] val_current @iteration 5200: 1.3108087957014174, val_predictor: 0
[INFO: 2020-09-09 20:10:52,575] mv_approxkl: 0.0010969924381753694
[INFO: 2020-09-09 20:10:52,575] mv_entropy: 0.08040062497554512
[INFO: 2020-09-09 20:21:45,273] ######## Iter (TEST) 5400 ########
[INFO: 2020-09-09 20:21:45,273] {'CIDEr': 1.33236073864194}
[INFO: 2020-09-09 20:21:45,275] val_current @iteration 5400: 1.3103038028545477, val_predictor: 0
[INFO: 2020-09-09 20:21:45,275] mv_approxkl: 0.001277163187907814
[INFO: 2020-09-09 20:21:45,275] mv_entropy: 0.08670826150827651
[INFO: 2020-09-09 20:32:37,138] ######## Iter (TEST) 5600 ########
[INFO: 2020-09-09 20:32:37,138] {'CIDEr': 1.3326529123942592}
[INFO: 2020-09-09 20:32:37,140] val_current @iteration 5600: 1.3126179420538269, val_predictor: 0
[INFO: 2020-09-09 20:32:37,140] mv_approxkl: 0.0011283591388750762
[INFO: 2020-09-09 20:32:37,140] mv_entropy: 0.09051304477470105
[INFO: 2020-09-09 20:43:32,991] ######## Iter (TEST) 5800 ########
[INFO: 2020-09-09 20:43:32,991] {'CIDEr': 1.3304905200411954}
[INFO: 2020-09-09 20:43:32,993] val_current @iteration 5800: 1.3123735081501327, val_predictor: 0
[INFO: 2020-09-09 20:43:32,993] mv_approxkl: 0.0014044975768443297
[INFO: 2020-09-09 20:43:32,993] mv_entropy: 0.09760929604429547
[INFO: 2020-09-09 20:54:28,892] ######## Iter (TEST) 6000 ########
[INFO: 2020-09-09 20:54:28,893] {'CIDEr': 1.3314862263834137}
[INFO: 2020-09-09 20:54:28,894] val_current @iteration 6000: 1.3110145090534884, val_predictor: 0
[INFO: 2020-09-09 20:54:28,894] mv_approxkl: 0.0012617516307205472
[INFO: 2020-09-09 20:54:28,894] mv_entropy: 0.09114058039879211
[INFO: 2020-09-09 21:05:21,660] ######## Iter (TEST) 6200 ########
[INFO: 2020-09-09 21:05:21,660] {'CIDEr': 1.3324896659930439}
[INFO: 2020-09-09 21:05:21,662] val_current @iteration 6200: 1.3097347649801756, val_predictor: 0
[INFO: 2020-09-09 21:05:21,662] mv_approxkl: 0.0012939016470997014
[INFO: 2020-09-09 21:05:21,662] mv_entropy: 0.09711901713832012
[INFO: 2020-09-09 21:16:14,548] ######## Iter (TEST) 6400 ########
[INFO: 2020-09-09 21:16:14,549] {'CIDEr': 1.331904549934633}
[INFO: 2020-09-09 21:16:14,551] val_current @iteration 6400: 1.3084128272474205, val_predictor: 0
[INFO: 2020-09-09 21:16:14,551] mv_approxkl: 0.0010761191255090603
[INFO: 2020-09-09 21:16:14,551] mv_entropy: 0.08819150167592983
[INFO: 2020-09-09 21:27:09,307] ######## Iter (TEST) 6600 ########
[INFO: 2020-09-09 21:27:09,308] {'CIDEr': 1.3301071200587564}
[INFO: 2020-09-09 21:27:09,309] val_current @iteration 6600: 1.3062751884649653, val_predictor: 0
[INFO: 2020-09-09 21:27:09,309] mv_approxkl: 0.0015078403509203207
[INFO: 2020-09-09 21:27:09,310] mv_entropy: 0.09388532349551225
[INFO: 2020-09-09 21:38:02,826] ######## Iter (TEST) 6800 ########
[INFO: 2020-09-09 21:38:02,826] {'CIDEr': 1.3318261475475606}
[INFO: 2020-09-09 21:38:02,828] val_current @iteration 6800: 1.309939903840053, val_predictor: 0
[INFO: 2020-09-09 21:38:02,828] mv_approxkl: 0.001470784410003237
[INFO: 2020-09-09 21:38:02,828] mv_entropy: 0.0971668918445473
[INFO: 2020-09-09 21:48:56,239] ######## Iter (TEST) 7000 ########
[INFO: 2020-09-09 21:48:56,239] {'CIDEr': 1.32921733436613}
[INFO: 2020-09-09 21:48:56,241] val_current @iteration 7000: 1.3114726635717808, val_predictor: 0
[INFO: 2020-09-09 21:48:56,241] mv_approxkl: 0.0015966478786600233
[INFO: 2020-09-09 21:48:56,241] mv_entropy: 0.09922358525769692
[INFO: 2020-09-09 21:59:52,514] ######## Iter (TEST) 7200 ########
[INFO: 2020-09-09 21:59:52,514] {'CIDEr': 1.3310745213709954}
[INFO: 2020-09-09 21:59:52,516] val_current @iteration 7200: 1.310611628472241, val_predictor: 0
[INFO: 2020-09-09 21:59:52,516] mv_approxkl: 0.0014186740839796125
[INFO: 2020-09-09 21:59:52,516] mv_entropy: 0.08648142690495284
[INFO: 2020-09-09 22:10:45,962] ######## Iter (TEST) 7400 ########
[INFO: 2020-09-09 22:10:45,963] {'CIDEr': 1.3338718493067196}
[INFO: 2020-09-09 22:10:45,965] val_current @iteration 7400: 1.3097741243506182, val_predictor: 0
[INFO: 2020-09-09 22:10:45,965] mv_approxkl: 0.0013438838777629504
[INFO: 2020-09-09 22:10:45,965] mv_entropy: 0.08922594387467166
[INFO: 2020-09-09 22:21:40,339] ######## Iter (TEST) 7600 ########
[INFO: 2020-09-09 22:21:40,339] {'CIDEr': 1.3338144970225365}
[INFO: 2020-09-09 22:21:40,341] val_current @iteration 7600: 1.3107763492732254, val_predictor: 0
[INFO: 2020-09-09 22:21:40,341] mv_approxkl: 0.0010684892822429952
[INFO: 2020-09-09 22:21:40,341] mv_entropy: 0.09403542416889515
[INFO: 2020-09-09 22:32:34,401] ######## Iter (TEST) 7800 ########
[INFO: 2020-09-09 22:32:34,401] {'CIDEr': 1.3303795369863805}
[INFO: 2020-09-09 22:32:34,403] val_current @iteration 7800: 1.309075402404859, val_predictor: 0
[INFO: 2020-09-09 22:32:34,403] mv_approxkl: 0.0014937052973348311
[INFO: 2020-09-09 22:32:34,403] mv_entropy: 0.09257319594107961
[INFO: 2020-09-09 22:43:29,016] ######## Iter (TEST) 8000 ########
[INFO: 2020-09-09 22:43:29,016] {'CIDEr': 1.3326322644350435}
[INFO: 2020-09-09 22:43:29,018] val_current @iteration 8000: 1.3075122020319294, val_predictor: 0
[INFO: 2020-09-09 22:43:29,018] mv_approxkl: 0.0019018109203558712
[INFO: 2020-09-09 22:43:29,018] mv_entropy: 0.08945432717518535
[INFO: 2020-09-09 22:47:46,403] Training with config:
[INFO: 2020-09-09 22:47:46,405] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 22:50:03,707] ######## Iter (TEST) 0 ########
[INFO: 2020-09-09 22:50:03,707] {'CIDEr': 1.1996348289986822}
[INFO: 2020-09-09 22:50:03,707] val_current @iteration 0: 1.178461593282439, val_predictor: 1.178461593282439
[INFO: 2020-09-09 22:52:55,983] ######## Iter (TEST) 16 ########
[INFO: 2020-09-09 22:52:55,983] {'CIDEr': 1.1983713967046579}
[INFO: 2020-09-09 22:52:55,983] val_current @iteration 16: 1.1783707692844914, val_predictor: 1.178461593282439
[INFO: 2020-09-09 22:52:55,983] mv_approxkl: 0.0751766375905899
[INFO: 2020-09-09 22:52:55,983] mv_entropy: 2.070744700188464
[INFO: 2020-09-09 22:54:52,389] Training with config:
[INFO: 2020-09-09 22:54:52,392] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 22:57:09,934] ######## Iter (TEST) 0 ########
[INFO: 2020-09-09 22:57:09,934] {'CIDEr': 1.1996348289986822}
[INFO: 2020-09-09 22:57:09,934] val_current @iteration 0: 1.178461593282439, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:00:01,720] ######## Iter (TEST) 16 ########
[INFO: 2020-09-09 23:00:01,721] {'CIDEr': 1.1999097091606241}
[INFO: 2020-09-09 23:00:01,721] val_current @iteration 16: 1.178550155696567, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:00:01,721] mv_approxkl: 0.07553529490249147
[INFO: 2020-09-09 23:00:01,721] mv_entropy: 2.087674078354286
[INFO: 2020-09-09 23:02:53,323] ######## Iter (TEST) 32 ########
[INFO: 2020-09-09 23:02:53,324] {'CIDEr': 1.200932011825404}
[INFO: 2020-09-09 23:02:53,324] val_current @iteration 32: 1.1787745192654218, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:02:53,324] mv_approxkl: 0.08773864027858577
[INFO: 2020-09-09 23:02:53,324] mv_entropy: 2.4552563342621845
[INFO: 2020-09-09 23:08:03,505] Training with config:
[INFO: 2020-09-09 23:08:03,507] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-09 23:10:19,593] ######## Iter (TEST) 0 ########
[INFO: 2020-09-09 23:10:19,594] {'CIDEr': 1.1996348289986822}
[INFO: 2020-09-09 23:10:19,594] val_current @iteration 0: 1.178461593282439, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:13:45,130] ######## Iter (TEST) 16 ########
[INFO: 2020-09-09 23:13:45,131] {'CIDEr': 1.1992633883437553}
[INFO: 2020-09-09 23:13:45,131] val_current @iteration 16: 1.1788342612538978, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:13:45,131] mv_approxkl: 0.08709500187668125
[INFO: 2020-09-09 23:13:45,131] mv_entropy: 2.4370390344264234
[INFO: 2020-09-09 23:17:10,292] ######## Iter (TEST) 32 ########
[INFO: 2020-09-09 23:17:10,293] {'CIDEr': 1.1997214643361804}
[INFO: 2020-09-09 23:17:10,293] val_current @iteration 32: 1.1785360913777088, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:17:10,293] mv_approxkl: 0.08903003312626559
[INFO: 2020-09-09 23:17:10,293] mv_entropy: 2.524011154715037
[INFO: 2020-09-09 23:20:35,701] ######## Iter (TEST) 48 ########
[INFO: 2020-09-09 23:20:35,701] {'CIDEr': 1.198520174640681}
[INFO: 2020-09-09 23:20:35,702] val_current @iteration 48: 1.1776280402404333, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:20:35,702] mv_approxkl: 0.08888809617498258
[INFO: 2020-09-09 23:20:35,702] mv_entropy: 2.4982280807147186
[INFO: 2020-09-09 23:23:59,610] ######## Iter (TEST) 64 ########
[INFO: 2020-09-09 23:23:59,611] {'CIDEr': 1.200417928432854}
[INFO: 2020-09-09 23:23:59,611] val_current @iteration 64: 1.179744101254994, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:23:59,611] mv_approxkl: 0.0894779666502656
[INFO: 2020-09-09 23:23:59,611] mv_entropy: 2.476741280583687
[INFO: 2020-09-09 23:27:23,757] ######## Iter (TEST) 80 ########
[INFO: 2020-09-09 23:27:23,757] {'CIDEr': 1.2003198376240614}
[INFO: 2020-09-09 23:27:23,757] val_current @iteration 80: 1.180249245125935, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:27:23,757] mv_approxkl: 0.08855947808393048
[INFO: 2020-09-09 23:27:23,757] mv_entropy: 2.4345679103594997
[INFO: 2020-09-09 23:30:48,466] ######## Iter (TEST) 96 ########
[INFO: 2020-09-09 23:30:48,466] {'CIDEr': 1.1996873842173208}
[INFO: 2020-09-09 23:30:48,466] val_current @iteration 96: 1.1774512583661234, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:30:48,466] mv_approxkl: 0.0873885165591595
[INFO: 2020-09-09 23:30:48,466] mv_entropy: 2.3902747939426887
[INFO: 2020-09-09 23:34:13,117] ######## Iter (TEST) 112 ########
[INFO: 2020-09-09 23:34:13,118] {'CIDEr': 1.1990656382810116}
[INFO: 2020-09-09 23:34:13,118] val_current @iteration 112: 1.1792356189451645, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:34:13,118] mv_approxkl: 0.08911419925373079
[INFO: 2020-09-09 23:34:13,118] mv_entropy: 2.3417304024335377
[INFO: 2020-09-09 23:37:39,352] ######## Iter (TEST) 128 ########
[INFO: 2020-09-09 23:37:39,353] {'CIDEr': 1.1997680185290236}
[INFO: 2020-09-09 23:37:39,353] val_current @iteration 128: 1.177156303577563, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:37:39,353] mv_approxkl: 0.08219466100516155
[INFO: 2020-09-09 23:37:39,353] mv_entropy: 2.261846546877514
[INFO: 2020-09-09 23:41:03,396] ######## Iter (TEST) 144 ########
[INFO: 2020-09-09 23:41:03,396] {'CIDEr': 1.1999745763607017}
[INFO: 2020-09-09 23:41:03,396] val_current @iteration 144: 1.1805297226759013, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:41:03,396] mv_approxkl: 0.08457405681992197
[INFO: 2020-09-09 23:41:03,396] mv_entropy: 2.2558362898155053
[INFO: 2020-09-09 23:44:27,848] ######## Iter (TEST) 160 ########
[INFO: 2020-09-09 23:44:27,848] {'CIDEr': 1.2005509238289533}
[INFO: 2020-09-09 23:44:27,848] val_current @iteration 160: 1.178803906576617, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:44:27,848] mv_approxkl: 0.08176857122190387
[INFO: 2020-09-09 23:44:27,848] mv_entropy: 2.1949995391545567
[INFO: 2020-09-09 23:47:54,138] ######## Iter (TEST) 176 ########
[INFO: 2020-09-09 23:47:54,138] {'CIDEr': 1.203645042031438}
[INFO: 2020-09-09 23:47:54,138] val_current @iteration 176: 1.1807464234730525, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:47:54,138] mv_approxkl: 0.08268782680739468
[INFO: 2020-09-09 23:47:54,138] mv_entropy: 2.1532404613911678
[INFO: 2020-09-09 23:51:18,605] ######## Iter (TEST) 192 ########
[INFO: 2020-09-09 23:51:18,605] {'CIDEr': 1.2043544174871845}
[INFO: 2020-09-09 23:51:18,605] val_current @iteration 192: 1.1819258808446407, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:51:18,605] mv_approxkl: 0.0792774471225066
[INFO: 2020-09-09 23:51:18,605] mv_entropy: 2.0932003791223694
[INFO: 2020-09-09 23:54:42,577] ######## Iter (TEST) 208 ########
[INFO: 2020-09-09 23:54:42,577] {'CIDEr': 1.202557462095572}
[INFO: 2020-09-09 23:54:42,577] val_current @iteration 208: 1.1823588878725872, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:54:42,578] mv_approxkl: 0.08157560704260568
[INFO: 2020-09-09 23:54:42,578] mv_entropy: 2.0744464649675316
[INFO: 2020-09-09 23:58:07,218] ######## Iter (TEST) 224 ########
[INFO: 2020-09-09 23:58:07,218] {'CIDEr': 1.2042855896504632}
[INFO: 2020-09-09 23:58:07,218] val_current @iteration 224: 1.1852581715740067, val_predictor: 1.178461593282439
[INFO: 2020-09-09 23:58:07,218] mv_approxkl: 0.07755108065567906
[INFO: 2020-09-09 23:58:07,218] mv_entropy: 2.018665886468406
[INFO: 2020-09-10 00:01:31,288] ######## Iter (TEST) 240 ########
[INFO: 2020-09-10 00:01:31,288] {'CIDEr': 1.2032353898289023}
[INFO: 2020-09-10 00:01:31,288] val_current @iteration 240: 1.1863483896117581, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:01:31,288] mv_approxkl: 0.0799686191735758
[INFO: 2020-09-10 00:01:31,288] mv_entropy: 1.977798683331029
[INFO: 2020-09-10 00:04:55,328] ######## Iter (TEST) 256 ########
[INFO: 2020-09-10 00:04:55,329] {'CIDEr': 1.202690889989139}
[INFO: 2020-09-10 00:04:55,329] val_current @iteration 256: 1.185497342703459, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:04:55,329] mv_approxkl: 0.07628033163552062
[INFO: 2020-09-10 00:04:55,329] mv_entropy: 1.9396952726057948
[INFO: 2020-09-10 00:08:19,962] ######## Iter (TEST) 272 ########
[INFO: 2020-09-10 00:08:19,962] {'CIDEr': 1.2047451559967965}
[INFO: 2020-09-10 00:08:19,962] val_current @iteration 272: 1.1881141426253474, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:08:19,962] mv_approxkl: 0.07551000554776625
[INFO: 2020-09-10 00:08:19,962] mv_entropy: 1.8921798554107658
[INFO: 2020-09-10 00:11:43,751] ######## Iter (TEST) 288 ########
[INFO: 2020-09-10 00:11:43,752] {'CIDEr': 1.2065076459339792}
[INFO: 2020-09-10 00:11:43,752] val_current @iteration 288: 1.1884674262247399, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:11:43,752] mv_approxkl: 0.07711888152124131
[INFO: 2020-09-10 00:11:43,752] mv_entropy: 1.846067531227778
[INFO: 2020-09-10 00:15:08,003] ######## Iter (TEST) 304 ########
[INFO: 2020-09-10 00:15:08,003] {'CIDEr': 1.2112640818415383}
[INFO: 2020-09-10 00:15:08,003] val_current @iteration 304: 1.1895911968227353, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:15:08,003] mv_approxkl: 0.07373087752084564
[INFO: 2020-09-10 00:15:08,003] mv_entropy: 1.8135435871584535
[INFO: 2020-09-10 00:18:31,804] ######## Iter (TEST) 320 ########
[INFO: 2020-09-10 00:18:31,804] {'CIDEr': 1.2111041825331763}
[INFO: 2020-09-10 00:18:31,804] val_current @iteration 320: 1.1896041371866395, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:18:31,804] mv_approxkl: 0.07242430492373635
[INFO: 2020-09-10 00:18:31,804] mv_entropy: 1.7573103846382985
[INFO: 2020-09-10 00:21:56,285] ######## Iter (TEST) 336 ########
[INFO: 2020-09-10 00:21:56,285] {'CIDEr': 1.2151721192935196}
[INFO: 2020-09-10 00:21:56,285] val_current @iteration 336: 1.1895199874875129, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:21:56,286] mv_approxkl: 0.07452352545023333
[INFO: 2020-09-10 00:21:56,286] mv_entropy: 1.708532522602059
[INFO: 2020-09-10 00:25:20,084] ######## Iter (TEST) 352 ########
[INFO: 2020-09-10 00:25:20,084] {'CIDEr': 1.2135975053150876}
[INFO: 2020-09-10 00:25:20,084] val_current @iteration 352: 1.18827526366688, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:25:20,084] mv_approxkl: 0.07682850588194867
[INFO: 2020-09-10 00:25:20,084] mv_entropy: 1.6984765369245844
[INFO: 2020-09-10 00:28:44,302] ######## Iter (TEST) 368 ########
[INFO: 2020-09-10 00:28:44,303] {'CIDEr': 1.21708161884686}
[INFO: 2020-09-10 00:28:44,303] val_current @iteration 368: 1.1901600765218054, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:28:44,303] mv_approxkl: 0.07161035427037868
[INFO: 2020-09-10 00:28:44,303] mv_entropy: 1.6803243023788257
[INFO: 2020-09-10 00:32:09,049] ######## Iter (TEST) 384 ########
[INFO: 2020-09-10 00:32:09,050] {'CIDEr': 1.2167269324568566}
[INFO: 2020-09-10 00:32:09,050] val_current @iteration 384: 1.1885795028930213, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:32:09,050] mv_approxkl: 0.07379498709647914
[INFO: 2020-09-10 00:32:09,050] mv_entropy: 1.6272212480463273
[INFO: 2020-09-10 00:35:32,094] ######## Iter (TEST) 400 ########
[INFO: 2020-09-10 00:35:32,094] {'CIDEr': 1.2146434562539483}
[INFO: 2020-09-10 00:35:32,095] val_current @iteration 400: 1.1904333005737884, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:35:32,095] mv_approxkl: 0.06812703207469009
[INFO: 2020-09-10 00:35:32,095] mv_entropy: 1.5827992019713828
[INFO: 2020-09-10 00:38:55,672] ######## Iter (TEST) 416 ########
[INFO: 2020-09-10 00:38:55,672] {'CIDEr': 1.2157320269651892}
[INFO: 2020-09-10 00:38:55,672] val_current @iteration 416: 1.1958593743969232, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:38:55,672] mv_approxkl: 0.0705101136777627
[INFO: 2020-09-10 00:38:55,672] mv_entropy: 1.5586570929291588
[INFO: 2020-09-10 00:42:20,012] ######## Iter (TEST) 432 ########
[INFO: 2020-09-10 00:42:20,012] {'CIDEr': 1.218716452904788}
[INFO: 2020-09-10 00:42:20,013] val_current @iteration 432: 1.1948676209005666, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:42:20,013] mv_approxkl: 0.06958896577696809
[INFO: 2020-09-10 00:42:20,013] mv_entropy: 1.4941185722345045
[INFO: 2020-09-10 00:45:42,920] ######## Iter (TEST) 448 ########
[INFO: 2020-09-10 00:45:42,920] {'CIDEr': 1.215445763735476}
[INFO: 2020-09-10 00:45:42,920] val_current @iteration 448: 1.1968825420588225, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:45:42,920] mv_approxkl: 0.07334372926191124
[INFO: 2020-09-10 00:45:42,920] mv_entropy: 1.5347172808383338
[INFO: 2020-09-10 00:49:07,161] ######## Iter (TEST) 464 ########
[INFO: 2020-09-10 00:49:07,161] {'CIDEr': 1.2157285078320668}
[INFO: 2020-09-10 00:49:07,161] val_current @iteration 464: 1.1929870387286508, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:49:07,161] mv_approxkl: 0.07131477824864316
[INFO: 2020-09-10 00:49:07,161] mv_entropy: 1.4874059451549542
[INFO: 2020-09-10 00:52:30,777] ######## Iter (TEST) 480 ########
[INFO: 2020-09-10 00:52:30,778] {'CIDEr': 1.213879268378854}
[INFO: 2020-09-10 00:52:30,778] val_current @iteration 480: 1.194694896776157, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:52:30,778] mv_approxkl: 0.06812872868217092
[INFO: 2020-09-10 00:52:30,778] mv_entropy: 1.4386919229664887
[INFO: 2020-09-10 00:55:53,212] ######## Iter (TEST) 496 ########
[INFO: 2020-09-10 00:55:53,212] {'CIDEr': 1.2137133093968462}
[INFO: 2020-09-10 00:55:53,212] val_current @iteration 496: 1.1937178003003155, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:55:53,212] mv_approxkl: 0.06646557464225715
[INFO: 2020-09-10 00:55:53,212] mv_entropy: 1.4040208051530834
[INFO: 2020-09-10 00:59:16,572] ######## Iter (TEST) 512 ########
[INFO: 2020-09-10 00:59:16,572] {'CIDEr': 1.2128101697161626}
[INFO: 2020-09-10 00:59:16,572] val_current @iteration 512: 1.194993791947664, val_predictor: 1.178461593282439
[INFO: 2020-09-10 00:59:16,572] mv_approxkl: 0.07277778760340518
[INFO: 2020-09-10 00:59:16,572] mv_entropy: 1.3735632064078775
[INFO: 2020-09-10 01:02:38,974] ######## Iter (TEST) 528 ########
[INFO: 2020-09-10 01:02:38,974] {'CIDEr': 1.2121877908981664}
[INFO: 2020-09-10 01:02:38,974] val_current @iteration 528: 1.19493800370213, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:02:38,974] mv_approxkl: 0.06425792678429262
[INFO: 2020-09-10 01:02:38,974] mv_entropy: 1.3214892189073946
[INFO: 2020-09-10 01:06:02,687] ######## Iter (TEST) 544 ########
[INFO: 2020-09-10 01:06:02,688] {'CIDEr': 1.2109502246051278}
[INFO: 2020-09-10 01:06:02,688] val_current @iteration 544: 1.1954641421440644, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:06:02,688] mv_approxkl: 0.06674455394121225
[INFO: 2020-09-10 01:06:02,688] mv_entropy: 1.3303459657287826
[INFO: 2020-09-10 01:09:26,142] ######## Iter (TEST) 560 ########
[INFO: 2020-09-10 01:09:26,143] {'CIDEr': 1.209893181203633}
[INFO: 2020-09-10 01:09:26,143] val_current @iteration 560: 1.1943337997183463, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:09:26,143] mv_approxkl: 0.06854373553121518
[INFO: 2020-09-10 01:09:26,143] mv_entropy: 1.3108799252585441
[INFO: 2020-09-10 01:12:48,421] ######## Iter (TEST) 576 ########
[INFO: 2020-09-10 01:12:48,421] {'CIDEr': 1.2111492052782278}
[INFO: 2020-09-10 01:12:48,421] val_current @iteration 576: 1.1943095843437581, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:12:48,421] mv_approxkl: 0.06630563055558555
[INFO: 2020-09-10 01:12:48,421] mv_entropy: 1.2521522233720637
[INFO: 2020-09-10 01:16:12,803] ######## Iter (TEST) 592 ########
[INFO: 2020-09-10 01:16:12,804] {'CIDEr': 1.2130508530280446}
[INFO: 2020-09-10 01:16:12,804] val_current @iteration 592: 1.1950517223648864, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:16:12,804] mv_approxkl: 0.06914704850770176
[INFO: 2020-09-10 01:16:12,804] mv_entropy: 1.282182161448103
[INFO: 2020-09-10 01:19:34,436] ######## Iter (TEST) 608 ########
[INFO: 2020-09-10 01:19:34,436] {'CIDEr': 1.215280944942329}
[INFO: 2020-09-10 01:19:34,436] val_current @iteration 608: 1.1958955588644982, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:19:34,436] mv_approxkl: 0.06544558828767186
[INFO: 2020-09-10 01:19:34,436] mv_entropy: 1.22044179843941
[INFO: 2020-09-10 01:22:54,986] ######## Iter (TEST) 624 ########
[INFO: 2020-09-10 01:22:54,986] {'CIDEr': 1.2165960614911495}
[INFO: 2020-09-10 01:22:54,986] val_current @iteration 624: 1.1975189610997587, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:22:54,986] mv_approxkl: 0.06704840961805769
[INFO: 2020-09-10 01:22:54,986] mv_entropy: 1.2304156806703823
[INFO: 2020-09-10 01:26:16,755] ######## Iter (TEST) 640 ########
[INFO: 2020-09-10 01:26:16,755] {'CIDEr': 1.2164819270728762}
[INFO: 2020-09-10 01:26:16,756] val_current @iteration 640: 1.1985910141631135, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:26:16,756] mv_approxkl: 0.06552200451420385
[INFO: 2020-09-10 01:26:16,756] mv_entropy: 1.1851983204099616
[INFO: 2020-09-10 01:29:38,601] ######## Iter (TEST) 656 ########
[INFO: 2020-09-10 01:29:38,601] {'CIDEr': 1.214626637927501}
[INFO: 2020-09-10 01:29:38,601] val_current @iteration 656: 1.1975965283283954, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:29:38,601] mv_approxkl: 0.07161268024068698
[INFO: 2020-09-10 01:29:38,601] mv_entropy: 1.203329886574945
[INFO: 2020-09-10 01:32:58,935] ######## Iter (TEST) 672 ########
[INFO: 2020-09-10 01:32:58,936] {'CIDEr': 1.2086733892398542}
[INFO: 2020-09-10 01:32:58,936] val_current @iteration 672: 1.1910779884038254, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:32:58,936] mv_approxkl: 0.06914153801459248
[INFO: 2020-09-10 01:32:58,936] mv_entropy: 1.1648567192082806
[INFO: 2020-09-10 01:36:20,132] ######## Iter (TEST) 688 ########
[INFO: 2020-09-10 01:36:20,132] {'CIDEr': 1.2079189138974318}
[INFO: 2020-09-10 01:36:20,132] val_current @iteration 688: 1.1945713100914426, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:36:20,132] mv_approxkl: 0.06740521297739016
[INFO: 2020-09-10 01:36:20,132] mv_entropy: 1.1583841740368288
[INFO: 2020-09-10 01:39:40,550] ######## Iter (TEST) 704 ########
[INFO: 2020-09-10 01:39:40,550] {'CIDEr': 1.2074679114992253}
[INFO: 2020-09-10 01:39:40,550] val_current @iteration 704: 1.192460410346852, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:39:40,550] mv_approxkl: 0.06234084407550365
[INFO: 2020-09-10 01:39:40,550] mv_entropy: 1.0952985937562472
[INFO: 2020-09-10 01:43:01,996] ######## Iter (TEST) 720 ########
[INFO: 2020-09-10 01:43:01,996] {'CIDEr': 1.2099071007592}
[INFO: 2020-09-10 01:43:01,996] val_current @iteration 720: 1.19216507360139, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:43:01,996] mv_approxkl: 0.06784494924532442
[INFO: 2020-09-10 01:43:01,997] mv_entropy: 1.1194900906689145
[INFO: 2020-09-10 01:46:23,188] ######## Iter (TEST) 736 ########
[INFO: 2020-09-10 01:46:23,188] {'CIDEr': 1.2125715189430784}
[INFO: 2020-09-10 01:46:23,188] val_current @iteration 736: 1.1931079807186398, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:46:23,188] mv_approxkl: 0.06847396691603456
[INFO: 2020-09-10 01:46:23,188] mv_entropy: 1.1252918606798663
[INFO: 2020-09-10 01:49:43,518] ######## Iter (TEST) 752 ########
[INFO: 2020-09-10 01:49:43,518] {'CIDEr': 1.2093925591783636}
[INFO: 2020-09-10 01:49:43,519] val_current @iteration 752: 1.1961237632406045, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:49:43,519] mv_approxkl: 0.067316368113725
[INFO: 2020-09-10 01:49:43,519] mv_entropy: 1.087075933661378
[INFO: 2020-09-10 01:53:04,023] ######## Iter (TEST) 768 ########
[INFO: 2020-09-10 01:53:04,023] {'CIDEr': 1.211423946449145}
[INFO: 2020-09-10 01:53:04,023] val_current @iteration 768: 1.195017930047301, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:53:04,023] mv_approxkl: 0.06515755690729223
[INFO: 2020-09-10 01:53:04,023] mv_entropy: 1.0690936494296426
[INFO: 2020-09-10 01:56:25,164] ######## Iter (TEST) 784 ########
[INFO: 2020-09-10 01:56:25,164] {'CIDEr': 1.2101503053300664}
[INFO: 2020-09-10 01:56:25,165] val_current @iteration 784: 1.1942522907784041, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:56:25,165] mv_approxkl: 0.06989389512321842
[INFO: 2020-09-10 01:56:25,165] mv_entropy: 1.0457364819853703
[INFO: 2020-09-10 01:59:45,733] ######## Iter (TEST) 800 ########
[INFO: 2020-09-10 01:59:45,733] {'CIDEr': 1.2097515359207556}
[INFO: 2020-09-10 01:59:45,733] val_current @iteration 800: 1.1946645620943948, val_predictor: 1.178461593282439
[INFO: 2020-09-10 01:59:45,733] mv_approxkl: 0.06804610767509554
[INFO: 2020-09-10 01:59:45,733] mv_entropy: 1.0459587112545863
[INFO: 2020-09-10 02:03:07,077] ######## Iter (TEST) 816 ########
[INFO: 2020-09-10 02:03:07,077] {'CIDEr': 1.2110146580585481}
[INFO: 2020-09-10 02:03:07,077] val_current @iteration 816: 1.1964445299512885, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:03:07,077] mv_approxkl: 0.06283033286542931
[INFO: 2020-09-10 02:03:07,077] mv_entropy: 0.9933916296497542
[INFO: 2020-09-10 02:06:28,306] ######## Iter (TEST) 832 ########
[INFO: 2020-09-10 02:06:28,306] {'CIDEr': 1.2101244279592696}
[INFO: 2020-09-10 02:06:28,306] val_current @iteration 832: 1.1956529873835018, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:06:28,306] mv_approxkl: 0.06944918143932167
[INFO: 2020-09-10 02:06:28,306] mv_entropy: 1.0429134552763824
[INFO: 2020-09-10 02:09:48,886] ######## Iter (TEST) 848 ########
[INFO: 2020-09-10 02:09:48,886] {'CIDEr': 1.2115927510731337}
[INFO: 2020-09-10 02:09:48,886] val_current @iteration 848: 1.1933430383290078, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:09:48,886] mv_approxkl: 0.06857537859216939
[INFO: 2020-09-10 02:09:48,886] mv_entropy: 1.0094154569441796
[INFO: 2020-09-10 02:13:10,067] ######## Iter (TEST) 864 ########
[INFO: 2020-09-10 02:13:10,067] {'CIDEr': 1.212161755816044}
[INFO: 2020-09-10 02:13:10,067] val_current @iteration 864: 1.1941828472029803, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:13:10,067] mv_approxkl: 0.07054960392083932
[INFO: 2020-09-10 02:13:10,067] mv_entropy: 0.9863275012266974
[INFO: 2020-09-10 02:16:30,342] ######## Iter (TEST) 880 ########
[INFO: 2020-09-10 02:16:30,342] {'CIDEr': 1.217390700159691}
[INFO: 2020-09-10 02:16:30,342] val_current @iteration 880: 1.1924211247494667, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:16:30,342] mv_approxkl: 0.0697271672154482
[INFO: 2020-09-10 02:16:30,342] mv_entropy: 0.9645404230285805
[INFO: 2020-09-10 02:19:50,956] ######## Iter (TEST) 896 ########
[INFO: 2020-09-10 02:19:50,956] {'CIDEr': 1.2150199941627968}
[INFO: 2020-09-10 02:19:50,956] val_current @iteration 896: 1.1915152543340213, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:19:50,956] mv_approxkl: 0.06949014161438986
[INFO: 2020-09-10 02:19:50,956] mv_entropy: 0.9488758317347649
[INFO: 2020-09-10 02:23:11,089] ######## Iter (TEST) 912 ########
[INFO: 2020-09-10 02:23:11,089] {'CIDEr': 1.2210795934633216}
[INFO: 2020-09-10 02:23:11,090] val_current @iteration 912: 1.1949455477701245, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:23:11,090] mv_approxkl: 0.06824830137372596
[INFO: 2020-09-10 02:23:11,090] mv_entropy: 0.9692125129111082
[INFO: 2020-09-10 02:26:30,736] ######## Iter (TEST) 928 ########
[INFO: 2020-09-10 02:26:30,736] {'CIDEr': 1.2188243301839858}
[INFO: 2020-09-10 02:26:30,736] val_current @iteration 928: 1.1939866431069797, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:26:30,736] mv_approxkl: 0.06717829976421757
[INFO: 2020-09-10 02:26:30,736] mv_entropy: 0.9390271914026879
[INFO: 2020-09-10 02:29:51,985] ######## Iter (TEST) 944 ########
[INFO: 2020-09-10 02:29:51,986] {'CIDEr': 1.2158416391290625}
[INFO: 2020-09-10 02:29:51,986] val_current @iteration 944: 1.1897045635758055, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:29:51,986] mv_approxkl: 0.06499180715541224
[INFO: 2020-09-10 02:29:51,986] mv_entropy: 0.8989713403499294
[INFO: 2020-09-10 02:33:12,486] ######## Iter (TEST) 960 ########
[INFO: 2020-09-10 02:33:12,487] {'CIDEr': 1.215296047203872}
[INFO: 2020-09-10 02:33:12,487] val_current @iteration 960: 1.1956753655795032, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:33:12,487] mv_approxkl: 0.06952502633547379
[INFO: 2020-09-10 02:33:12,487] mv_entropy: 0.8976757196235667
[INFO: 2020-09-10 02:36:31,426] ######## Iter (TEST) 976 ########
[INFO: 2020-09-10 02:36:31,426] {'CIDEr': 1.215956676596031}
[INFO: 2020-09-10 02:36:31,426] val_current @iteration 976: 1.1960427773431666, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:36:31,427] mv_approxkl: 0.06807465846616102
[INFO: 2020-09-10 02:36:31,427] mv_entropy: 0.9090134410630676
[INFO: 2020-09-10 02:39:52,045] ######## Iter (TEST) 992 ########
[INFO: 2020-09-10 02:39:52,045] {'CIDEr': 1.2144988289987426}
[INFO: 2020-09-10 02:39:52,045] val_current @iteration 992: 1.1961794205236216, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:39:52,045] mv_approxkl: 0.06422402071714262
[INFO: 2020-09-10 02:39:52,045] mv_entropy: 0.8766225517724497
[INFO: 2020-09-10 02:43:13,166] ######## Iter (TEST) 1008 ########
[INFO: 2020-09-10 02:43:13,166] {'CIDEr': 1.21222604581146}
[INFO: 2020-09-10 02:43:13,166] val_current @iteration 1008: 1.195104188037389, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:43:13,166] mv_approxkl: 0.0644481043721738
[INFO: 2020-09-10 02:43:13,166] mv_entropy: 0.8794013546182157
[INFO: 2020-09-10 02:46:32,497] ######## Iter (TEST) 1024 ########
[INFO: 2020-09-10 02:46:32,497] {'CIDEr': 1.2162166272045554}
[INFO: 2020-09-10 02:46:32,497] val_current @iteration 1024: 1.1960816618611712, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:46:32,497] mv_approxkl: 0.0671617904363542
[INFO: 2020-09-10 02:46:32,497] mv_entropy: 0.8600332462340237
[INFO: 2020-09-10 02:49:53,092] ######## Iter (TEST) 1040 ########
[INFO: 2020-09-10 02:49:53,093] {'CIDEr': 1.2134578888017455}
[INFO: 2020-09-10 02:49:53,093] val_current @iteration 1040: 1.193724548087587, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:49:53,093] mv_approxkl: 0.06881896335194193
[INFO: 2020-09-10 02:49:53,093] mv_entropy: 0.8779090312180229
[INFO: 2020-09-10 02:53:13,183] ######## Iter (TEST) 1056 ########
[INFO: 2020-09-10 02:53:13,184] {'CIDEr': 1.214242682675814}
[INFO: 2020-09-10 02:53:13,184] val_current @iteration 1056: 1.19718692645201, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:53:13,184] mv_approxkl: 0.06860680657196846
[INFO: 2020-09-10 02:53:13,184] mv_entropy: 0.8717147718019507
[INFO: 2020-09-10 02:56:32,807] ######## Iter (TEST) 1072 ########
[INFO: 2020-09-10 02:56:32,807] {'CIDEr': 1.215480682763611}
[INFO: 2020-09-10 02:56:32,807] val_current @iteration 1072: 1.1979096176790915, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:56:32,807] mv_approxkl: 0.07322739844394699
[INFO: 2020-09-10 02:56:32,807] mv_entropy: 0.8756917886867066
[INFO: 2020-09-10 02:59:53,951] ######## Iter (TEST) 1088 ########
[INFO: 2020-09-10 02:59:53,952] {'CIDEr': 1.2130669975210349}
[INFO: 2020-09-10 02:59:53,952] val_current @iteration 1088: 1.1977193340248697, val_predictor: 1.178461593282439
[INFO: 2020-09-10 02:59:53,952] mv_approxkl: 0.06737773109451248
[INFO: 2020-09-10 02:59:53,952] mv_entropy: 0.839315637293435
[INFO: 2020-09-10 03:03:12,952] ######## Iter (TEST) 1104 ########
[INFO: 2020-09-10 03:03:12,952] {'CIDEr': 1.2129386585822068}
[INFO: 2020-09-10 03:03:12,952] val_current @iteration 1104: 1.1966357160008338, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:03:12,952] mv_approxkl: 0.07181052570392389
[INFO: 2020-09-10 03:03:12,952] mv_entropy: 0.8532729489713884
[INFO: 2020-09-10 03:06:31,919] ######## Iter (TEST) 1120 ########
[INFO: 2020-09-10 03:06:31,920] {'CIDEr': 1.21399635953687}
[INFO: 2020-09-10 03:06:31,920] val_current @iteration 1120: 1.1945004619018744, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:06:31,920] mv_approxkl: 0.06798268282682905
[INFO: 2020-09-10 03:06:31,920] mv_entropy: 0.8177559900110194
[INFO: 2020-09-10 03:09:50,826] ######## Iter (TEST) 1136 ########
[INFO: 2020-09-10 03:09:50,826] {'CIDEr': 1.2133001117190858}
[INFO: 2020-09-10 03:09:50,826] val_current @iteration 1136: 1.19829710075914, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:09:50,826] mv_approxkl: 0.07040824696742075
[INFO: 2020-09-10 03:09:50,826] mv_entropy: 0.8250947677118715
[INFO: 2020-09-10 03:13:11,952] ######## Iter (TEST) 1152 ########
[INFO: 2020-09-10 03:13:11,952] {'CIDEr': 1.2116764157260218}
[INFO: 2020-09-10 03:13:11,952] val_current @iteration 1152: 1.1969281441150414, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:13:11,952] mv_approxkl: 0.06994847037676633
[INFO: 2020-09-10 03:13:11,952] mv_entropy: 0.8155789654574969
[INFO: 2020-09-10 03:16:32,177] ######## Iter (TEST) 1168 ########
[INFO: 2020-09-10 03:16:32,177] {'CIDEr': 1.2098229431274716}
[INFO: 2020-09-10 03:16:32,177] val_current @iteration 1168: 1.1939774934084115, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:16:32,177] mv_approxkl: 0.07319792650359773
[INFO: 2020-09-10 03:16:32,177] mv_entropy: 0.8151329516526933
[INFO: 2020-09-10 03:19:50,926] ######## Iter (TEST) 1184 ########
[INFO: 2020-09-10 03:19:50,926] {'CIDEr': 1.2125011043387393}
[INFO: 2020-09-10 03:19:50,926] val_current @iteration 1184: 1.1897216094864367, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:19:50,926] mv_approxkl: 0.0713842326369265
[INFO: 2020-09-10 03:19:50,926] mv_entropy: 0.7988799587479425
[INFO: 2020-09-10 03:23:12,144] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-10 03:23:12,144] {'CIDEr': 1.2163759033646915}
[INFO: 2020-09-10 03:23:12,144] val_current @iteration 1200: 1.1925052425471407, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:23:12,144] mv_approxkl: 0.07256278769021678
[INFO: 2020-09-10 03:23:12,144] mv_entropy: 0.8047253787717271
[INFO: 2020-09-10 03:26:32,713] ######## Iter (TEST) 1216 ########
[INFO: 2020-09-10 03:26:32,713] {'CIDEr': 1.2164146537153429}
[INFO: 2020-09-10 03:26:32,713] val_current @iteration 1216: 1.190788113097923, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:26:32,713] mv_approxkl: 0.07198626502146936
[INFO: 2020-09-10 03:26:32,713] mv_entropy: 0.7951487714166043
[INFO: 2020-09-10 03:29:52,435] ######## Iter (TEST) 1232 ########
[INFO: 2020-09-10 03:29:52,436] {'CIDEr': 1.2129169767820538}
[INFO: 2020-09-10 03:29:52,436] val_current @iteration 1232: 1.1903970882381663, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:29:52,436] mv_approxkl: 0.07520473281555155
[INFO: 2020-09-10 03:29:52,436] mv_entropy: 0.7763820917170156
[INFO: 2020-09-10 03:33:13,275] ######## Iter (TEST) 1248 ########
[INFO: 2020-09-10 03:33:13,276] {'CIDEr': 1.2146765323011797}
[INFO: 2020-09-10 03:33:13,276] val_current @iteration 1248: 1.19402954773682, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:33:13,276] mv_approxkl: 0.07305447224206654
[INFO: 2020-09-10 03:33:13,276] mv_entropy: 0.7470987252716058
[INFO: 2020-09-10 03:36:34,284] ######## Iter (TEST) 1264 ########
[INFO: 2020-09-10 03:36:34,284] {'CIDEr': 1.2116055429284462}
[INFO: 2020-09-10 03:36:34,284] val_current @iteration 1264: 1.1933615749602247, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:36:34,284] mv_approxkl: 0.07113749793877579
[INFO: 2020-09-10 03:36:34,284] mv_entropy: 0.7649223701257095
[INFO: 2020-09-10 03:39:52,549] ######## Iter (TEST) 1280 ########
[INFO: 2020-09-10 03:39:52,549] {'CIDEr': 1.2132151993112754}
[INFO: 2020-09-10 03:39:52,549] val_current @iteration 1280: 1.1959744243025732, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:39:52,549] mv_approxkl: 0.07144469601010765
[INFO: 2020-09-10 03:39:52,549] mv_entropy: 0.748729235978459
[INFO: 2020-09-10 03:43:13,015] ######## Iter (TEST) 1296 ########
[INFO: 2020-09-10 03:43:13,016] {'CIDEr': 1.2130600876885895}
[INFO: 2020-09-10 03:43:13,016] val_current @iteration 1296: 1.1957667187956311, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:43:13,016] mv_approxkl: 0.07354782653019108
[INFO: 2020-09-10 03:43:13,016] mv_entropy: 0.7284746741413143
[INFO: 2020-09-10 03:46:31,867] ######## Iter (TEST) 1312 ########
[INFO: 2020-09-10 03:46:31,868] {'CIDEr': 1.21288366863807}
[INFO: 2020-09-10 03:46:31,868] val_current @iteration 1312: 1.1943102561718943, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:46:31,868] mv_approxkl: 0.07402349365861473
[INFO: 2020-09-10 03:46:31,868] mv_entropy: 0.7471244205953304
[INFO: 2020-09-10 03:49:52,819] ######## Iter (TEST) 1328 ########
[INFO: 2020-09-10 03:49:52,819] {'CIDEr': 1.211984857721242}
[INFO: 2020-09-10 03:49:52,819] val_current @iteration 1328: 1.1946587597772031, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:49:52,819] mv_approxkl: 0.07249649914598251
[INFO: 2020-09-10 03:49:52,819] mv_entropy: 0.7430539016036052
[INFO: 2020-09-10 03:53:13,434] ######## Iter (TEST) 1344 ########
[INFO: 2020-09-10 03:53:13,434] {'CIDEr': 1.214022627609293}
[INFO: 2020-09-10 03:53:13,434] val_current @iteration 1344: 1.19249482709675, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:53:13,434] mv_approxkl: 0.0685532850892504
[INFO: 2020-09-10 03:53:13,435] mv_entropy: 0.7187000001734188
[INFO: 2020-09-10 03:56:33,036] ######## Iter (TEST) 1360 ########
[INFO: 2020-09-10 03:56:33,036] {'CIDEr': 1.2133888515238516}
[INFO: 2020-09-10 03:56:33,036] val_current @iteration 1360: 1.189420414971879, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:56:33,036] mv_approxkl: 0.07638197979222976
[INFO: 2020-09-10 03:56:33,036] mv_entropy: 0.7220374362611607
[INFO: 2020-09-10 03:59:53,156] ######## Iter (TEST) 1376 ########
[INFO: 2020-09-10 03:59:53,156] {'CIDEr': 1.2131354978247537}
[INFO: 2020-09-10 03:59:53,156] val_current @iteration 1376: 1.1892544166129113, val_predictor: 1.178461593282439
[INFO: 2020-09-10 03:59:53,156] mv_approxkl: 0.07629531769495418
[INFO: 2020-09-10 03:59:53,156] mv_entropy: 0.7188686361161437
[INFO: 2020-09-10 04:03:12,948] ######## Iter (TEST) 1392 ########
[INFO: 2020-09-10 04:03:12,948] {'CIDEr': 1.2171758275987614}
[INFO: 2020-09-10 04:03:12,948] val_current @iteration 1392: 1.1950976595057452, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:03:12,948] mv_approxkl: 0.07251989806269281
[INFO: 2020-09-10 04:03:12,948] mv_entropy: 0.7145179640760826
[INFO: 2020-09-10 04:06:32,580] ######## Iter (TEST) 1408 ########
[INFO: 2020-09-10 04:06:32,580] {'CIDEr': 1.2157781342639882}
[INFO: 2020-09-10 04:06:32,581] val_current @iteration 1408: 1.1969296436339427, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:06:32,581] mv_approxkl: 0.06928287477216097
[INFO: 2020-09-10 04:06:32,581] mv_entropy: 0.7054027580295336
[INFO: 2020-09-10 04:09:53,437] ######## Iter (TEST) 1424 ########
[INFO: 2020-09-10 04:09:53,437] {'CIDEr': 1.2154451680763534}
[INFO: 2020-09-10 04:09:53,437] val_current @iteration 1424: 1.195616336542, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:09:53,437] mv_approxkl: 0.07263157224399501
[INFO: 2020-09-10 04:09:53,437] mv_entropy: 0.714206816387761
[INFO: 2020-09-10 04:13:12,200] ######## Iter (TEST) 1440 ########
[INFO: 2020-09-10 04:13:12,200] {'CIDEr': 1.2112154218744566}
[INFO: 2020-09-10 04:13:12,200] val_current @iteration 1440: 1.1937817829368673, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:13:12,200] mv_approxkl: 0.07176845125468592
[INFO: 2020-09-10 04:13:12,200] mv_entropy: 0.6866939061811616
[INFO: 2020-09-10 04:16:32,456] ######## Iter (TEST) 1456 ########
[INFO: 2020-09-10 04:16:32,456] {'CIDEr': 1.211096712834357}
[INFO: 2020-09-10 04:16:32,456] val_current @iteration 1456: 1.193523799032493, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:16:32,456] mv_approxkl: 0.06912632709246233
[INFO: 2020-09-10 04:16:32,456] mv_entropy: 0.6547953803884783
[INFO: 2020-09-10 04:19:53,213] ######## Iter (TEST) 1472 ########
[INFO: 2020-09-10 04:19:53,213] {'CIDEr': 1.205287598988653}
[INFO: 2020-09-10 04:19:53,213] val_current @iteration 1472: 1.1869401569912459, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:19:53,213] mv_approxkl: 0.07256749993909975
[INFO: 2020-09-10 04:19:53,213] mv_entropy: 0.7002919482904941
[INFO: 2020-09-10 04:23:12,348] ######## Iter (TEST) 1488 ########
[INFO: 2020-09-10 04:23:12,348] {'CIDEr': 1.2088833879470116}
[INFO: 2020-09-10 04:23:12,349] val_current @iteration 1488: 1.1877949382349604, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:23:12,349] mv_approxkl: 0.07513651781389519
[INFO: 2020-09-10 04:23:12,349] mv_entropy: 0.6766480912845153
[INFO: 2020-09-10 04:26:32,809] ######## Iter (TEST) 1504 ########
[INFO: 2020-09-10 04:26:32,809] {'CIDEr': 1.2064416029075042}
[INFO: 2020-09-10 04:26:32,809] val_current @iteration 1504: 1.1880469193341014, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:26:32,809] mv_approxkl: 0.0744672187404364
[INFO: 2020-09-10 04:26:32,809] mv_entropy: 0.6685086436090378
[INFO: 2020-09-10 04:29:52,567] ######## Iter (TEST) 1520 ########
[INFO: 2020-09-10 04:29:52,568] {'CIDEr': 1.2056614557308984}
[INFO: 2020-09-10 04:29:52,568] val_current @iteration 1520: 1.1848502625331214, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:29:52,568] mv_approxkl: 0.07871381088898827
[INFO: 2020-09-10 04:29:52,568] mv_entropy: 0.6488258845390095
[INFO: 2020-09-10 04:33:12,505] ######## Iter (TEST) 1536 ########
[INFO: 2020-09-10 04:33:12,505] {'CIDEr': 1.2075619424944466}
[INFO: 2020-09-10 04:33:12,505] val_current @iteration 1536: 1.191012082729157, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:33:12,505] mv_approxkl: 0.07432146524416648
[INFO: 2020-09-10 04:33:12,506] mv_entropy: 0.6570290844103377
[INFO: 2020-09-10 04:36:32,427] ######## Iter (TEST) 1552 ########
[INFO: 2020-09-10 04:36:32,427] {'CIDEr': 1.2074665892067136}
[INFO: 2020-09-10 04:36:32,427] val_current @iteration 1552: 1.190563053579027, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:36:32,427] mv_approxkl: 0.075542448331648
[INFO: 2020-09-10 04:36:32,427] mv_entropy: 0.6513120320681807
[INFO: 2020-09-10 04:39:51,971] ######## Iter (TEST) 1568 ########
[INFO: 2020-09-10 04:39:51,971] {'CIDEr': 1.206038984860699}
[INFO: 2020-09-10 04:39:51,971] val_current @iteration 1568: 1.1857926243640802, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:39:51,971] mv_approxkl: 0.07243216471904688
[INFO: 2020-09-10 04:39:51,971] mv_entropy: 0.6562237218439264
[INFO: 2020-09-10 04:43:11,835] ######## Iter (TEST) 1584 ########
[INFO: 2020-09-10 04:43:11,836] {'CIDEr': 1.2045769047765333}
[INFO: 2020-09-10 04:43:11,836] val_current @iteration 1584: 1.1857576250204136, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:43:11,836] mv_approxkl: 0.07719217854473101
[INFO: 2020-09-10 04:43:11,836] mv_entropy: 0.6612203170708774
[INFO: 2020-09-10 04:46:32,456] ######## Iter (TEST) 1600 ########
[INFO: 2020-09-10 04:46:32,456] {'CIDEr': 1.2036366288779998}
[INFO: 2020-09-10 04:46:32,456] val_current @iteration 1600: 1.1861743157241667, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:46:32,456] mv_approxkl: 0.07444336312075
[INFO: 2020-09-10 04:46:32,456] mv_entropy: 0.6275738790929629
[INFO: 2020-09-10 04:49:51,239] ######## Iter (TEST) 1616 ########
[INFO: 2020-09-10 04:49:51,240] {'CIDEr': 1.2049280375586773}
[INFO: 2020-09-10 04:49:51,240] val_current @iteration 1616: 1.189230607092995, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:49:51,240] mv_approxkl: 0.07263461412120402
[INFO: 2020-09-10 04:49:51,240] mv_entropy: 0.6370772530254757
[INFO: 2020-09-10 04:53:11,938] ######## Iter (TEST) 1632 ########
[INFO: 2020-09-10 04:53:11,938] {'CIDEr': 1.2077861731439923}
[INFO: 2020-09-10 04:53:11,939] val_current @iteration 1632: 1.1918047553619564, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:53:11,939] mv_approxkl: 0.07747844137175838
[INFO: 2020-09-10 04:53:11,939] mv_entropy: 0.6414418946564409
[INFO: 2020-09-10 04:56:32,522] ######## Iter (TEST) 1648 ########
[INFO: 2020-09-10 04:56:32,522] {'CIDEr': 1.2053019299951122}
[INFO: 2020-09-10 04:56:32,523] val_current @iteration 1648: 1.1873210840931139, val_predictor: 1.178461593282439
[INFO: 2020-09-10 04:56:32,523] mv_approxkl: 0.07721028914111333
[INFO: 2020-09-10 04:56:32,523] mv_entropy: 0.6144194956187848
[INFO: 2020-09-10 05:00:35,427] Training with config:
[INFO: 2020-09-10 05:00:35,429] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 05:00:51,139] val_current @iteration 0: 0, val_predictor: 0
[INFO: 2020-09-10 05:04:14,558] ######## Iter (TEST) 16 ########
[INFO: 2020-09-10 05:04:14,559] {'CIDEr': 1.200370923572308}
[INFO: 2020-09-10 05:04:14,561] val_current @iteration 16: 1.1779876944817609, val_predictor: 0
[INFO: 2020-09-10 05:04:14,561] mv_approxkl: 1.6576202290253187e-06
[INFO: 2020-09-10 05:04:14,561] mv_entropy: 2.34144609467043
[INFO: 2020-09-10 05:07:35,303] ######## Iter (TEST) 32 ########
[INFO: 2020-09-10 05:07:35,304] {'CIDEr': 1.2000864088633623}
[INFO: 2020-09-10 05:07:35,306] val_current @iteration 32: 1.1782984194563604, val_predictor: 0
[INFO: 2020-09-10 05:07:35,306] mv_approxkl: 4.056690097138145e-06
[INFO: 2020-09-10 05:07:35,306] mv_entropy: 2.3636043862995297
[INFO: 2020-09-10 05:10:56,765] ######## Iter (TEST) 48 ########
[INFO: 2020-09-10 05:10:56,765] {'CIDEr': 1.198416404255709}
[INFO: 2020-09-10 05:10:56,767] val_current @iteration 48: 1.1812780203603164, val_predictor: 0
[INFO: 2020-09-10 05:10:56,767] mv_approxkl: 7.691096124188516e-06
[INFO: 2020-09-10 05:10:56,767] mv_entropy: 2.3606342590926395
[INFO: 2020-09-10 05:14:17,929] ######## Iter (TEST) 64 ########
[INFO: 2020-09-10 05:14:17,930] {'CIDEr': 1.2008849402488224}
[INFO: 2020-09-10 05:14:17,931] val_current @iteration 64: 1.1799567680108436, val_predictor: 0
[INFO: 2020-09-10 05:14:17,932] mv_approxkl: 1.0074534699831231e-05
[INFO: 2020-09-10 05:14:17,932] mv_entropy: 2.3014278458351822
[INFO: 2020-09-10 05:17:38,356] ######## Iter (TEST) 80 ########
[INFO: 2020-09-10 05:17:38,356] {'CIDEr': 1.200670263143099}
[INFO: 2020-09-10 05:17:38,358] val_current @iteration 80: 1.1820243072576224, val_predictor: 0
[INFO: 2020-09-10 05:17:38,358] mv_approxkl: 1.4083588344289475e-05
[INFO: 2020-09-10 05:17:38,358] mv_entropy: 2.301088754621078
[INFO: 2020-09-10 05:20:59,474] ######## Iter (TEST) 96 ########
[INFO: 2020-09-10 05:20:59,474] {'CIDEr': 1.2005111545899543}
[INFO: 2020-09-10 05:20:59,476] val_current @iteration 96: 1.1817647943669158, val_predictor: 0
[INFO: 2020-09-10 05:20:59,476] mv_approxkl: 1.8150187540025963e-05
[INFO: 2020-09-10 05:20:59,476] mv_entropy: 2.2221709194529233
[INFO: 2020-09-10 05:24:22,183] ######## Iter (TEST) 112 ########
[INFO: 2020-09-10 05:24:22,183] {'CIDEr': 1.2004247489499562}
[INFO: 2020-09-10 05:24:22,185] val_current @iteration 112: 1.1787563799080487, val_predictor: 0
[INFO: 2020-09-10 05:24:22,185] mv_approxkl: 1.8676821896265512e-05
[INFO: 2020-09-10 05:24:22,185] mv_entropy: 2.2153681560929166
[INFO: 2020-09-10 05:27:43,671] ######## Iter (TEST) 128 ########
[INFO: 2020-09-10 05:27:43,671] {'CIDEr': 1.2010205518619004}
[INFO: 2020-09-10 05:27:43,673] val_current @iteration 128: 1.1820131315720501, val_predictor: 0
[INFO: 2020-09-10 05:27:43,673] mv_approxkl: 1.860615942298062e-05
[INFO: 2020-09-10 05:27:43,673] mv_entropy: 2.1194291211760223
[INFO: 2020-09-10 05:31:05,429] ######## Iter (TEST) 144 ########
[INFO: 2020-09-10 05:31:05,429] {'CIDEr': 1.2009636817154046}
[INFO: 2020-09-10 05:31:05,431] val_current @iteration 144: 1.1825366584117067, val_predictor: 0
[INFO: 2020-09-10 05:31:05,431] mv_approxkl: 3.183908769865547e-05
[INFO: 2020-09-10 05:31:05,431] mv_entropy: 2.088576986438185
[INFO: 2020-09-10 05:34:27,203] ######## Iter (TEST) 160 ########
[INFO: 2020-09-10 05:34:27,203] {'CIDEr': 1.203035362809919}
[INFO: 2020-09-10 05:34:27,205] val_current @iteration 160: 1.1825985899750568, val_predictor: 0
[INFO: 2020-09-10 05:34:27,205] mv_approxkl: 2.4591964355399103e-05
[INFO: 2020-09-10 05:34:27,205] mv_entropy: 2.0121256598833868
[INFO: 2020-09-10 05:37:49,961] ######## Iter (TEST) 176 ########
[INFO: 2020-09-10 05:37:49,961] {'CIDEr': 1.2044658613984587}
[INFO: 2020-09-10 05:37:49,963] val_current @iteration 176: 1.1823501505244858, val_predictor: 0
[INFO: 2020-09-10 05:37:49,963] mv_approxkl: 3.250843040080893e-05
[INFO: 2020-09-10 05:37:49,963] mv_entropy: 1.9275027327165215
[INFO: 2020-09-10 05:41:12,426] ######## Iter (TEST) 192 ########
[INFO: 2020-09-10 05:41:12,427] {'CIDEr': 1.2079532186953326}
[INFO: 2020-09-10 05:41:12,430] val_current @iteration 192: 1.1846086138006606, val_predictor: 0
[INFO: 2020-09-10 05:41:12,430] mv_approxkl: 3.518752791764993e-05
[INFO: 2020-09-10 05:41:12,430] mv_entropy: 1.95779436858728
[INFO: 2020-09-10 05:44:32,718] ######## Iter (TEST) 208 ########
[INFO: 2020-09-10 05:44:32,718] {'CIDEr': 1.2082221602879735}
[INFO: 2020-09-10 05:44:32,720] val_current @iteration 208: 1.1848800191855422, val_predictor: 0
[INFO: 2020-09-10 05:44:32,720] mv_approxkl: 3.2426197886988586e-05
[INFO: 2020-09-10 05:44:32,720] mv_entropy: 1.870269454494621
[INFO: 2020-09-10 05:47:53,372] ######## Iter (TEST) 224 ########
[INFO: 2020-09-10 05:47:53,372] {'CIDEr': 1.2103614004981356}
[INFO: 2020-09-10 05:47:53,374] val_current @iteration 224: 1.188800353596949, val_predictor: 0
[INFO: 2020-09-10 05:47:53,374] mv_approxkl: 3.4040757802535606e-05
[INFO: 2020-09-10 05:47:53,374] mv_entropy: 1.8009255894272316
[INFO: 2020-09-10 05:51:14,218] ######## Iter (TEST) 240 ########
[INFO: 2020-09-10 05:51:14,218] {'CIDEr': 1.2114690731321505}
[INFO: 2020-09-10 05:51:14,220] val_current @iteration 240: 1.1937962185562636, val_predictor: 0
[INFO: 2020-09-10 05:51:14,220] mv_approxkl: 3.5662307898667396e-05
[INFO: 2020-09-10 05:51:14,220] mv_entropy: 1.7232374390578178
[INFO: 2020-09-10 05:54:33,848] ######## Iter (TEST) 256 ########
[INFO: 2020-09-10 05:54:33,849] {'CIDEr': 1.2130281533139957}
[INFO: 2020-09-10 05:54:33,850] val_current @iteration 256: 1.1944245344381539, val_predictor: 0
[INFO: 2020-09-10 05:54:33,850] mv_approxkl: 4.334503129509115e-05
[INFO: 2020-09-10 05:54:33,850] mv_entropy: 1.7116959558210516
[INFO: 2020-09-10 05:57:55,107] ######## Iter (TEST) 272 ########
[INFO: 2020-09-10 05:57:55,108] {'CIDEr': 1.2110894469113496}
[INFO: 2020-09-10 05:57:55,109] val_current @iteration 272: 1.1954392519147634, val_predictor: 0
[INFO: 2020-09-10 05:57:55,109] mv_approxkl: 4.917485092110179e-05
[INFO: 2020-09-10 05:57:55,110] mv_entropy: 1.6636214405461958
[INFO: 2020-09-10 06:01:15,319] ######## Iter (TEST) 288 ########
[INFO: 2020-09-10 06:01:15,319] {'CIDEr': 1.2120307826177228}
[INFO: 2020-09-10 06:01:15,321] val_current @iteration 288: 1.1961062331645467, val_predictor: 0
[INFO: 2020-09-10 06:01:15,321] mv_approxkl: 3.77977893942919e-05
[INFO: 2020-09-10 06:01:15,321] mv_entropy: 1.6297670267912687
[INFO: 2020-09-10 06:04:35,385] ######## Iter (TEST) 304 ########
[INFO: 2020-09-10 06:04:35,385] {'CIDEr': 1.2112826277794924}
[INFO: 2020-09-10 06:04:35,388] val_current @iteration 304: 1.1954398786757798, val_predictor: 0
[INFO: 2020-09-10 06:04:35,388] mv_approxkl: 4.976378497873347e-05
[INFO: 2020-09-10 06:04:35,388] mv_entropy: 1.561848465535742
[INFO: 2020-09-10 06:07:55,549] ######## Iter (TEST) 320 ########
[INFO: 2020-09-10 06:07:55,549] {'CIDEr': 1.2132019321372285}
[INFO: 2020-09-10 06:07:55,551] val_current @iteration 320: 1.196076206392748, val_predictor: 0
[INFO: 2020-09-10 06:07:55,551] mv_approxkl: 4.965326393184564e-05
[INFO: 2020-09-10 06:07:55,551] mv_entropy: 1.5284171576308236
[INFO: 2020-09-10 06:11:15,575] ######## Iter (TEST) 336 ########
[INFO: 2020-09-10 06:11:15,575] {'CIDEr': 1.217355048020748}
[INFO: 2020-09-10 06:11:15,577] val_current @iteration 336: 1.2028605218748585, val_predictor: 0
[INFO: 2020-09-10 06:11:15,577] mv_approxkl: 5.092339594850958e-05
[INFO: 2020-09-10 06:11:15,577] mv_entropy: 1.471502603375008
[INFO: 2020-09-10 06:14:37,678] ######## Iter (TEST) 352 ########
[INFO: 2020-09-10 06:14:37,679] {'CIDEr': 1.2181165101397855}
[INFO: 2020-09-10 06:14:37,680] val_current @iteration 352: 1.2028462474812407, val_predictor: 0
[INFO: 2020-09-10 06:14:37,680] mv_approxkl: 6.144338551756338e-05
[INFO: 2020-09-10 06:14:37,680] mv_entropy: 1.450680817318565
[INFO: 2020-09-10 06:17:58,783] ######## Iter (TEST) 368 ########
[INFO: 2020-09-10 06:17:58,783] {'CIDEr': 1.2208392286751655}
[INFO: 2020-09-10 06:17:58,785] val_current @iteration 368: 1.2075128035261875, val_predictor: 0
[INFO: 2020-09-10 06:17:58,785] mv_approxkl: 5.132313581863947e-05
[INFO: 2020-09-10 06:17:58,785] mv_entropy: 1.3830012099891225
[INFO: 2020-09-10 06:21:18,783] ######## Iter (TEST) 384 ########
[INFO: 2020-09-10 06:21:18,783] {'CIDEr': 1.2210526522953786}
[INFO: 2020-09-10 06:21:18,786] val_current @iteration 384: 1.2055789603298792, val_predictor: 0
[INFO: 2020-09-10 06:21:18,786] mv_approxkl: 6.229165454722918e-05
[INFO: 2020-09-10 06:21:18,786] mv_entropy: 1.3737340887913407
[INFO: 2020-09-10 06:24:39,529] ######## Iter (TEST) 400 ########
[INFO: 2020-09-10 06:24:39,529] {'CIDEr': 1.2238960728360737}
[INFO: 2020-09-10 06:24:39,531] val_current @iteration 400: 1.2085452575515825, val_predictor: 0
[INFO: 2020-09-10 06:24:39,531] mv_approxkl: 6.782667395848285e-05
[INFO: 2020-09-10 06:24:39,531] mv_entropy: 1.3173141176570478
[INFO: 2020-09-10 06:27:59,104] ######## Iter (TEST) 416 ########
[INFO: 2020-09-10 06:27:59,104] {'CIDEr': 1.2196729367449068}
[INFO: 2020-09-10 06:27:59,106] val_current @iteration 416: 1.209803326873977, val_predictor: 0
[INFO: 2020-09-10 06:27:59,106] mv_approxkl: 7.980420509008666e-05
[INFO: 2020-09-10 06:27:59,106] mv_entropy: 1.2901933138787995
[INFO: 2020-09-10 06:31:18,186] ######## Iter (TEST) 432 ########
[INFO: 2020-09-10 06:31:18,187] {'CIDEr': 1.2219806014285162}
[INFO: 2020-09-10 06:31:18,188] val_current @iteration 432: 1.2130036539165647, val_predictor: 0
[INFO: 2020-09-10 06:31:18,188] mv_approxkl: 6.10812162390568e-05
[INFO: 2020-09-10 06:31:18,188] mv_entropy: 1.2567231255748128
[INFO: 2020-09-10 06:34:38,667] ######## Iter (TEST) 448 ########
[INFO: 2020-09-10 06:34:38,667] {'CIDEr': 1.226013953400642}
[INFO: 2020-09-10 06:34:38,669] val_current @iteration 448: 1.2144379610423368, val_predictor: 0
[INFO: 2020-09-10 06:34:38,669] mv_approxkl: 9.534303327844735e-05
[INFO: 2020-09-10 06:34:38,669] mv_entropy: 1.2373041271575902
[INFO: 2020-09-10 06:37:58,891] ######## Iter (TEST) 464 ########
[INFO: 2020-09-10 06:37:58,891] {'CIDEr': 1.2300679405635597}
[INFO: 2020-09-10 06:37:58,893] val_current @iteration 464: 1.2161880897130808, val_predictor: 0
[INFO: 2020-09-10 06:37:58,893] mv_approxkl: 9.195843327670247e-05
[INFO: 2020-09-10 06:37:58,893] mv_entropy: 1.195667252542743
[INFO: 2020-09-10 06:41:18,329] ######## Iter (TEST) 480 ########
[INFO: 2020-09-10 06:41:18,330] {'CIDEr': 1.2313107478484682}
[INFO: 2020-09-10 06:41:18,331] val_current @iteration 480: 1.2180346685613639, val_predictor: 0
[INFO: 2020-09-10 06:41:18,332] mv_approxkl: 6.640298977710177e-05
[INFO: 2020-09-10 06:41:18,332] mv_entropy: 1.1664069894682032
[INFO: 2020-09-10 06:44:37,551] ######## Iter (TEST) 496 ########
[INFO: 2020-09-10 06:44:37,551] {'CIDEr': 1.2346083126187195}
[INFO: 2020-09-10 06:44:37,553] val_current @iteration 496: 1.2141082212364704, val_predictor: 0
[INFO: 2020-09-10 06:44:37,553] mv_approxkl: 6.674019392522163e-05
[INFO: 2020-09-10 06:44:37,553] mv_entropy: 1.1583850328249912
[INFO: 2020-09-10 06:47:56,301] ######## Iter (TEST) 512 ########
[INFO: 2020-09-10 06:47:56,301] {'CIDEr': 1.2357753206831659}
[INFO: 2020-09-10 06:47:56,303] val_current @iteration 512: 1.215284935399766, val_predictor: 0
[INFO: 2020-09-10 06:47:56,303] mv_approxkl: 8.160158161095462e-05
[INFO: 2020-09-10 06:47:56,303] mv_entropy: 1.120630973881374
[INFO: 2020-09-10 06:51:15,512] ######## Iter (TEST) 528 ########
[INFO: 2020-09-10 06:51:15,512] {'CIDEr': 1.233352995460588}
[INFO: 2020-09-10 06:51:15,514] val_current @iteration 528: 1.220223531206779, val_predictor: 0
[INFO: 2020-09-10 06:51:15,514] mv_approxkl: 8.891766689000824e-05
[INFO: 2020-09-10 06:51:15,514] mv_entropy: 1.0723522410487853
[INFO: 2020-09-10 06:54:34,237] ######## Iter (TEST) 544 ########
[INFO: 2020-09-10 06:54:34,237] {'CIDEr': 1.2336501278490999}
[INFO: 2020-09-10 06:54:34,239] val_current @iteration 544: 1.2178114091081835, val_predictor: 0
[INFO: 2020-09-10 06:54:34,239] mv_approxkl: 7.75899131373426e-05
[INFO: 2020-09-10 06:54:34,239] mv_entropy: 1.076901916179168
[INFO: 2020-09-10 06:57:53,462] ######## Iter (TEST) 560 ########
[INFO: 2020-09-10 06:57:53,463] {'CIDEr': 1.2325350447173162}
[INFO: 2020-09-10 06:57:53,464] val_current @iteration 560: 1.2180933637025786, val_predictor: 0
[INFO: 2020-09-10 06:57:53,465] mv_approxkl: 0.00010202815783933793
[INFO: 2020-09-10 06:57:53,465] mv_entropy: 1.0243435210833602
[INFO: 2020-09-10 07:01:13,345] ######## Iter (TEST) 576 ########
[INFO: 2020-09-10 07:01:13,346] {'CIDEr': 1.235071490352667}
[INFO: 2020-09-10 07:01:13,348] val_current @iteration 576: 1.2175906412761013, val_predictor: 0
[INFO: 2020-09-10 07:01:13,348] mv_approxkl: 6.537055216552907e-05
[INFO: 2020-09-10 07:01:13,348] mv_entropy: 1.0231161930835635
[INFO: 2020-09-10 07:04:32,899] ######## Iter (TEST) 592 ########
[INFO: 2020-09-10 07:04:32,899] {'CIDEr': 1.2325329977857378}
[INFO: 2020-09-10 07:04:32,901] val_current @iteration 592: 1.2153585338608066, val_predictor: 0
[INFO: 2020-09-10 07:04:32,901] mv_approxkl: 0.00014068482764943163
[INFO: 2020-09-10 07:04:32,901] mv_entropy: 1.0076323466850337
[INFO: 2020-09-10 07:07:52,199] ######## Iter (TEST) 608 ########
[INFO: 2020-09-10 07:07:52,199] {'CIDEr': 1.2337551992829525}
[INFO: 2020-09-10 07:07:52,201] val_current @iteration 608: 1.2173212220031302, val_predictor: 0
[INFO: 2020-09-10 07:07:52,201] mv_approxkl: 9.220764366604565e-05
[INFO: 2020-09-10 07:07:52,201] mv_entropy: 0.9832343707125315
[INFO: 2020-09-10 07:11:10,952] ######## Iter (TEST) 624 ########
[INFO: 2020-09-10 07:11:10,953] {'CIDEr': 1.233735141378742}
[INFO: 2020-09-10 07:11:10,954] val_current @iteration 624: 1.2156953948494098, val_predictor: 0
[INFO: 2020-09-10 07:11:10,954] mv_approxkl: 0.00012948543258615322
[INFO: 2020-09-10 07:11:10,954] mv_entropy: 0.9721629903071315
[INFO: 2020-09-10 07:14:29,567] ######## Iter (TEST) 640 ########
[INFO: 2020-09-10 07:14:29,567] {'CIDEr': 1.2336202666017155}
[INFO: 2020-09-10 07:14:29,569] val_current @iteration 640: 1.2188114712875187, val_predictor: 0
[INFO: 2020-09-10 07:14:29,569] mv_approxkl: 0.00013699773533591746
[INFO: 2020-09-10 07:14:29,569] mv_entropy: 0.9362969321897647
[INFO: 2020-09-10 07:17:47,132] ######## Iter (TEST) 656 ########
[INFO: 2020-09-10 07:17:47,132] {'CIDEr': 1.234782936031219}
[INFO: 2020-09-10 07:17:47,134] val_current @iteration 656: 1.2267437724178516, val_predictor: 0
[INFO: 2020-09-10 07:17:47,134] mv_approxkl: 0.0001077871659016155
[INFO: 2020-09-10 07:17:47,134] mv_entropy: 0.8908890079640845
[INFO: 2020-09-10 07:21:05,069] ######## Iter (TEST) 672 ########
[INFO: 2020-09-10 07:21:05,070] {'CIDEr': 1.2344693847059582}
[INFO: 2020-09-10 07:21:05,071] val_current @iteration 672: 1.2256617773413065, val_predictor: 0
[INFO: 2020-09-10 07:21:05,072] mv_approxkl: 0.0001039146233052199
[INFO: 2020-09-10 07:21:05,072] mv_entropy: 0.9018195532423186
[INFO: 2020-09-10 07:24:22,421] ######## Iter (TEST) 688 ########
[INFO: 2020-09-10 07:24:22,422] {'CIDEr': 1.2363007726918631}
[INFO: 2020-09-10 07:24:22,424] val_current @iteration 688: 1.2245148068990945, val_predictor: 0
[INFO: 2020-09-10 07:24:22,424] mv_approxkl: 0.00015349305689835936
[INFO: 2020-09-10 07:24:22,424] mv_entropy: 0.8665732769998603
[INFO: 2020-09-10 07:27:40,604] ######## Iter (TEST) 704 ########
[INFO: 2020-09-10 07:27:40,604] {'CIDEr': 1.2364617803145128}
[INFO: 2020-09-10 07:27:40,606] val_current @iteration 704: 1.224702069789747, val_predictor: 0
[INFO: 2020-09-10 07:27:40,606] mv_approxkl: 0.00015804184711893076
[INFO: 2020-09-10 07:27:40,606] mv_entropy: 0.8630099378709944
[INFO: 2020-09-10 07:30:58,454] ######## Iter (TEST) 720 ########
[INFO: 2020-09-10 07:30:58,455] {'CIDEr': 1.2400983020170955}
[INFO: 2020-09-10 07:30:58,457] val_current @iteration 720: 1.2264631021377164, val_predictor: 0
[INFO: 2020-09-10 07:30:58,457] mv_approxkl: 0.00011707553524177748
[INFO: 2020-09-10 07:30:58,457] mv_entropy: 0.8587843388153663
[INFO: 2020-09-10 07:34:15,664] ######## Iter (TEST) 736 ########
[INFO: 2020-09-10 07:34:15,664] {'CIDEr': 1.2380667552078959}
[INFO: 2020-09-10 07:34:15,666] val_current @iteration 736: 1.2305575281887184, val_predictor: 0
[INFO: 2020-09-10 07:34:15,666] mv_approxkl: 0.00013316084655165284
[INFO: 2020-09-10 07:34:15,666] mv_entropy: 0.8303684394063194
[INFO: 2020-09-10 07:37:33,658] ######## Iter (TEST) 752 ########
[INFO: 2020-09-10 07:37:33,659] {'CIDEr': 1.238179552310529}
[INFO: 2020-09-10 07:37:33,661] val_current @iteration 752: 1.2329259782388806, val_predictor: 0
[INFO: 2020-09-10 07:37:33,661] mv_approxkl: 0.00020094694973751104
[INFO: 2020-09-10 07:37:33,661] mv_entropy: 0.8509137095098693
[INFO: 2020-09-10 07:40:51,765] ######## Iter (TEST) 768 ########
[INFO: 2020-09-10 07:40:51,765] {'CIDEr': 1.2388013979383967}
[INFO: 2020-09-10 07:40:51,767] val_current @iteration 768: 1.2361990664994207, val_predictor: 0
[INFO: 2020-09-10 07:40:51,767] mv_approxkl: 0.00014532180105140014
[INFO: 2020-09-10 07:40:51,767] mv_entropy: 0.7963523929128142
[INFO: 2020-09-10 07:44:09,818] ######## Iter (TEST) 784 ########
[INFO: 2020-09-10 07:44:09,818] {'CIDEr': 1.2365208726973103}
[INFO: 2020-09-10 07:44:09,820] val_current @iteration 784: 1.2313388054147134, val_predictor: 0
[INFO: 2020-09-10 07:44:09,820] mv_approxkl: 0.00019880684910075872
[INFO: 2020-09-10 07:44:09,820] mv_entropy: 0.7843522438942252
[INFO: 2020-09-10 07:47:28,506] ######## Iter (TEST) 800 ########
[INFO: 2020-09-10 07:47:28,506] {'CIDEr': 1.2445664576670097}
[INFO: 2020-09-10 07:47:28,508] val_current @iteration 800: 1.2298191907888143, val_predictor: 0
[INFO: 2020-09-10 07:47:28,508] mv_approxkl: 0.00019134255114656106
[INFO: 2020-09-10 07:47:28,508] mv_entropy: 0.7845585520344519
[INFO: 2020-09-10 07:50:45,417] ######## Iter (TEST) 816 ########
[INFO: 2020-09-10 07:50:45,417] {'CIDEr': 1.247848611690805}
[INFO: 2020-09-10 07:50:45,419] val_current @iteration 816: 1.2319173312444534, val_predictor: 0
[INFO: 2020-09-10 07:50:45,419] mv_approxkl: 0.00020288360895160594
[INFO: 2020-09-10 07:50:45,419] mv_entropy: 0.771384085675415
[INFO: 2020-09-10 07:54:03,524] ######## Iter (TEST) 832 ########
[INFO: 2020-09-10 07:54:03,525] {'CIDEr': 1.250348225288378}
[INFO: 2020-09-10 07:54:03,526] val_current @iteration 832: 1.2289559651916062, val_predictor: 0
[INFO: 2020-09-10 07:54:03,526] mv_approxkl: 0.0001958867896663082
[INFO: 2020-09-10 07:54:03,526] mv_entropy: 0.7798008708895519
[INFO: 2020-09-10 07:57:20,397] ######## Iter (TEST) 848 ########
[INFO: 2020-09-10 07:57:20,397] {'CIDEr': 1.2515994356409617}
[INFO: 2020-09-10 07:57:20,399] val_current @iteration 848: 1.2332997669659034, val_predictor: 0
[INFO: 2020-09-10 07:57:20,399] mv_approxkl: 0.00015314680922022864
[INFO: 2020-09-10 07:57:20,399] mv_entropy: 0.7540228218690044
[INFO: 2020-09-10 08:00:38,052] ######## Iter (TEST) 864 ########
[INFO: 2020-09-10 08:00:38,052] {'CIDEr': 1.248848133132252}
[INFO: 2020-09-10 08:00:38,054] val_current @iteration 864: 1.2378635394542663, val_predictor: 0
[INFO: 2020-09-10 08:00:38,054] mv_approxkl: 0.00018013317634945828
[INFO: 2020-09-10 08:00:38,054] mv_entropy: 0.7382939835382832
[INFO: 2020-09-10 08:03:56,683] ######## Iter (TEST) 880 ########
[INFO: 2020-09-10 08:03:56,683] {'CIDEr': 1.2542940657365065}
[INFO: 2020-09-10 08:03:56,685] val_current @iteration 880: 1.2370890602366258, val_predictor: 0
[INFO: 2020-09-10 08:03:56,685] mv_approxkl: 0.00014951665116281988
[INFO: 2020-09-10 08:03:56,685] mv_entropy: 0.6856532554348848
[INFO: 2020-09-10 08:07:13,725] ######## Iter (TEST) 896 ########
[INFO: 2020-09-10 08:07:13,725] {'CIDEr': 1.2537411010684456}
[INFO: 2020-09-10 08:07:13,727] val_current @iteration 896: 1.2352714796944948, val_predictor: 0
[INFO: 2020-09-10 08:07:13,727] mv_approxkl: 0.00020544240779098353
[INFO: 2020-09-10 08:07:13,727] mv_entropy: 0.7000020891244843
[INFO: 2020-09-10 08:10:31,940] ######## Iter (TEST) 912 ########
[INFO: 2020-09-10 08:10:31,940] {'CIDEr': 1.250955045848696}
[INFO: 2020-09-10 08:10:31,942] val_current @iteration 912: 1.2395684432724687, val_predictor: 0
[INFO: 2020-09-10 08:10:31,942] mv_approxkl: 0.0002198656536645986
[INFO: 2020-09-10 08:10:31,942] mv_entropy: 0.6776577245448279
[INFO: 2020-09-10 08:13:49,316] ######## Iter (TEST) 928 ########
[INFO: 2020-09-10 08:13:49,316] {'CIDEr': 1.2514167590965397}
[INFO: 2020-09-10 08:13:49,318] val_current @iteration 928: 1.2436177254268515, val_predictor: 0
[INFO: 2020-09-10 08:13:49,318] mv_approxkl: 0.00020332367426021544
[INFO: 2020-09-10 08:13:49,318] mv_entropy: 0.6753652936679341
[INFO: 2020-09-10 08:17:07,432] ######## Iter (TEST) 944 ########
[INFO: 2020-09-10 08:17:07,433] {'CIDEr': 1.2504824007153241}
[INFO: 2020-09-10 08:17:07,434] val_current @iteration 944: 1.2427179436820865, val_predictor: 0
[INFO: 2020-09-10 08:17:07,434] mv_approxkl: 0.00014475923514503815
[INFO: 2020-09-10 08:17:07,434] mv_entropy: 0.6731714826189663
[INFO: 2020-09-10 08:20:25,908] ######## Iter (TEST) 960 ########
[INFO: 2020-09-10 08:20:25,908] {'CIDEr': 1.2506472617701303}
[INFO: 2020-09-10 08:20:25,910] val_current @iteration 960: 1.2446027710285046, val_predictor: 0
[INFO: 2020-09-10 08:20:25,910] mv_approxkl: 0.0003133380534873347
[INFO: 2020-09-10 08:20:25,910] mv_entropy: 0.6400555026254513
[INFO: 2020-09-10 08:23:43,420] ######## Iter (TEST) 976 ########
[INFO: 2020-09-10 08:23:43,420] {'CIDEr': 1.2520823627653077}
[INFO: 2020-09-10 08:23:43,422] val_current @iteration 976: 1.242198119374624, val_predictor: 0
[INFO: 2020-09-10 08:23:43,422] mv_approxkl: 0.000211046326697923
[INFO: 2020-09-10 08:23:43,422] mv_entropy: 0.6518478774904324
[INFO: 2020-09-10 08:27:00,012] ######## Iter (TEST) 992 ########
[INFO: 2020-09-10 08:27:00,013] {'CIDEr': 1.2538011255096302}
[INFO: 2020-09-10 08:27:00,014] val_current @iteration 992: 1.2463525459189237, val_predictor: 0
[INFO: 2020-09-10 08:27:00,015] mv_approxkl: 0.00027261714870977644
[INFO: 2020-09-10 08:27:00,015] mv_entropy: 0.6559738944521276
[INFO: 2020-09-10 08:30:23,844] ######## Iter (TEST) 1008 ########
[INFO: 2020-09-10 08:30:23,844] {'CIDEr': 1.2511990023542703}
[INFO: 2020-09-10 08:30:23,846] val_current @iteration 1008: 1.2438246660754815, val_predictor: 0
[INFO: 2020-09-10 08:30:23,846] mv_approxkl: 0.00016319516283102952
[INFO: 2020-09-10 08:30:23,846] mv_entropy: 0.6387516100819582
[INFO: 2020-09-10 08:33:40,315] ######## Iter (TEST) 1024 ########
[INFO: 2020-09-10 08:33:40,316] {'CIDEr': 1.2536470840594478}
[INFO: 2020-09-10 08:33:40,318] val_current @iteration 1024: 1.246239038406881, val_predictor: 0
[INFO: 2020-09-10 08:33:40,318] mv_approxkl: 0.0003054245910684894
[INFO: 2020-09-10 08:33:40,318] mv_entropy: 0.6527370367678836
[INFO: 2020-09-10 08:36:57,885] ######## Iter (TEST) 1040 ########
[INFO: 2020-09-10 08:36:57,885] {'CIDEr': 1.2557740217917333}
[INFO: 2020-09-10 08:36:57,887] val_current @iteration 1040: 1.2496586525136106, val_predictor: 0
[INFO: 2020-09-10 08:36:57,887] mv_approxkl: 0.00023955457249417097
[INFO: 2020-09-10 08:36:57,887] mv_entropy: 0.6140452877449558
[INFO: 2020-09-10 08:40:14,935] ######## Iter (TEST) 1056 ########
[INFO: 2020-09-10 08:40:14,935] {'CIDEr': 1.2512341181690245}
[INFO: 2020-09-10 08:40:14,937] val_current @iteration 1056: 1.248338199692446, val_predictor: 0
[INFO: 2020-09-10 08:40:14,937] mv_approxkl: 0.00018433971575308408
[INFO: 2020-09-10 08:40:14,937] mv_entropy: 0.5843926421401373
[INFO: 2020-09-10 08:43:31,510] ######## Iter (TEST) 1072 ########
[INFO: 2020-09-10 08:43:31,510] {'CIDEr': 1.2540823237908862}
[INFO: 2020-09-10 08:43:31,512] val_current @iteration 1072: 1.250393913873822, val_predictor: 0
[INFO: 2020-09-10 08:43:31,512] mv_approxkl: 0.00026316489555441874
[INFO: 2020-09-10 08:43:31,512] mv_entropy: 0.5880486297570459
[INFO: 2020-09-10 08:52:44,587] Training with config:
[INFO: 2020-09-10 08:52:44,589] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 08:53:13,698] Training with config:
[INFO: 2020-09-10 08:53:13,700] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 08:55:29,845] ######## Iter (TEST) 0 ########
[INFO: 2020-09-10 08:55:29,845] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-10 08:55:29,847] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 09:02:03,347] ######## Iter (TEST) 100 ########
[INFO: 2020-09-10 09:02:03,347] {'CIDEr': 1.3274005832300757}
[INFO: 2020-09-10 09:02:03,349] val_current @iteration 100: 1.315796685263704, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 09:02:03,349] mv_approxkl: 0.0009519798627369194
[INFO: 2020-09-10 09:02:03,349] mv_entropy: 0.09747165393006516
[INFO: 2020-09-10 09:08:33,741] ######## Iter (TEST) 200 ########
[INFO: 2020-09-10 09:08:33,741] {'CIDEr': 1.3260025032755933}
[INFO: 2020-09-10 09:08:33,743] val_current @iteration 200: 1.3131632293727504, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:08:33,743] mv_approxkl: 0.0008008200067372779
[INFO: 2020-09-10 09:08:33,743] mv_entropy: 0.09349858942582481
[INFO: 2020-09-10 09:15:06,485] ######## Iter (TEST) 300 ########
[INFO: 2020-09-10 09:15:06,486] {'CIDEr': 1.3279562866266488}
[INFO: 2020-09-10 09:15:06,487] val_current @iteration 300: 1.3137058413168827, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:15:06,487] mv_approxkl: 0.0007393814863467165
[INFO: 2020-09-10 09:15:06,487] mv_entropy: 0.09295021279790958
[INFO: 2020-09-10 09:21:36,422] ######## Iter (TEST) 400 ########
[INFO: 2020-09-10 09:21:36,422] {'CIDEr': 1.3284214128118115}
[INFO: 2020-09-10 09:21:36,424] val_current @iteration 400: 1.3150160098816535, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:21:36,424] mv_approxkl: 0.0008626158070161473
[INFO: 2020-09-10 09:21:36,424] mv_entropy: 0.09203794989139984
[INFO: 2020-09-10 09:28:07,273] ######## Iter (TEST) 500 ########
[INFO: 2020-09-10 09:28:07,274] {'CIDEr': 1.3279023181512701}
[INFO: 2020-09-10 09:28:07,276] val_current @iteration 500: 1.3110368917111475, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:28:07,276] mv_approxkl: 0.0008576192891830877
[INFO: 2020-09-10 09:28:07,276] mv_entropy: 0.09196062342460813
[INFO: 2020-09-10 09:34:35,488] ######## Iter (TEST) 600 ########
[INFO: 2020-09-10 09:34:35,489] {'CIDEr': 1.3275003474491889}
[INFO: 2020-09-10 09:34:35,490] val_current @iteration 600: 1.3124836309830301, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:34:35,491] mv_approxkl: 0.0008899079084235236
[INFO: 2020-09-10 09:34:35,491] mv_entropy: 0.09294322238648133
[INFO: 2020-09-10 09:41:05,146] ######## Iter (TEST) 700 ########
[INFO: 2020-09-10 09:41:05,146] {'CIDEr': 1.326097759374133}
[INFO: 2020-09-10 09:41:05,149] val_current @iteration 700: 1.3139654655300013, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:41:05,149] mv_approxkl: 0.0008303785876107064
[INFO: 2020-09-10 09:41:05,149] mv_entropy: 0.0930603250023989
[INFO: 2020-09-10 09:47:36,896] ######## Iter (TEST) 800 ########
[INFO: 2020-09-10 09:47:36,897] {'CIDEr': 1.327823915017426}
[INFO: 2020-09-10 09:47:36,899] val_current @iteration 800: 1.3112194946260143, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:47:36,899] mv_approxkl: 0.0007132517030339369
[INFO: 2020-09-10 09:47:36,899] mv_entropy: 0.09675062880731283
[INFO: 2020-09-10 09:54:06,663] ######## Iter (TEST) 900 ########
[INFO: 2020-09-10 09:54:06,663] {'CIDEr': 1.329093963255126}
[INFO: 2020-09-10 09:54:06,665] val_current @iteration 900: 1.3148316258849522, val_predictor: 1.315796685263704
[INFO: 2020-09-10 09:54:06,665] mv_approxkl: 0.000849801119929941
[INFO: 2020-09-10 09:54:06,665] mv_entropy: 0.09557882930358651
[INFO: 2020-09-10 10:00:39,844] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-10 10:00:39,844] {'CIDEr': 1.3278978329922084}
[INFO: 2020-09-10 10:00:39,846] val_current @iteration 1000: 1.3125662519140198, val_predictor: 1.315796685263704
[INFO: 2020-09-10 10:00:39,846] mv_approxkl: 0.0007924627080598939
[INFO: 2020-09-10 10:00:39,846] mv_entropy: 0.09060769811023424
[INFO: 2020-09-10 10:07:21,481] ######## Iter (TEST) 1100 ########
[INFO: 2020-09-10 10:07:21,481] {'CIDEr': 1.328328265217963}
[INFO: 2020-09-10 10:07:21,483] val_current @iteration 1100: 1.3139223066896721, val_predictor: 1.315796685263704
[INFO: 2020-09-10 10:07:21,483] mv_approxkl: 0.0008236486713095819
[INFO: 2020-09-10 10:07:21,483] mv_entropy: 0.09154604318145079
[INFO: 2020-09-10 10:13:53,415] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-10 10:13:53,415] {'CIDEr': 1.33117504978373}
[INFO: 2020-09-10 10:13:53,417] val_current @iteration 1200: 1.3155537628551865, val_predictor: 1.315796685263704
[INFO: 2020-09-10 10:13:53,417] mv_approxkl: 0.0014199440229228104
[INFO: 2020-09-10 10:13:53,417] mv_entropy: 0.09754536046029152
[INFO: 2020-09-10 10:20:24,052] ######## Iter (TEST) 1300 ########
[INFO: 2020-09-10 10:20:24,052] {'CIDEr': 1.3315572937346596}
[INFO: 2020-09-10 10:20:24,054] val_current @iteration 1300: 1.3161084304188235, val_predictor: 1.315796685263704
[INFO: 2020-09-10 10:20:24,054] mv_approxkl: 0.0010573204448040135
[INFO: 2020-09-10 10:20:24,054] mv_entropy: 0.08810896748706389
[INFO: 2020-09-10 10:27:01,284] ######## Iter (TEST) 1400 ########
[INFO: 2020-09-10 10:27:01,285] {'CIDEr': 1.3333154364913604}
[INFO: 2020-09-10 10:27:01,286] val_current @iteration 1400: 1.3159521825268792, val_predictor: 1.3161084304188235
[INFO: 2020-09-10 10:27:01,286] mv_approxkl: 0.000739591013105039
[INFO: 2020-09-10 10:27:01,287] mv_entropy: 0.09941088528067808
[INFO: 2020-09-10 10:33:34,407] ######## Iter (TEST) 1500 ########
[INFO: 2020-09-10 10:33:34,407] {'CIDEr': 1.3334589404184678}
[INFO: 2020-09-10 10:33:34,409] val_current @iteration 1500: 1.3164746732097536, val_predictor: 1.3161084304188235
[INFO: 2020-09-10 10:33:34,409] mv_approxkl: 0.0007365167934869598
[INFO: 2020-09-10 10:33:34,409] mv_entropy: 0.09688484336182293
[INFO: 2020-09-10 10:40:09,867] ######## Iter (TEST) 1600 ########
[INFO: 2020-09-10 10:40:09,867] {'CIDEr': 1.332627940685292}
[INFO: 2020-09-10 10:40:09,869] val_current @iteration 1600: 1.3161864996983041, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 10:40:09,869] mv_approxkl: 0.0008249512947654861
[INFO: 2020-09-10 10:40:09,869] mv_entropy: 0.09277511878056222
[INFO: 2020-09-10 10:46:43,297] ######## Iter (TEST) 1700 ########
[INFO: 2020-09-10 10:46:43,298] {'CIDEr': 1.3334936866130676}
[INFO: 2020-09-10 10:46:43,300] val_current @iteration 1700: 1.315290443594949, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 10:46:43,300] mv_approxkl: 0.0007401711841693494
[INFO: 2020-09-10 10:46:43,300] mv_entropy: 0.09269059177566306
[INFO: 2020-09-10 10:53:14,868] ######## Iter (TEST) 1800 ########
[INFO: 2020-09-10 10:53:14,868] {'CIDEr': 1.3336844769004184}
[INFO: 2020-09-10 10:53:14,870] val_current @iteration 1800: 1.3135480962965178, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 10:53:14,870] mv_approxkl: 0.0008565013388869539
[INFO: 2020-09-10 10:53:14,870] mv_entropy: 0.08870682877024424
[INFO: 2020-09-10 10:59:48,554] ######## Iter (TEST) 1900 ########
[INFO: 2020-09-10 10:59:48,554] {'CIDEr': 1.332836994530826}
[INFO: 2020-09-10 10:59:48,556] val_current @iteration 1900: 1.312985848445374, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 10:59:48,556] mv_approxkl: 0.0007976926859011172
[INFO: 2020-09-10 10:59:48,556] mv_entropy: 0.09756315104947473
[INFO: 2020-09-10 11:06:23,571] ######## Iter (TEST) 2000 ########
[INFO: 2020-09-10 11:06:23,571] {'CIDEr': 1.3315229900062975}
[INFO: 2020-09-10 11:06:23,573] val_current @iteration 2000: 1.3125718533040733, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 11:06:23,573] mv_approxkl: 0.0008342596922265782
[INFO: 2020-09-10 11:06:23,573] mv_entropy: 0.09005659868341241
[INFO: 2020-09-10 11:12:58,911] ######## Iter (TEST) 2100 ########
[INFO: 2020-09-10 11:12:58,911] {'CIDEr': 1.3330215668747765}
[INFO: 2020-09-10 11:12:58,913] val_current @iteration 2100: 1.3141467919605592, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 11:12:58,913] mv_approxkl: 0.0008613213661843567
[INFO: 2020-09-10 11:12:58,913] mv_entropy: 0.09668194486944262
[INFO: 2020-09-10 11:19:31,886] ######## Iter (TEST) 2200 ########
[INFO: 2020-09-10 11:19:31,887] {'CIDEr': 1.331214913189421}
[INFO: 2020-09-10 11:19:31,889] val_current @iteration 2200: 1.314506500404558, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 11:19:31,889] mv_approxkl: 0.000749172727160909
[INFO: 2020-09-10 11:19:31,889] mv_entropy: 0.09637502571112358
[INFO: 2020-09-10 11:26:05,105] ######## Iter (TEST) 2300 ########
[INFO: 2020-09-10 11:26:05,106] {'CIDEr': 1.3311526991465177}
[INFO: 2020-09-10 11:26:05,107] val_current @iteration 2300: 1.3157209838916513, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 11:26:05,108] mv_approxkl: 0.0007955910508119443
[INFO: 2020-09-10 11:26:05,108] mv_entropy: 0.0910852763151315
[INFO: 2020-09-10 11:32:37,515] ######## Iter (TEST) 2400 ########
[INFO: 2020-09-10 11:32:37,515] {'CIDEr': 1.3308384287162576}
[INFO: 2020-09-10 11:32:37,517] val_current @iteration 2400: 1.3146896358541762, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 11:32:37,517] mv_approxkl: 0.0007640544477788496
[INFO: 2020-09-10 11:32:37,517] mv_entropy: 0.09343262251213104
[INFO: 2020-09-10 11:39:11,967] ######## Iter (TEST) 2500 ########
[INFO: 2020-09-10 11:39:11,967] {'CIDEr': 1.3305902990712835}
[INFO: 2020-09-10 11:39:11,969] val_current @iteration 2500: 1.3172239005989563, val_predictor: 1.3164746732097536
[INFO: 2020-09-10 11:39:11,969] mv_approxkl: 0.0008353250455428959
[INFO: 2020-09-10 11:39:11,969] mv_entropy: 0.09173473153632
[INFO: 2020-09-10 11:45:51,169] ######## Iter (TEST) 2600 ########
[INFO: 2020-09-10 11:45:51,170] {'CIDEr': 1.327816097626528}
[INFO: 2020-09-10 11:45:51,173] val_current @iteration 2600: 1.3159967087808848, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 11:45:51,173] mv_approxkl: 0.0008485535107665103
[INFO: 2020-09-10 11:45:51,173] mv_entropy: 0.09544054300296839
[INFO: 2020-09-10 11:50:23,045] ######## Epoch 1001 ########
[INFO: 2020-09-10 11:50:23,045] {'CIDEr': 1.3305902990712835}
[INFO: 2020-09-10 11:52:41,231] ######## Iter (TEST) 2700 ########
[INFO: 2020-09-10 11:52:41,231] {'CIDEr': 1.3284742015438067}
[INFO: 2020-09-10 11:52:41,233] val_current @iteration 2700: 1.3169476673780425, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 11:52:41,233] mv_approxkl: 0.0007617026889049957
[INFO: 2020-09-10 11:52:41,233] mv_entropy: 0.08880653407685293
[INFO: 2020-09-10 11:59:12,894] ######## Iter (TEST) 2800 ########
[INFO: 2020-09-10 11:59:12,894] {'CIDEr': 1.3314069844811072}
[INFO: 2020-09-10 11:59:12,896] val_current @iteration 2800: 1.3134815230934553, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 11:59:12,896] mv_approxkl: 0.0008194091066839198
[INFO: 2020-09-10 11:59:12,896] mv_entropy: 0.09435101476764328
[INFO: 2020-09-10 12:05:45,194] ######## Iter (TEST) 2900 ########
[INFO: 2020-09-10 12:05:45,195] {'CIDEr': 1.3301297904000333}
[INFO: 2020-09-10 12:05:45,196] val_current @iteration 2900: 1.315528710629837, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 12:05:45,196] mv_approxkl: 0.0010986793964479053
[INFO: 2020-09-10 12:05:45,196] mv_entropy: 0.08545818447191728
[INFO: 2020-09-10 12:12:17,088] ######## Iter (TEST) 3000 ########
[INFO: 2020-09-10 12:12:17,088] {'CIDEr': 1.3318859489491675}
[INFO: 2020-09-10 12:12:17,090] val_current @iteration 3000: 1.3134711810516546, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 12:12:17,090] mv_approxkl: 0.0008110090671494745
[INFO: 2020-09-10 12:12:17,090] mv_entropy: 0.09862000785626827
[INFO: 2020-09-10 12:18:51,484] ######## Iter (TEST) 3100 ########
[INFO: 2020-09-10 12:18:51,484] {'CIDEr': 1.3313926452430123}
[INFO: 2020-09-10 12:18:51,486] val_current @iteration 3100: 1.3137887698573376, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 12:18:51,486] mv_approxkl: 0.0007568493574644406
[INFO: 2020-09-10 12:18:51,486] mv_entropy: 0.09077354039999574
[INFO: 2020-09-10 12:25:24,928] ######## Iter (TEST) 3200 ########
[INFO: 2020-09-10 12:25:24,928] {'CIDEr': 1.3331341832031807}
[INFO: 2020-09-10 12:25:24,930] val_current @iteration 3200: 1.3161890499884985, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 12:25:24,930] mv_approxkl: 0.00069240186777975
[INFO: 2020-09-10 12:25:24,930] mv_entropy: 0.0906949475960247
[INFO: 2020-09-10 12:31:59,020] ######## Iter (TEST) 3300 ########
[INFO: 2020-09-10 12:31:59,020] {'CIDEr': 1.3320330881454756}
[INFO: 2020-09-10 12:31:59,022] val_current @iteration 3300: 1.3160279663430068, val_predictor: 1.3172239005989563
[INFO: 2020-09-10 12:31:59,022] mv_approxkl: 0.0007859087486856996
[INFO: 2020-09-10 12:31:59,022] mv_entropy: 0.09768034865780012
[INFO: 2020-09-10 12:35:22,284] Training with config:
[INFO: 2020-09-10 12:35:22,286] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 5e-06,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 12:37:39,923] ######## Iter (TEST) 0 ########
[INFO: 2020-09-10 12:37:39,923] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-10 12:37:39,925] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 12:44:13,222] ######## Iter (TEST) 100 ########
[INFO: 2020-09-10 12:44:13,222] {'CIDEr': 1.3265954640237794}
[INFO: 2020-09-10 12:44:13,224] val_current @iteration 100: 1.3144643063482122, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 12:44:13,224] mv_approxkl: 0.0008661253909552621
[INFO: 2020-09-10 12:44:13,224] mv_entropy: 0.0931088480771901
[INFO: 2020-09-10 12:50:50,985] ######## Iter (TEST) 200 ########
[INFO: 2020-09-10 12:50:50,985] {'CIDEr': 1.3255609005266564}
[INFO: 2020-09-10 12:50:50,987] val_current @iteration 200: 1.3137093242256013, val_predictor: 1.3144643063482122
[INFO: 2020-09-10 12:50:50,987] mv_approxkl: 0.0009619706217545291
[INFO: 2020-09-10 12:50:50,987] mv_entropy: 0.09521488883951004
[INFO: 2020-09-10 12:57:22,979] ######## Iter (TEST) 300 ########
[INFO: 2020-09-10 12:57:22,979] {'CIDEr': 1.322914224454936}
[INFO: 2020-09-10 12:57:22,981] val_current @iteration 300: 1.3132093423987796, val_predictor: 1.3144643063482122
[INFO: 2020-09-10 12:57:22,981] mv_approxkl: 0.0006797966674197185
[INFO: 2020-09-10 12:57:22,981] mv_entropy: 0.09525696065313538
[INFO: 2020-09-10 13:03:56,049] ######## Iter (TEST) 400 ########
[INFO: 2020-09-10 13:03:56,049] {'CIDEr': 1.3247890861949994}
[INFO: 2020-09-10 13:03:56,051] val_current @iteration 400: 1.3120589100733875, val_predictor: 1.3144643063482122
[INFO: 2020-09-10 13:03:56,051] mv_approxkl: 0.0007447111330748376
[INFO: 2020-09-10 13:03:56,051] mv_entropy: 0.09149432209805934
[INFO: 2020-09-10 13:10:27,001] ######## Iter (TEST) 500 ########
[INFO: 2020-09-10 13:10:27,002] {'CIDEr': 1.3257996855171266}
[INFO: 2020-09-10 13:10:27,003] val_current @iteration 500: 1.3147869319786132, val_predictor: 1.3144643063482122
[INFO: 2020-09-10 13:10:27,004] mv_approxkl: 0.001055161420609922
[INFO: 2020-09-10 13:10:27,004] mv_entropy: 0.09411982610485849
[INFO: 2020-09-10 13:17:04,867] ######## Iter (TEST) 600 ########
[INFO: 2020-09-10 13:17:04,868] {'CIDEr': 1.3269484300447938}
[INFO: 2020-09-10 13:17:04,870] val_current @iteration 600: 1.3128909843170633, val_predictor: 1.3147869319786132
[INFO: 2020-09-10 13:17:04,870] mv_approxkl: 0.0009615950963749085
[INFO: 2020-09-10 13:17:04,870] mv_entropy: 0.09823068173217978
[INFO: 2020-09-10 13:23:37,469] ######## Iter (TEST) 700 ########
[INFO: 2020-09-10 13:23:37,469] {'CIDEr': 1.329328868193378}
[INFO: 2020-09-10 13:23:37,471] val_current @iteration 700: 1.3142457896893935, val_predictor: 1.3147869319786132
[INFO: 2020-09-10 13:23:37,471] mv_approxkl: 0.0007901272277448464
[INFO: 2020-09-10 13:23:37,471] mv_entropy: 0.08750143053399193
[INFO: 2020-09-10 13:30:10,496] ######## Iter (TEST) 800 ########
[INFO: 2020-09-10 13:30:10,496] {'CIDEr': 1.328058244161792}
[INFO: 2020-09-10 13:30:10,498] val_current @iteration 800: 1.314217146350731, val_predictor: 1.3147869319786132
[INFO: 2020-09-10 13:30:10,498] mv_approxkl: 0.00072390333556567
[INFO: 2020-09-10 13:30:10,498] mv_entropy: 0.08940643166080267
[INFO: 2020-09-10 13:36:43,457] ######## Iter (TEST) 900 ########
[INFO: 2020-09-10 13:36:43,457] {'CIDEr': 1.3282683661197312}
[INFO: 2020-09-10 13:36:43,459] val_current @iteration 900: 1.3127825358698233, val_predictor: 1.3147869319786132
[INFO: 2020-09-10 13:36:43,459] mv_approxkl: 0.0008415740099501424
[INFO: 2020-09-10 13:36:43,459] mv_entropy: 0.09209171278931375
[INFO: 2020-09-10 13:43:14,808] ######## Iter (TEST) 1000 ########
[INFO: 2020-09-10 13:43:14,808] {'CIDEr': 1.3283429537431126}
[INFO: 2020-09-10 13:43:14,810] val_current @iteration 1000: 1.3157942526166588, val_predictor: 1.3147869319786132
[INFO: 2020-09-10 13:43:14,810] mv_approxkl: 0.0009212267860612424
[INFO: 2020-09-10 13:43:14,810] mv_entropy: 0.09183896276866386
[INFO: 2020-09-10 13:49:57,843] ######## Iter (TEST) 1100 ########
[INFO: 2020-09-10 13:49:57,843] {'CIDEr': 1.3292181459218348}
[INFO: 2020-09-10 13:49:57,845] val_current @iteration 1100: 1.3123367186609987, val_predictor: 1.3157942526166588
[INFO: 2020-09-10 13:49:57,845] mv_approxkl: 0.0009359187517005004
[INFO: 2020-09-10 13:49:57,845] mv_entropy: 0.09091169578970079
[INFO: 2020-09-10 13:56:27,218] ######## Iter (TEST) 1200 ########
[INFO: 2020-09-10 13:56:27,218] {'CIDEr': 1.3263209017453645}
[INFO: 2020-09-10 13:56:27,220] val_current @iteration 1200: 1.3122396199237296, val_predictor: 1.3157942526166588
[INFO: 2020-09-10 13:56:27,220] mv_approxkl: 0.0006886371837174824
[INFO: 2020-09-10 13:56:27,220] mv_entropy: 0.09229293756116407
[INFO: 2020-09-10 13:59:43,319] Training with config:
[INFO: 2020-09-10 13:59:43,321] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 5e-06,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 14:01:59,020] ######## Iter (TEST) 0 ########
[INFO: 2020-09-10 14:01:59,021] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-10 14:01:59,022] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:08:28,125] ######## Iter (TEST) 100 ########
[INFO: 2020-09-10 14:08:28,125] {'CIDEr': 1.3277885077376053}
[INFO: 2020-09-10 14:08:28,127] val_current @iteration 100: 1.3128770722887635, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:08:28,127] mv_approxkl: 5.0450562893453914e-05
[INFO: 2020-09-10 14:08:28,127] mv_entropy: 0.0925040244675042
[INFO: 2020-09-10 14:14:56,056] ######## Iter (TEST) 200 ########
[INFO: 2020-09-10 14:14:56,056] {'CIDEr': 1.3282599028191107}
[INFO: 2020-09-10 14:14:56,058] val_current @iteration 200: 1.312375284203059, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:14:56,058] mv_approxkl: 0.00016136573781780543
[INFO: 2020-09-10 14:14:56,058] mv_entropy: 0.09415137674021645
[INFO: 2020-09-10 14:21:27,632] ######## Iter (TEST) 300 ########
[INFO: 2020-09-10 14:21:27,633] {'CIDEr': 1.3286916857267161}
[INFO: 2020-09-10 14:21:27,635] val_current @iteration 300: 1.3135499147189356, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:21:27,635] mv_approxkl: 0.0001740869833649471
[INFO: 2020-09-10 14:21:27,635] mv_entropy: 0.09342742215730909
[INFO: 2020-09-10 14:28:01,592] ######## Iter (TEST) 400 ########
[INFO: 2020-09-10 14:28:01,592] {'CIDEr': 1.3295136552255258}
[INFO: 2020-09-10 14:28:01,594] val_current @iteration 400: 1.3124550417668037, val_predictor: 1.3135499147189356
[INFO: 2020-09-10 14:28:01,594] mv_approxkl: 0.0003230250822214589
[INFO: 2020-09-10 14:28:01,594] mv_entropy: 0.09245554737107105
[INFO: 2020-09-10 14:34:32,671] ######## Iter (TEST) 500 ########
[INFO: 2020-09-10 14:34:32,672] {'CIDEr': 1.3287973787626128}
[INFO: 2020-09-10 14:34:32,673] val_current @iteration 500: 1.3117310203311965, val_predictor: 1.3135499147189356
[INFO: 2020-09-10 14:34:32,673] mv_approxkl: 0.00025984030428466496
[INFO: 2020-09-10 14:34:32,674] mv_entropy: 0.09466906360598107
[INFO: 2020-09-10 14:37:09,721] Training with config:
[INFO: 2020-09-10 14:37:09,723] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 5e-06,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 14:39:28,237] ######## Iter (TEST) 0 ########
[INFO: 2020-09-10 14:39:28,237] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-10 14:39:28,239] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:40:58,585] Training with config:
[INFO: 2020-09-10 14:40:58,587] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 5e-06,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 14:43:16,147] ######## Iter (TEST) 0 ########
[INFO: 2020-09-10 14:43:16,148] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-10 14:43:16,150] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:49:49,734] ######## Iter (TEST) 100 ########
[INFO: 2020-09-10 14:49:49,735] {'CIDEr': 1.3271081091118415}
[INFO: 2020-09-10 14:49:49,737] val_current @iteration 100: 1.3120954981126245, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:49:49,737] mv_approxkl: 0.000157694264353369
[INFO: 2020-09-10 14:49:49,737] mv_entropy: 0.0991980418636145
[INFO: 2020-09-10 14:56:20,540] ######## Iter (TEST) 200 ########
[INFO: 2020-09-10 14:56:20,540] {'CIDEr': 1.3259301958516558}
[INFO: 2020-09-10 14:56:20,542] val_current @iteration 200: 1.3134991578157067, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 14:56:20,542] mv_approxkl: 0.00012065661808794985
[INFO: 2020-09-10 14:56:20,542] mv_entropy: 0.08807067146233703
[INFO: 2020-09-10 15:02:56,544] ######## Iter (TEST) 300 ########
[INFO: 2020-09-10 15:02:56,544] {'CIDEr': 1.323402486619704}
[INFO: 2020-09-10 15:02:56,546] val_current @iteration 300: 1.3141697356997637, val_predictor: 1.3134991578157067
[INFO: 2020-09-10 15:02:56,546] mv_approxkl: 0.00011959879410476234
[INFO: 2020-09-10 15:02:56,546] mv_entropy: 0.08807675916458153
[INFO: 2020-09-10 15:09:34,969] ######## Iter (TEST) 400 ########
[INFO: 2020-09-10 15:09:34,969] {'CIDEr': 1.3288003862281672}
[INFO: 2020-09-10 15:09:34,971] val_current @iteration 400: 1.3131961834616375, val_predictor: 1.3141697356997637
[INFO: 2020-09-10 15:09:34,971] mv_approxkl: 0.00012007800549295867
[INFO: 2020-09-10 15:09:34,971] mv_entropy: 0.09413459202076896
[INFO: 2020-09-10 15:16:05,680] ######## Iter (TEST) 500 ########
[INFO: 2020-09-10 15:16:05,681] {'CIDEr': 1.3291568549614659}
[INFO: 2020-09-10 15:16:05,683] val_current @iteration 500: 1.3119948696565058, val_predictor: 1.3141697356997637
[INFO: 2020-09-10 15:16:05,683] mv_approxkl: 0.00013606144257505179
[INFO: 2020-09-10 15:16:05,683] mv_entropy: 0.08619550574660434
[INFO: 2020-09-10 15:22:35,857] ######## Iter (TEST) 600 ########
[INFO: 2020-09-10 15:22:35,857] {'CIDEr': 1.3280296014023518}
[INFO: 2020-09-10 15:22:35,859] val_current @iteration 600: 1.3094704734063063, val_predictor: 1.3141697356997637
[INFO: 2020-09-10 15:22:35,859] mv_approxkl: 0.00020929989616763712
[INFO: 2020-09-10 15:22:35,859] mv_entropy: 0.08875098802615047
[INFO: 2020-09-10 15:29:08,117] ######## Iter (TEST) 700 ########
[INFO: 2020-09-10 15:29:08,118] {'CIDEr': 1.3272289393792482}
[INFO: 2020-09-10 15:29:08,121] val_current @iteration 700: 1.31083744217969, val_predictor: 1.3141697356997637
[INFO: 2020-09-10 15:29:08,121] mv_approxkl: 0.00028929146297943263
[INFO: 2020-09-10 15:29:08,121] mv_entropy: 0.09263967091299159
[INFO: 2020-09-10 15:35:39,157] ######## Iter (TEST) 800 ########
[INFO: 2020-09-10 15:35:39,158] {'CIDEr': 1.3285985102764812}
[INFO: 2020-09-10 15:35:39,160] val_current @iteration 800: 1.31075866755872, val_predictor: 1.3141697356997637
[INFO: 2020-09-10 15:35:39,160] mv_approxkl: 0.0002852083717685976
[INFO: 2020-09-10 15:35:39,160] mv_entropy: 0.09568923960038592
[INFO: 2020-09-10 15:39:27,159] Training with config:
[INFO: 2020-09-10 15:39:27,161] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 5e-06,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 15:41:44,603] ######## Iter (TEST) 0 ########
[INFO: 2020-09-10 15:41:44,603] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-10 15:41:44,606] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 15:55:12,367] ######## Iter (TEST) 256 ########
[INFO: 2020-09-10 15:55:12,367] {'CIDEr': 1.329049162899643}
[INFO: 2020-09-10 15:55:12,369] val_current @iteration 256: 1.3143639852700337, val_predictor: 1.3134830622722575
[INFO: 2020-09-10 15:55:12,369] mv_approxkl: 0.0015581931671699726
[INFO: 2020-09-10 15:55:12,369] mv_entropy: 0.09830199462555965
[INFO: 2020-09-10 16:08:43,104] ######## Iter (TEST) 512 ########
[INFO: 2020-09-10 16:08:43,105] {'CIDEr': 1.3292319217360749}
[INFO: 2020-09-10 16:08:43,106] val_current @iteration 512: 1.310971548689302, val_predictor: 1.3143639852700337
[INFO: 2020-09-10 16:08:43,107] mv_approxkl: 0.0013769094077857203
[INFO: 2020-09-10 16:08:43,107] mv_entropy: 0.09243635268369349
[INFO: 2020-09-10 16:22:12,970] ######## Iter (TEST) 768 ########
[INFO: 2020-09-10 16:22:12,970] {'CIDEr': 1.3311168406879088}
[INFO: 2020-09-10 16:22:12,972] val_current @iteration 768: 1.3124327524801933, val_predictor: 1.3143639852700337
[INFO: 2020-09-10 16:22:12,972] mv_approxkl: 0.001810337371730246
[INFO: 2020-09-10 16:22:12,972] mv_entropy: 0.09999398647897391
[INFO: 2020-09-10 16:35:47,995] ######## Iter (TEST) 1024 ########
[INFO: 2020-09-10 16:35:47,995] {'CIDEr': 1.3311372891182365}
[INFO: 2020-09-10 16:35:47,997] val_current @iteration 1024: 1.3127441237975375, val_predictor: 1.3143639852700337
[INFO: 2020-09-10 16:35:47,997] mv_approxkl: 0.0016566915788155025
[INFO: 2020-09-10 16:35:47,997] mv_entropy: 0.09771871327796361
[INFO: 2020-09-10 16:49:17,072] ######## Iter (TEST) 1280 ########
[INFO: 2020-09-10 16:49:17,072] {'CIDEr': 1.3288454719650276}
[INFO: 2020-09-10 16:49:17,074] val_current @iteration 1280: 1.3150705551091606, val_predictor: 1.3143639852700337
[INFO: 2020-09-10 16:49:17,074] mv_approxkl: 0.002021201153088708
[INFO: 2020-09-10 16:49:17,074] mv_entropy: 0.10139561528276561
[INFO: 2020-09-10 17:02:50,157] ######## Iter (TEST) 1536 ########
[INFO: 2020-09-10 17:02:50,158] {'CIDEr': 1.3301609873896163}
[INFO: 2020-09-10 17:02:50,160] val_current @iteration 1536: 1.3147614003972303, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 17:02:50,160] mv_approxkl: 0.001431232870718493
[INFO: 2020-09-10 17:02:50,160] mv_entropy: 0.09752866643666296
[INFO: 2020-09-10 17:16:21,138] ######## Iter (TEST) 1792 ########
[INFO: 2020-09-10 17:16:21,138] {'CIDEr': 1.3284992198813013}
[INFO: 2020-09-10 17:16:21,140] val_current @iteration 1792: 1.3131359550288042, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 17:16:21,140] mv_approxkl: 0.0011931669389902437
[INFO: 2020-09-10 17:16:21,140] mv_entropy: 0.08619349782666491
[INFO: 2020-09-10 17:29:52,814] ######## Iter (TEST) 2048 ########
[INFO: 2020-09-10 17:29:52,814] {'CIDEr': 1.3271708780801232}
[INFO: 2020-09-10 17:29:52,816] val_current @iteration 2048: 1.3146877262874415, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 17:29:52,817] mv_approxkl: 0.0013586245209686496
[INFO: 2020-09-10 17:29:52,817] mv_entropy: 0.08841419355090352
[INFO: 2020-09-10 17:43:19,778] ######## Iter (TEST) 2304 ########
[INFO: 2020-09-10 17:43:19,778] {'CIDEr': 1.3280983851979247}
[INFO: 2020-09-10 17:43:19,780] val_current @iteration 2304: 1.3137800603442837, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 17:43:19,780] mv_approxkl: 0.0012097333263182998
[INFO: 2020-09-10 17:43:19,780] mv_entropy: 0.09694760277700445
[INFO: 2020-09-10 17:56:43,751] ######## Iter (TEST) 2560 ########
[INFO: 2020-09-10 17:56:43,751] {'CIDEr': 1.3273170442615112}
[INFO: 2020-09-10 17:56:43,753] val_current @iteration 2560: 1.3116104996670783, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 17:56:43,753] mv_approxkl: 0.0014172774561829796
[INFO: 2020-09-10 17:56:43,753] mv_entropy: 0.0966828150833618
[INFO: 2020-09-10 18:10:10,136] ######## Iter (TEST) 2816 ########
[INFO: 2020-09-10 18:10:10,137] {'CIDEr': 1.3293485584691334}
[INFO: 2020-09-10 18:10:10,139] val_current @iteration 2816: 1.3117295481269569, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 18:10:10,139] mv_approxkl: 0.0012784566606450012
[INFO: 2020-09-10 18:10:10,139] mv_entropy: 0.09047210946078992
[INFO: 2020-09-10 18:23:43,805] ######## Iter (TEST) 3072 ########
[INFO: 2020-09-10 18:23:43,806] {'CIDEr': 1.3270788086162522}
[INFO: 2020-09-10 18:23:43,808] val_current @iteration 3072: 1.3131836307754463, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 18:23:43,808] mv_approxkl: 0.0020056364495347765
[INFO: 2020-09-10 18:23:43,808] mv_entropy: 0.09774653060042506
[INFO: 2020-09-10 18:37:11,489] ######## Iter (TEST) 3328 ########
[INFO: 2020-09-10 18:37:11,489] {'CIDEr': 1.3278327934190943}
[INFO: 2020-09-10 18:37:11,491] val_current @iteration 3328: 1.3132614723965212, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 18:37:11,491] mv_approxkl: 0.00131832395060766
[INFO: 2020-09-10 18:37:11,491] mv_entropy: 0.09375844422188825
[INFO: 2020-09-10 18:50:38,368] ######## Iter (TEST) 3584 ########
[INFO: 2020-09-10 18:50:38,369] {'CIDEr': 1.3298593806119947}
[INFO: 2020-09-10 18:50:38,371] val_current @iteration 3584: 1.3159113892942924, val_predictor: 1.3150705551091606
[INFO: 2020-09-10 18:50:38,371] mv_approxkl: 0.0020669568662500695
[INFO: 2020-09-10 18:50:38,371] mv_entropy: 0.0875367662851717
[INFO: 2020-09-10 19:04:09,835] ######## Iter (TEST) 3840 ########
[INFO: 2020-09-10 19:04:09,835] {'CIDEr': 1.329357483231123}
[INFO: 2020-09-10 19:04:09,837] val_current @iteration 3840: 1.3161627957894078, val_predictor: 1.3159113892942924
[INFO: 2020-09-10 19:04:09,837] mv_approxkl: 0.0013956554882390202
[INFO: 2020-09-10 19:04:09,837] mv_entropy: 0.09892462960435106
[INFO: 2020-09-10 19:17:41,923] ######## Iter (TEST) 4096 ########
[INFO: 2020-09-10 19:17:41,923] {'CIDEr': 1.329285542792776}
[INFO: 2020-09-10 19:17:41,925] val_current @iteration 4096: 1.3164320489955204, val_predictor: 1.3161627957894078
[INFO: 2020-09-10 19:17:41,925] mv_approxkl: 0.0013826084078847522
[INFO: 2020-09-10 19:17:41,925] mv_entropy: 0.09698908712912958
[INFO: 2020-09-10 19:31:13,848] ######## Iter (TEST) 4352 ########
[INFO: 2020-09-10 19:31:13,848] {'CIDEr': 1.3271862858443828}
[INFO: 2020-09-10 19:31:13,850] val_current @iteration 4352: 1.3167848538341462, val_predictor: 1.3164320489955204
[INFO: 2020-09-10 19:31:13,850] mv_approxkl: 0.0012237010251748854
[INFO: 2020-09-10 19:31:13,850] mv_entropy: 0.08760856704111757
[INFO: 2020-09-10 19:44:45,635] ######## Iter (TEST) 4608 ########
[INFO: 2020-09-10 19:44:45,636] {'CIDEr': 1.3299369394599794}
[INFO: 2020-09-10 19:44:45,637] val_current @iteration 4608: 1.3168235517651072, val_predictor: 1.3167848538341462
[INFO: 2020-09-10 19:44:45,637] mv_approxkl: 0.0013541019322903028
[INFO: 2020-09-10 19:44:45,638] mv_entropy: 0.08980335418321858
[INFO: 2020-09-10 19:58:20,314] ######## Iter (TEST) 4864 ########
[INFO: 2020-09-10 19:58:20,314] {'CIDEr': 1.3249484087072703}
[INFO: 2020-09-10 19:58:20,316] val_current @iteration 4864: 1.3181169305732114, val_predictor: 1.3168235517651072
[INFO: 2020-09-10 19:58:20,316] mv_approxkl: 0.0014308854999826818
[INFO: 2020-09-10 19:58:20,316] mv_entropy: 0.09957695944267689
[INFO: 2020-09-10 20:11:52,854] ######## Iter (TEST) 5120 ########
[INFO: 2020-09-10 20:11:52,854] {'CIDEr': 1.3277815614818975}
[INFO: 2020-09-10 20:11:52,856] val_current @iteration 5120: 1.3169086814597408, val_predictor: 1.3181169305732114
[INFO: 2020-09-10 20:11:52,856] mv_approxkl: 0.0012611264425661575
[INFO: 2020-09-10 20:11:52,856] mv_entropy: 0.090181071085209
[INFO: 2020-09-10 20:25:15,839] ######## Iter (TEST) 5376 ########
[INFO: 2020-09-10 20:25:15,839] {'CIDEr': 1.3252488636306239}
[INFO: 2020-09-10 20:25:15,841] val_current @iteration 5376: 1.3175751574410766, val_predictor: 1.3181169305732114
[INFO: 2020-09-10 20:25:15,841] mv_approxkl: 0.0014663777406287173
[INFO: 2020-09-10 20:25:15,841] mv_entropy: 0.0991872331044697
[INFO: 2020-09-10 20:38:44,427] ######## Iter (TEST) 5632 ########
[INFO: 2020-09-10 20:38:44,427] {'CIDEr': 1.3258902846407137}
[INFO: 2020-09-10 20:38:44,429] val_current @iteration 5632: 1.3159110888411643, val_predictor: 1.3181169305732114
[INFO: 2020-09-10 20:38:44,429] mv_approxkl: 0.0016243643540433872
[INFO: 2020-09-10 20:38:44,429] mv_entropy: 0.09502919789329316
[INFO: 2020-09-10 20:52:12,142] ######## Iter (TEST) 5888 ########
[INFO: 2020-09-10 20:52:12,142] {'CIDEr': 1.3252626838237074}
[INFO: 2020-09-10 20:52:12,144] val_current @iteration 5888: 1.3161329001295956, val_predictor: 1.3181169305732114
[INFO: 2020-09-10 20:52:12,144] mv_approxkl: 0.0012590297711358757
[INFO: 2020-09-10 20:52:12,144] mv_entropy: 0.09562288845916414
[INFO: 2020-09-10 21:05:36,301] ######## Iter (TEST) 6144 ########
[INFO: 2020-09-10 21:05:36,302] {'CIDEr': 1.3255597501309324}
[INFO: 2020-09-10 21:05:36,303] val_current @iteration 6144: 1.3168453386822712, val_predictor: 1.3181169305732114
[INFO: 2020-09-10 21:05:36,303] mv_approxkl: 0.001605853015225641
[INFO: 2020-09-10 21:05:36,303] mv_entropy: 0.100225809101591
[INFO: 2020-09-10 22:08:51,728] Training with config:
[INFO: 2020-09-10 22:08:51,734] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 5e-06,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 16,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 22:09:38,680] Training with config:
[INFO: 2020-09-10 22:09:38,683] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 5e-06,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 16,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-10 22:13:05,512] ######## Iter (TEST) 0 ########
[INFO: 2020-09-10 22:13:05,513] {'CIDEr': 1.3279842681794274}
[INFO: 2020-09-10 22:13:05,516] val_current @iteration 0: 1.3134830622722575, val_predictor: 1.3134830622722575
