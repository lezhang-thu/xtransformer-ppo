[INFO: 2020-09-02 09:53:12,339] Training with config:
[INFO: 2020-09-02 09:53:12,342] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 16,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-02 11:52:37,808] iteration 1000
[INFO: 2020-09-02 12:05:18,460] ######## Iteration (TEST) 1000 ########
[INFO: 2020-09-02 12:05:18,573] {'Bleu_1': 0.789496615438166, 'Bleu_2': 0.6380678820851768, 'Bleu_3': 0.49679421162521986, 'Bleu_4': 0.38229491702988455, 'METEOR': 0.28494527292726624, 'ROUGE_L': 0.584201156599574, 'CIDEr': 1.234693540515989, 'SPICE': 0.2166395629364156, 'WMD': 0.2668051743913281}
[INFO: 2020-09-02 14:12:56,821] iteration 2000
[INFO: 2020-09-02 14:22:08,106] ######## Iteration (TEST) 2000 ########
[INFO: 2020-09-02 14:22:08,251] {'Bleu_1': 0.8005876110589315, 'Bleu_2': 0.6476050804917117, 'Bleu_3': 0.5054851257916264, 'Bleu_4': 0.3888175459840138, 'METEOR': 0.2850857724077845, 'ROUGE_L': 0.5859573199456938, 'CIDEr': 1.2589684009685858, 'SPICE': 0.2209231687623883, 'WMD': 0.2676547053241112}
[INFO: 2020-09-02 16:23:07,722] iteration 3000
[INFO: 2020-09-02 16:32:24,759] ######## Iteration (TEST) 3000 ########
[INFO: 2020-09-02 16:32:24,950] {'Bleu_1': 0.8038720600859646, 'Bleu_2': 0.6515595992383317, 'Bleu_3': 0.5083453707535627, 'Bleu_4': 0.389791159294862, 'METEOR': 0.2868157064494613, 'ROUGE_L': 0.5882082149943967, 'CIDEr': 1.2794411972880768, 'SPICE': 0.22344551494702947, 'WMD': 0.2685897836915907}
[INFO: 2020-09-02 17:52:02,210] ######## Iteration (VAL) 3544 ########
[INFO: 2020-09-02 17:52:02,334] {'Bleu_1': 0.8067242090941176, 'Bleu_2': 0.6532176417282761, 'Bleu_3': 0.5072950705646774, 'Bleu_4': 0.387010891197938, 'METEOR': 0.2863211976310238, 'ROUGE_L': 0.5871243800440393, 'CIDEr': 1.2653563686960156, 'SPICE': 0.22380860390021626, 'WMD': 0.26466407143009185}
[INFO: 2020-09-02 18:51:24,990] iteration 4000
[INFO: 2020-09-02 19:01:06,082] ######## Iteration (TEST) 4000 ########
[INFO: 2020-09-02 19:01:06,205] {'Bleu_1': 0.803560316942557, 'Bleu_2': 0.6511748871795114, 'Bleu_3': 0.5085440043969925, 'Bleu_4': 0.3900432255686585, 'METEOR': 0.28676954965516577, 'ROUGE_L': 0.5877492641438553, 'CIDEr': 1.2820965879053197, 'SPICE': 0.223011092067259, 'WMD': 0.26854934227359534}
[INFO: 2020-09-02 21:00:39,417] iteration 5000
[INFO: 2020-09-02 21:10:08,805] ######## Iteration (TEST) 5000 ########
[INFO: 2020-09-02 21:10:08,909] {'Bleu_1': 0.807604679566323, 'Bleu_2': 0.6546083827744479, 'Bleu_3': 0.5103019769516556, 'Bleu_4': 0.3902968218813051, 'METEOR': 0.28701868705352795, 'ROUGE_L': 0.5879160981134471, 'CIDEr': 1.2861904532170432, 'SPICE': 0.22473652186093804, 'WMD': 0.2689507725296995}
[INFO: 2020-09-02 23:12:11,291] iteration 6000
[INFO: 2020-09-02 23:20:37,739] ######## Iteration (TEST) 6000 ########
[INFO: 2020-09-02 23:20:37,816] {'Bleu_1': 0.8082077481961872, 'Bleu_2': 0.6551044363267944, 'Bleu_3': 0.5097274440119204, 'Bleu_4': 0.39015302995830065, 'METEOR': 0.2861504536651173, 'ROUGE_L': 0.5870397055930993, 'CIDEr': 1.2842267480052465, 'SPICE': 0.22239066420123962, 'WMD': 0.26514348100762336}
[INFO: 2020-09-02 23:31:30,052] Training with config:
[INFO: 2020-09-02 23:31:30,058] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 16,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-03 01:24:16,968] iteration 1000
[INFO: 2020-09-03 01:35:41,826] ######## Iteration (TEST) 1000 ########
[INFO: 2020-09-03 01:35:41,906] {'Bleu_1': 0.8097263507007367, 'Bleu_2': 0.6570553699606094, 'Bleu_3': 0.5135927074142151, 'Bleu_4': 0.39399521352779526, 'METEOR': 0.2907791061055586, 'ROUGE_L': 0.5879141312821221, 'CIDEr': 1.3021697310895757, 'SPICE': 0.23015069878951905, 'WMD': 0.2720667225888527}
[INFO: 2020-09-03 03:40:35,279] iteration 2000
[INFO: 2020-09-03 03:49:44,123] ######## Iteration (TEST) 2000 ########
[INFO: 2020-09-03 03:49:44,224] {'Bleu_1': 0.808898462316121, 'Bleu_2': 0.6556057159378103, 'Bleu_3': 0.5118447630079985, 'Bleu_4': 0.39211504001924197, 'METEOR': 0.29060282118883213, 'ROUGE_L': 0.5870486885424949, 'CIDEr': 1.2998815192188884, 'SPICE': 0.2281568993829781, 'WMD': 0.27169234755312893}
[INFO: 2020-09-03 05:45:32,625] iteration 3000
[INFO: 2020-09-03 05:55:06,036] ######## Iteration (TEST) 3000 ########
[INFO: 2020-09-03 05:55:06,192] {'Bleu_1': 0.8088894482400062, 'Bleu_2': 0.6561396569826534, 'Bleu_3': 0.5127952784807739, 'Bleu_4': 0.39386896746532124, 'METEOR': 0.29135321179434265, 'ROUGE_L': 0.5886412372948182, 'CIDEr': 1.3041390400905348, 'SPICE': 0.22977056448830827, 'WMD': 0.2733848969652984}
[INFO: 2020-09-03 07:17:47,568] ######## Iteration (VAL) 3544 ########
[INFO: 2020-09-03 07:17:47,655] {'Bleu_1': 0.8079248837742222, 'Bleu_2': 0.6566086656658252, 'Bleu_3': 0.5107685971025206, 'Bleu_4': 0.38992581438380236, 'METEOR': 0.2909487093610174, 'ROUGE_L': 0.5888596779168762, 'CIDEr': 1.2871549331009289, 'SPICE': 0.2272238065046686, 'WMD': 0.26817319037453136}
