[INFO: 2020-08-31 22:13:56,951] Training with config:
[INFO: 2020-08-31 22:13:56,955] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 16,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-01 00:13:00,840] iteration 1000
[INFO: 2020-09-01 00:24:29,295] ######## Epoch (TEST) 1000 ########
[INFO: 2020-09-01 00:24:29,341] {'Bleu_1': 0.7885234751098045, 'Bleu_2': 0.6376691124316765, 'Bleu_3': 0.49735001520855204, 'Bleu_4': 0.382565560585749, 'METEOR': 0.28434413764563915, 'ROUGE_L': 0.583456647711852, 'CIDEr': 1.23411696621415, 'SPICE': 0.2173000466314159, 'WMD': 0.2661496299566139}
[INFO: 2020-09-01 02:30:36,471] iteration 2000
[INFO: 2020-09-01 02:43:21,765] ######## Epoch (TEST) 2000 ########
[INFO: 2020-09-01 02:43:22,404] {'Bleu_1': 0.7982206344913289, 'Bleu_2': 0.6456644884009437, 'Bleu_3': 0.5034486721724718, 'Bleu_4': 0.3879035098277654, 'METEOR': 0.2872028097154549, 'ROUGE_L': 0.5853980021895149, 'CIDEr': 1.2665491510121991, 'SPICE': 0.22204085340997745, 'WMD': 0.270147854917092}
[INFO: 2020-09-01 04:46:57,977] iteration 3000
[INFO: 2020-09-01 04:59:17,724] ######## Epoch (TEST) 3000 ########
[INFO: 2020-09-01 04:59:17,966] {'Bleu_1': 0.8038024499219489, 'Bleu_2': 0.6511352816438895, 'Bleu_3': 0.5078961017941842, 'Bleu_4': 0.390168141203894, 'METEOR': 0.28953849702814605, 'ROUGE_L': 0.5885638770516963, 'CIDEr': 1.2786889435304731, 'SPICE': 0.2244448772649207, 'WMD': 0.26976873603808954}
[INFO: 2020-09-01 06:23:16,484] ######## Epoch (VAL) 3544 ########
[INFO: 2020-09-01 06:23:16,611] {'Bleu_1': 0.8015319567212015, 'Bleu_2': 0.6497772982013059, 'Bleu_3': 0.504564548220102, 'Bleu_4': 0.38536514413387096, 'METEOR': 0.28791218611400754, 'ROUGE_L': 0.5872501323441848, 'CIDEr': 1.2654903816085008, 'SPICE': 0.22419425672075954, 'WMD': 0.2668786620428824}
[INFO: 2020-09-01 07:24:37,980] iteration 4000
[INFO: 2020-09-01 07:34:10,490] ######## Epoch (TEST) 4000 ########
[INFO: 2020-09-01 07:34:10,681] {'Bleu_1': 0.8055058682693341, 'Bleu_2': 0.6528284598361733, 'Bleu_3': 0.5101028621119722, 'Bleu_4': 0.3913618697249953, 'METEOR': 0.28932978927773223, 'ROUGE_L': 0.5871773525163547, 'CIDEr': 1.2839508388109842, 'SPICE': 0.22799216445987303, 'WMD': 0.2707650651773753}
[INFO: 2020-09-01 09:40:14,535] iteration 5000
[INFO: 2020-09-01 09:49:53,316] ######## Epoch (TEST) 5000 ########
[INFO: 2020-09-01 09:49:53,665] {'Bleu_1': 0.8035540270624468, 'Bleu_2': 0.6509702241076069, 'Bleu_3': 0.5093703707800095, 'Bleu_4': 0.3912698467912744, 'METEOR': 0.28934397385563837, 'ROUGE_L': 0.5882751335208736, 'CIDEr': 1.2845231021177415, 'SPICE': 0.2268866189758357, 'WMD': 0.27112736238628915}
[INFO: 2020-09-01 11:58:58,511] iteration 6000
[INFO: 2020-09-01 12:08:00,076] ######## Epoch (TEST) 6000 ########
[INFO: 2020-09-01 12:08:00,218] {'Bleu_1': 0.8068893557217803, 'Bleu_2': 0.6539535351692405, 'Bleu_3': 0.5113647246274658, 'Bleu_4': 0.3936738840595041, 'METEOR': 0.289890600737953, 'ROUGE_L': 0.5893633450376822, 'CIDEr': 1.2913145548120237, 'SPICE': 0.22761447693792908, 'WMD': 0.27251797691270724}
[INFO: 2020-09-01 14:18:39,017] iteration 7000
[INFO: 2020-09-01 14:32:22,015] ######## Epoch (TEST) 7000 ########
[INFO: 2020-09-01 14:32:22,490] {'Bleu_1': 0.8056260746348675, 'Bleu_2': 0.653779241692945, 'Bleu_3': 0.5115530808954737, 'Bleu_4': 0.392972308932358, 'METEOR': 0.2904201609715889, 'ROUGE_L': 0.5877181000659161, 'CIDEr': 1.2916655643632644, 'SPICE': 0.22905418090526505, 'WMD': 0.27269156985186055}
[INFO: 2020-09-01 15:01:29,001] ######## Epoch (VAL) 7084 ########
[INFO: 2020-09-01 15:01:29,080] {'Bleu_1': 0.8065987831249252, 'Bleu_2': 0.6565486302500099, 'Bleu_3': 0.5127472245160076, 'Bleu_4': 0.3930680241989873, 'METEOR': 0.29039767401302674, 'ROUGE_L': 0.5895427397787761, 'CIDEr': 1.2831195986404473, 'SPICE': 0.22463583713661792, 'WMD': 0.269766860237166}
[INFO: 2020-09-01 17:00:47,326] iteration 8000
[INFO: 2020-09-01 17:11:06,987] ######## Epoch (TEST) 8000 ########
[INFO: 2020-09-01 17:11:07,242] {'Bleu_1': 0.8065646235263192, 'Bleu_2': 0.6549239624324598, 'Bleu_3': 0.5133284146797645, 'Bleu_4': 0.395139755786706, 'METEOR': 0.29092421331840423, 'ROUGE_L': 0.5884824202905102, 'CIDEr': 1.2969733904843996, 'SPICE': 0.22906036898315832, 'WMD': 0.2719090792889607}
[INFO: 2020-09-01 19:19:49,488] iteration 9000
[INFO: 2020-09-01 19:31:31,410] ######## Epoch (TEST) 9000 ########
[INFO: 2020-09-01 19:31:31,767] {'Bleu_1': 0.8085136674739805, 'Bleu_2': 0.6565258304021427, 'Bleu_3': 0.5144192895069389, 'Bleu_4': 0.3954112392542055, 'METEOR': 0.29109467449130033, 'ROUGE_L': 0.5896806450205826, 'CIDEr': 1.3000413118238603, 'SPICE': 0.22736347952673278, 'WMD': 0.27359937569249504}
[INFO: 2020-09-01 21:36:20,233] iteration 10000
[INFO: 2020-09-01 21:46:12,351] ######## Epoch (TEST) 10000 ########
[INFO: 2020-09-01 21:46:12,814] {'Bleu_1': 0.8081204296166264, 'Bleu_2': 0.6556655356770357, 'Bleu_3': 0.5131603312404547, 'Bleu_4': 0.3947092277152882, 'METEOR': 0.2897883840155197, 'ROUGE_L': 0.5878755451660996, 'CIDEr': 1.2982409667303638, 'SPICE': 0.22768686290584148, 'WMD': 0.2720017094178488}
[INFO: 2020-09-01 23:18:18,921] ######## Epoch (VAL) 10624 ########
[INFO: 2020-09-01 23:18:19,032] {'Bleu_1': 0.8087527444688227, 'Bleu_2': 0.6564662454666771, 'Bleu_3': 0.5095958471187586, 'Bleu_4': 0.38775025421597875, 'METEOR': 0.29072687544338977, 'ROUGE_L': 0.5886960078641891, 'CIDEr': 1.2824527144681914, 'SPICE': 0.22692161420297538, 'WMD': 0.2688452709834806}
[INFO: 2020-09-02 00:11:18,618] iteration 11000
[INFO: 2020-09-02 00:23:24,854] ######## Epoch (TEST) 11000 ########
[INFO: 2020-09-02 00:23:25,141] {'Bleu_1': 0.8089471913891523, 'Bleu_2': 0.6561025705267006, 'Bleu_3': 0.5130985535228887, 'Bleu_4': 0.3936270641174294, 'METEOR': 0.29228596393141504, 'ROUGE_L': 0.5891851786562033, 'CIDEr': 1.2996988961292157, 'SPICE': 0.22999760864886412, 'WMD': 0.2737805370170714}
[INFO: 2020-09-02 02:25:53,747] iteration 12000
[INFO: 2020-09-02 02:35:26,319] ######## Epoch (TEST) 12000 ########
[INFO: 2020-09-02 02:35:26,532] {'Bleu_1': 0.8091583741178103, 'Bleu_2': 0.6566436041205059, 'Bleu_3': 0.5133448429498002, 'Bleu_4': 0.3939484748427449, 'METEOR': 0.28986989496283316, 'ROUGE_L': 0.5869601542064651, 'CIDEr': 1.3007382757061121, 'SPICE': 0.22914428943791537, 'WMD': 0.27115152920919816}
[INFO: 2020-09-02 04:39:29,599] iteration 13000
[INFO: 2020-09-02 04:49:14,768] ######## Epoch (TEST) 13000 ########
[INFO: 2020-09-02 04:49:15,068] {'Bleu_1': 0.8075202058510842, 'Bleu_2': 0.655831944494462, 'Bleu_3': 0.5138148739526623, 'Bleu_4': 0.3947351677415929, 'METEOR': 0.2906074799966085, 'ROUGE_L': 0.5891527499704249, 'CIDEr': 1.2978963131650387, 'SPICE': 0.2284278891076323, 'WMD': 0.2704890261852835}
[INFO: 2020-09-02 06:50:50,329] iteration 14000
[INFO: 2020-09-02 06:59:29,461] ######## Epoch (TEST) 14000 ########
[INFO: 2020-09-02 06:59:29,539] {'Bleu_1': 0.8083406486652223, 'Bleu_2': 0.657740475949448, 'Bleu_3': 0.5160383190570418, 'Bleu_4': 0.3973012858890246, 'METEOR': 0.29099779406606535, 'ROUGE_L': 0.5892848673707392, 'CIDEr': 1.3025495233035733, 'SPICE': 0.22937507447661645, 'WMD': 0.2708967792596034}
[INFO: 2020-09-02 07:37:28,266] ######## Epoch (VAL) 14164 ########
[INFO: 2020-09-02 07:37:28,392] {'Bleu_1': 0.8085713995835754, 'Bleu_2': 0.6582244678780182, 'Bleu_3': 0.5127121502500976, 'Bleu_4': 0.391694005562283, 'METEOR': 0.29057691397749025, 'ROUGE_L': 0.5891979282101438, 'CIDEr': 1.2866611459034019, 'SPICE': 0.22720841368060266, 'WMD': 0.26852040153861584}
[INFO: 2020-09-02 09:21:01,116] iteration 15000
[INFO: 2020-09-02 09:30:13,524] ######## Epoch (TEST) 15000 ########
[INFO: 2020-09-02 09:30:13,870] {'Bleu_1': 0.8059459003249186, 'Bleu_2': 0.6531634139892826, 'Bleu_3': 0.5098972092707869, 'Bleu_4': 0.3910487399412398, 'METEOR': 0.2913300991848872, 'ROUGE_L': 0.5874055524117159, 'CIDEr': 1.297724702599616, 'SPICE': 0.22952808017815743, 'WMD': 0.27198280096013333}
