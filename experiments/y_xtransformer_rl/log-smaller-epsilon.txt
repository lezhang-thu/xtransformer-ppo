[INFO: 2020-09-05 13:36:18,882] Training with config:
[INFO: 2020-09-05 13:36:18,884] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': 50,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 2,
               'CAP_KEY': 'caption',
               'COCO_PATH': 'coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 768,
           'ATT_FEATS_NORM': True,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 768,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [96, 48, 96],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.5,
                        'DECODE_LAYERS': 6,
                        'DIM': 768,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [96, 48, 96],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.5,
                        'ENCODE_LAYERS': 6,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.0,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XTransformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 768,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ADVS': 'ADVS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GEN_RESULT': 'GEN_RESULT',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SAMPLE_LOGPROBS': 'SAMPLE_LOGPROBS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/y_xtransformer_rl',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 768,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Epoch',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 60,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'RADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 32,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2020-09-05 13:37:34,942] val_current @iteration 0: 1.307807880786779, val_best: 1.307807880786779
[INFO: 2020-09-05 13:46:19,699] val_current @iteration 100: 1.3072373067777041, val_best: 1.307807880786779
[INFO: 2020-09-05 13:55:00,228] val_current @iteration 200: 1.3093798844986873, val_best: 1.307807880786779
[INFO: 2020-09-05 14:03:42,105] val_current @iteration 300: 1.3082754023170728, val_best: 1.3093798844986873
[INFO: 2020-09-05 14:12:20,189] val_current @iteration 400: 1.3089018886490005, val_best: 1.3093798844986873
[INFO: 2020-09-05 14:20:57,303] val_current @iteration 500: 1.3090228151025785, val_best: 1.3093798844986873
[INFO: 2020-09-05 14:29:32,197] val_current @iteration 600: 1.3064643615717195, val_best: 1.3093798844986873
[INFO: 2020-09-05 14:38:07,365] val_current @iteration 700: 1.3077729025938558, val_best: 1.3093798844986873
[INFO: 2020-09-05 14:46:43,016] val_current @iteration 800: 1.3062408471984135, val_best: 1.3093798844986873
[INFO: 2020-09-05 14:55:24,644] val_current @iteration 900: 1.3088751611607525, val_best: 1.3093798844986873
[INFO: 2020-09-05 15:04:05,544] val_current @iteration 1000: 1.3079918670307529, val_best: 1.3093798844986873
[INFO: 2020-09-05 15:12:49,190] val_current @iteration 1100: 1.3084954574418142, val_best: 1.3093798844986873
[INFO: 2020-09-05 15:21:31,196] val_current @iteration 1200: 1.3085007970174851, val_best: 1.3093798844986873
[INFO: 2020-09-05 15:30:12,506] val_current @iteration 1300: 1.309855025237169, val_best: 1.3093798844986873
[INFO: 2020-09-05 15:38:55,125] val_current @iteration 1400: 1.3079924971223325, val_best: 1.309855025237169
[INFO: 2020-09-05 15:47:38,800] val_current @iteration 1500: 1.3063414965310773, val_best: 1.309855025237169
[INFO: 2020-09-05 15:56:21,069] val_current @iteration 1600: 1.3106373531128306, val_best: 1.309855025237169
[INFO: 2020-09-05 16:05:03,347] val_current @iteration 1700: 1.3066799315699116, val_best: 1.3106373531128306
[INFO: 2020-09-05 16:13:47,058] val_current @iteration 1800: 1.3083748278883718, val_best: 1.3106373531128306
[INFO: 2020-09-05 16:22:30,106] val_current @iteration 1900: 1.3082442364176907, val_best: 1.3106373531128306
[INFO: 2020-09-05 16:31:11,413] val_current @iteration 2000: 1.3077012957714276, val_best: 1.3106373531128306
[INFO: 2020-09-05 16:39:53,024] val_current @iteration 2100: 1.3089873009888158, val_best: 1.3106373531128306
[INFO: 2020-09-05 16:48:35,782] val_current @iteration 2200: 1.3108183628297687, val_best: 1.3106373531128306
[INFO: 2020-09-05 16:57:15,498] val_current @iteration 2300: 1.3103745016892536, val_best: 1.3108183628297687
[INFO: 2020-09-05 17:05:55,805] val_current @iteration 2400: 1.3112830739928865, val_best: 1.3108183628297687
[INFO: 2020-09-05 17:14:36,593] val_current @iteration 2500: 1.3078829742065, val_best: 1.3112830739928865
[INFO: 2020-09-05 17:23:16,592] val_current @iteration 2600: 1.3081342952741257, val_best: 1.3112830739928865
[INFO: 2020-09-05 17:31:57,017] val_current @iteration 2700: 1.307252521902101, val_best: 1.3112830739928865
[INFO: 2020-09-05 17:40:37,497] val_current @iteration 2800: 1.3044805009349765, val_best: 1.3112830739928865
[INFO: 2020-09-05 17:49:19,714] val_current @iteration 2900: 1.304780736383864, val_best: 1.3112830739928865
[INFO: 2020-09-05 17:57:53,782] val_current @iteration 3000: 1.3070027585281994, val_best: 1.3112830739928865
[INFO: 2020-09-05 18:06:25,933] val_current @iteration 3100: 1.3076647858139, val_best: 1.3112830739928865
[INFO: 2020-09-05 18:14:58,486] val_current @iteration 3200: 1.3079711581444993, val_best: 1.3112830739928865
[INFO: 2020-09-05 18:23:32,614] val_current @iteration 3300: 1.3062927321953097, val_best: 1.3112830739928865
[INFO: 2020-09-05 18:32:07,644] val_current @iteration 3400: 1.3027320765607595, val_best: 1.3112830739928865
[INFO: 2020-09-05 18:40:41,257] val_current @iteration 3500: 1.305982699443119, val_best: 1.3112830739928865
[INFO: 2020-09-05 18:48:32,390] ######## Epoch 1 ########
[INFO: 2020-09-05 18:48:32,390] {'CIDEr': 1.2994532629559845}
[INFO: 2020-09-05 18:49:55,770] val_current @iteration 3600: 1.3029329448685216, val_best: 1.3112830739928865
[INFO: 2020-09-05 18:50:09,386] ######## Epoch 4001 ########
[INFO: 2020-09-05 18:50:09,386] {'CIDEr': 1.3010348476967275}
[INFO: 2020-09-05 18:58:35,962] val_current @iteration 3700: 1.308132575615227, val_best: 1.3112830739928865
[INFO: 2020-09-05 19:07:16,249] val_current @iteration 3800: 1.309030454569114, val_best: 1.3112830739928865
[INFO: 2020-09-05 19:15:55,195] val_current @iteration 3900: 1.3040984016402484, val_best: 1.3112830739928865
[INFO: 2020-09-05 19:24:37,136] val_current @iteration 4000: 1.3052909608537229, val_best: 1.3112830739928865
[INFO: 2020-09-05 19:33:18,318] val_current @iteration 4100: 1.3091541830986537, val_best: 1.3112830739928865
[INFO: 2020-09-05 19:41:54,569] val_current @iteration 4200: 1.3085253595122666, val_best: 1.3112830739928865
[INFO: 2020-09-05 19:50:27,123] val_current @iteration 4300: 1.3086576090595436, val_best: 1.3112830739928865
[INFO: 2020-09-05 19:59:06,822] val_current @iteration 4400: 1.3080421031215435, val_best: 1.3112830739928865
[INFO: 2020-09-05 20:07:47,375] val_current @iteration 4500: 1.3075041577515156, val_best: 1.3112830739928865
[INFO: 2020-09-05 20:16:26,661] val_current @iteration 4600: 1.3091822030129707, val_best: 1.3112830739928865
[INFO: 2020-09-05 20:25:06,598] val_current @iteration 4700: 1.3094666845651675, val_best: 1.3112830739928865
[INFO: 2020-09-05 20:33:47,342] val_current @iteration 4800: 1.30570907289034, val_best: 1.3112830739928865
[INFO: 2020-09-05 20:42:26,993] val_current @iteration 4900: 1.3075762320631081, val_best: 1.3112830739928865
[INFO: 2020-09-05 20:51:06,356] val_current @iteration 5000: 1.3032737050230008, val_best: 1.3112830739928865
[INFO: 2020-09-05 20:59:45,451] val_current @iteration 5100: 1.3065614275317554, val_best: 1.3112830739928865
[INFO: 2020-09-05 21:08:21,574] val_current @iteration 5200: 1.3067003540448179, val_best: 1.3112830739928865
[INFO: 2020-09-05 21:16:54,396] val_current @iteration 5300: 1.3070114718215002, val_best: 1.3112830739928865
[INFO: 2020-09-05 21:25:28,608] val_current @iteration 5400: 1.3034620757764561, val_best: 1.3112830739928865
[INFO: 2020-09-05 21:34:02,749] val_current @iteration 5500: 1.3061125318326863, val_best: 1.3112830739928865
